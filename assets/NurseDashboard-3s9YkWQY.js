import{r as s,j as e,bq as J,u as le,d as H,S as q,B as O,I as ae,a6 as W,aN as U}from"./index-Br_GEqdo.js";import{a as ne}from"./index-BY34WRD1.js";import{u as Q,A as ie,a as re}from"./alertsOverview-CPQFDjDj.js";import{g as G,a as oe}from"./elderlySupport-BvJio9Ba.js";import{d as ce,a as C,b as de,g as X}from"./helper-DzRZPsxz.js";import{g as fe}from"./elderly-CKiohUCZ.js";import{S as ue}from"./slick-theme-Dl7lyB1X.js";import{D as he,a as xe}from"./RoomMap4-BeRM2KX-.js";import{u as pe}from"./useWebSoket-CyG25RH0.js";import{A as me}from"./AlertCloseModal-y57qUF8m.js";import{M as ge,u as se,P as je,a as ve,L as be,m as D}from"./proxy-D4K9gQZc.js";import"./index-CRbLI1Fq.js";import"./line-BXpzQcv3.js";import"./WeeklyMonthlyPicker-PvGft6NO.js";import{C as we}from"./CreateAndEditModal-BO9ApfY5.js";import{S as Z}from"./index-ChzJk7ue.js";import{R as Ce}from"./AimOutlined-DKAhAHG5.js";import{R as ye}from"./HomeOutlined-hcIBy_LE.js";import"./AlertName-DWzPI_nH.js";import"./ActionManu-BO2raBbo.js";import"./index-DSRFHE-c.js";import"./SuccessModal-BfvB0Lts.js";import"./index-ceZKZtjc.js";import"./UseCustomContext-CViCX-HO.js";import"./LargeTextViewerModal-C1SunBPU.js";import"./SwapRightOutlined-CrSe5jtl.js";import"./weekOfYear-n-0uo8J2.js";import"./index-BgZw8iPK.js";import"./weekday-BFwzlRaD.js";import"./index-BlOE6pdL.js";import"./leaflet-src-DkIeBEsY.js";/* empty css                */import"./InfoCircleOutlined-B-uislmE.js";import"./index-CDRxabMw.js";class Ne extends s.Component{getSnapshotBeforeUpdate(c){const i=this.props.childRef.current;if(i&&c.isPresent&&!this.props.isPresent){const t=this.props.sizeRef.current;t.height=i.offsetHeight||0,t.width=i.offsetWidth||0,t.top=i.offsetTop,t.left=i.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Ae({children:o,isPresent:c}){const i=s.useId(),t=s.useRef(null),p=s.useRef({width:0,height:0,top:0,left:0}),{nonce:l}=s.useContext(ge);return s.useInsertionEffect(()=>{const{width:d,height:n,top:m,left:y}=p.current;if(c||!t.current||!d||!n)return;t.current.dataset.motionPopId=i;const g=document.createElement("style");return l&&(g.nonce=l),document.head.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${i}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${n}px !important;
            top: ${m}px !important;
            left: ${y}px !important;
          }
        `),()=>{document.head.removeChild(g)}},[c]),e.jsx(Ne,{isPresent:c,childRef:t,sizeRef:p,children:s.cloneElement(o,{ref:t})})}const Se=({children:o,initial:c,isPresent:i,onExitComplete:t,custom:p,presenceAffectsLayout:l,mode:d})=>{const n=se(_e),m=s.useId(),y=s.useCallback(u=>{n.set(u,!0);for(const j of n.values())if(!j)return;t&&t()},[n,t]),g=s.useMemo(()=>({id:m,initial:c,isPresent:i,custom:p,onExitComplete:y,register:u=>(n.set(u,!1),()=>n.delete(u))}),l?[Math.random(),y]:[i,y]);return s.useMemo(()=>{n.forEach((u,j)=>n.set(j,!1))},[i]),s.useEffect(()=>{!i&&!n.size&&t&&t()},[i]),d==="popLayout"&&(o=e.jsx(Ae,{isPresent:i,children:o})),e.jsx(je.Provider,{value:g,children:o})};function _e(){return new Map}const z=o=>o.key||"";function ee(o){const c=[];return s.Children.forEach(o,i=>{s.isValidElement(i)&&c.push(i)}),c}const De=({children:o,exitBeforeEnter:c,custom:i,initial:t=!0,onExitComplete:p,presenceAffectsLayout:l=!0,mode:d="sync"})=>{const n=s.useMemo(()=>ee(o),[o]),m=n.map(z),y=s.useRef(!0),g=s.useRef(n),u=se(()=>new Map),[j,k]=s.useState(n),[A,S]=s.useState(n);ve(()=>{y.current=!1,g.current=n;for(let v=0;v<A.length;v++){const h=z(A[v]);m.includes(h)?u.delete(h):u.get(h)!==!0&&u.set(h,!1)}},[A,m.length,m.join("-")]);const x=[];if(n!==j){let v=[...n];for(let h=0;h<A.length;h++){const w=A[h],M=z(w);m.includes(M)||(v.splice(h,0,w),x.push(w))}d==="wait"&&x.length&&(v=x),S(ee(v)),k(n);return}const{forceRender:E}=s.useContext(be);return e.jsx(e.Fragment,{children:A.map(v=>{const h=z(v),w=n===A||m.includes(h),M=()=>{if(u.has(h))u.set(h,!0);else return;let R=!0;u.forEach(F=>{F||(R=!1)}),R&&(E==null||E(),S(g.current),p&&p())};return e.jsx(Se,{isPresent:w,initial:!y.current||t?void 0:!1,custom:w?void 0:i,presenceAffectsLayout:l,mode:d,onExitComplete:w?void 0:M,children:v},h)})})};function Ee({rooms:o=[]}){const[c,i]=s.useState({}),t={dots:o.length>=2,infinite:o.length>2,speed:500,slidesToShow:1,slidesToScroll:1,draggable:!0,arrows:!1,appendDots:l=>e.jsx("div",{style:{backgroundColor:"transparent",borderRadius:"10px",padding:"2px"},children:e.jsxs("ul",{id:"dots",style:{margin:"0px"},children:[" ",l," "]})})},p=s.useCallback((l,d)=>{const n=ce(l);i(m=>({...m,[d]:n}))},[]);return pe({onMessage:l=>{var n;const d=(n=JSON.parse(l==null?void 0:l.message))==null?void 0:n.payload;d!=null&&d.position&&p(d.position,d.deviceCode)},dependencies:[o]}),e.jsxs(e.Fragment,{children:[o.length>0&&e.jsx("div",{id:"rooms",className:"w-full mb-2 transition-all duration-300 h-full",children:e.jsx(ue,{...t,className:"w-full transition-all duration-300 h-full ",children:o.map((l,d)=>e.jsxs("div",{className:"px-2 overflow-hidden transition-all duration-300 w-full h-[355px] ",children:[e.jsxs("div",{id:"roomNmaeAndStatus",className:"flex items-center gap-2 w-fit bg-white pr-4 py-1.5 border border-gray-200 p-2 rounded-full absolute top-2 left-2",children:[e.jsx("div",{id:"dot",className:"size-3 rounded-full",style:{backgroundColor:(l==null?void 0:l.is_device_bind)===!0?"green":"red"}}),e.jsx("p",{children:l==null?void 0:l.name})]}),(l==null?void 0:l.is_device_bind)&&(l==null?void 0:l.mount_type)===1&&e.jsx(he,{roomInfo:l,position:c[l.device_no]}),(l==null?void 0:l.is_device_bind)&&(l==null?void 0:l.mount_type)===2&&e.jsx(xe,{roomInfo:l,position:c[l.device_no]}),!(l!=null&&l.is_device_bind)&&e.jsx("span",{className:"w-full h-full flex items-center justify-center",children:e.jsx("p",{children:"No Device Data Available"})})]},d))})}),o.length===0&&e.jsx(J,{description:"No Room Found "})]})}function Re({refreshAlertList:o}){var $,B,T,r;const[c,i]=s.useState([]),[t,p]=s.useState(null),l=le(),[d,n]=s.useState(!1),[m,y]=s.useState(null),[g,u]=s.useState(!0),[j,k]=s.useState({textColor:"text-white",bodyColor:"text-white",txtc:"#fff",bgc:"#fff"}),[A,S]=s.useState({time:[],heartRate:[],breathRate:[]}),[x,E]=s.useState(null),[v,h]=s.useState(Date.now()),[w,M]=s.useState([]),[R,F]=s.useState(!0),P=s.useCallback(()=>{u(!0),fe().then(a=>{i(a.data),u(!1)}).catch(a=>{console.log(a),u(!1)})},[]);s.useEffect(()=>{P()},[P]);const L=s.useCallback(()=>{F(!0),G({to_date:"2024-11-30",from_date:H().format("YYYY-MM-DD"),is_resolved:!1,elderly_id:t==null?void 0:t._id}).then(a=>{M(a.data),F(!1)}).catch(a=>{F(!1),console.log(a)})},[t==null?void 0:t._id]);s.useEffect(()=>{t!=null&&t._id&&L()},[L]),s.useEffect(()=>{var a,b,N,f;t&&k({textColor:((a=C(t))==null?void 0:a.label)!=="Critical"?"text-primary":"text-white",bodyColor:((b=C(t))==null?void 0:b.label)!=="Critical"?"text-primary":"text-white",txtc:((N=C(t))==null?void 0:N.label)!=="Critical"?"#fff":"#000",bgc:((f=C(t))==null?void 0:f.label)!=="Critical"?"#fff":"#000"})},[t]);const V=a=>{const b=de(a);E(b),h(Date.now())};s.useEffect(()=>{const a=setInterval(()=>{if(Date.now()-v>5e3)E(null),S({time:[],heartRate:[],breathRate:[]});else if(x){const f=new Date().toLocaleTimeString();S(_=>({time:[..._.time,f].slice(-30),heartRate:[..._.heartRate,x.heartRateValue].slice(-30),breathRate:[..._.breathRate,x.breathingValue].slice(-30)}))}},1e3);return()=>clearInterval(a)},[x,v]),s.useEffect(()=>{var N;if(!t)return;const a=((N=t==null?void 0:t.rooms)==null?void 0:N.length)>0?t.rooms.filter(f=>f.device_no).map(f=>f.device_no).join(", "):"",b=new WebSocket("wss://live.elderlycareplatform.com/ws/");return b.onopen=()=>{console.log("Connected to WebSocket server")},b.onmessage=f=>{var K;const _=JSON.parse(f==null?void 0:f.data),I=(K=JSON.parse(_==null?void 0:_.message))==null?void 0:K.payload;a.includes(I==null?void 0:I.deviceCode)&&(I!=null&&I.heartbreath)&&V(I.heartbreath)},b.onerror=f=>{console.error("WebSocket error:",f)},b.onclose=()=>{console.log("Disconnected from WebSocket server")},()=>b.close()},[t]);const Y=a=>{window.scrollTo(0,0),l(`/supporter/elderlies/elderly-profile/${a==null?void 0:a._id}`)};return g?e.jsx(e.Fragment,{children:g&&e.jsx("span",{className:"w-full h-full flex items-center justify-center",children:e.jsx(q,{})})}):c.length?e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"NurseRoomView",className:"w-full h-full relative",children:[e.jsx("div",{className:"w-full h-full grid grid-cols-10  overflow-auto",children:c==null?void 0:c.map((a,b)=>{var N,f,_;return e.jsx(D.div,{layoutId:a==null?void 0:a._id,onClick:()=>p(a),className:`text-white text-base ${((N=C(a==null?void 0:a.alarms_data[0]))==null?void 0:N.label)==="Critical"?"bg-[#FF1D1D] animate-scaleUpDown1":((f=C(a==null?void 0:a.alarms_data[0]))==null?void 0:f.label)==="Warning"?"bg-[#FF9831] animate-scaleUpDown2":((_=C(a==null?void 0:a.alarms_data[0]))==null?void 0:_.label)==="Info"?"bg-[#6471FF]":"bg-[#F4F4F6] !text-primary"}  rounded-lg cursor-pointer flex justify-center m-2 items-center font-semibold min-w-[55px] min-h-[65px] h-fit `,children:e.jsx(D.h5,{children:(a==null?void 0:a.room_no)||"--"})},b)})}),e.jsx(De,{children:t&&e.jsx(D.div,{className:"absolute inset-0 flex justify-center items-center",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:e.jsx(D.div,{className:"bg-black bg-opacity-50 w-full h-full flex justify-center items-center",onClick:()=>p(null),children:e.jsxs(D.div,{className:`${(($=C(t))==null?void 0:$.label)==="Critical"?"bg-[#FF1D1D]":((B=C(t))==null?void 0:B.label)==="Warning"?"bg-[#FF9831]":((T=C(t))==null?void 0:T.label)==="Info"?"bg-[#6471FF]":"bg-[#F4F4F6]"} p-4 rounded-xl w-[95%] h-[90%]`,onClick:a=>a.stopPropagation(),layoutId:t==null?void 0:t._id,children:[e.jsxs(D.div,{className:"flex justify-between items-start",children:[" ",e.jsx("div",{className:"w-[65%] flex items-start cursor-pointer bg-white hover:bg-white/75 rounded-xl transition-all duration-300 ease-in",onClick:()=>Y(t),children:e.jsxs("div",{id:"elderly-profile",className:"flex items-center w-full  justify-between px-4 ",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex flex-col items-start w-full gap-1",children:[e.jsx("h2",{className:`text-xl font-bold ${j.textColor} text-center text-nowrap m-0  leading-none`,children:t==null?void 0:t.name}),e.jsxs("h2",{className:`text-base font-medium ${j.textColor} opacity-80 text-center text-nowrap m-0 leading-none`,children:["Age: ",e.jsx("span",{children:t==null?void 0:t.age})]})]})}),e.jsxs("div",{id:"liveHeartAndBreathRate",className:"flex w-fit py-4 gap-8",children:[e.jsxs("div",{id:"heartRate",className:"flex flex-col items-start justify-start w-full",children:[e.jsxs("h2",{className:`text-[27px] font-bold leading-none ${j.textColor}  text-nowrap`,children:[(x==null?void 0:x.heartRateValue)??"--"," ",e.jsx("span",{className:"text-sm",children:"/BPM"})]}),e.jsx("h2",{className:`text-sm font-medium ${j.textColor} opacity-80 text-nowrap`,children:"Heart Rate"})]}),e.jsxs("div",{id:"breathRate",className:"flex flex-col items-start justify-start w-full",children:[e.jsxs("h2",{className:`text-[27px] font-bold leading-none ${j.textColor}  text-nowrap`,children:[(x==null?void 0:x.breathingValue)??"--"," ",e.jsx("span",{className:"text-sm",children:"/BPM"})]}),e.jsx("h2",{className:`text-sm font-medium ${j.textColor} opacity-80  text-nowrap`,children:"Breath Rate"})]})]})]})}),e.jsx(D.button,{className:"p-2 bg-black/5  hover:bg-black/10 rounded-full",onClick:()=>p(null),children:e.jsx(ne,{size:24,className:j.textColor})})]}),e.jsxs(D.div,{className:"flex h-[80%] items-center mt-2",children:[e.jsx(D.div,{className:"h-full  w-[65%] bg-white rounded-xl flex flex-col items-center justify-center",children:e.jsx(Ee,{rooms:(r=t==null?void 0:t.rooms)==null?void 0:r.filter(a=>a.device_no)})}),e.jsxs(D.div,{className:"h-full w-[35%] rounded-xl p-2 border-1 overflow-y-auto overflow-x-hidden gap-2 flex flex-col pt-0",children:[w==null?void 0:w.map((a,b)=>{var N,f;return e.jsxs("div",{className:"flex items-center gap-2 w-[350px] bg-white p-2 rounded-lg cursor-pointer",onClick:()=>{y(a),n(!0)},children:[e.jsx("div",{id:"Icon",children:C(a).icon?e.jsx("img",{src:C(a).icon,alt:"Alert Icon",width:38,height:38,className:"min-w-[38px]"}):null}),e.jsxs("div",{className:"w-full",children:[e.jsx("h4",{className:"text-sm font-medium text-text-primary",children:(N=C(a))==null?void 0:N.title}),e.jsx("p",{className:"text-xs text-text-secondary",children:(f=C(a))==null?void 0:f.message})]})]},b)}),w.length===0&&!R&&e.jsx("div",{className:"h-full flex items-center w-full justify-center",children:e.jsx(J,{description:"No alerts available to show"})}),R&&e.jsx("div",{className:"h-full w-full flex flex-col justify-center items-center",children:e.jsx(q,{})})]})]})]})})})})]}),e.jsx(me,{openAlertCloseModal:d,setOpenAlertCloseModal:n,selectedAlert:m,getAlertListDatas:()=>{L(),o()}})]}):e.jsx("div",{className:"h-full flex items-center w-full justify-center",children:e.jsx(J,{description:"No room available to show"})})}function ft(){s.useState("Map View");const[o,c]=s.useState(!1);s.useState([]);const i=Q("activeAlert"),t=Q("recentlyClosedAlert"),p=Q("events"),[l,d]=s.useState([]),[n,m]=s.useState([]),[y,g]=s.useState(1),[u,j]=s.useState(1),[k,A]=s.useState([]),[S,x]=s.useState([]),[E,v]=s.useState({}),[h,w]=s.useState({}),[M,R]=s.useState(!0),[F,P]=s.useState(!0),L=s.useCallback(()=>{P(!0),G({to_date:"2024-11-30",from_date:H().format("YYYY-MM-DD"),is_resolved:!1,page:y,...E}).then(r=>{A(r==null?void 0:r.data),P(!1)}).catch(r=>{console.log(r),P(!1)})},[y,E]);s.useEffect(()=>{L()},[L]);const V=s.useCallback(()=>{R(!0),G({to_date:"2024-11-30",from_date:H().format("YYYY-MM-DD"),is_resolved:!0,page:u,...h}).then(r=>{x(r.data),R(!1)}).catch(r=>{console.log(r),R(!1)})},[u,h]);s.useEffect(()=>{V()},[V]);const Y=s.useCallback(()=>{oe({to_date:"2024-11-30",from_date:H().format("YYYY-MM-DD"),page:n}).then(r=>{r.data.length>0&&d(r.data)}).catch(r=>{console.log(r)})},[n]);s.useEffect(()=>{Y()},[Y]);function $(){L(),V()}function B(r){v(X(r))}function T(r){w(X(r))}return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-4 flex-col pt-8 pb-8",children:[e.jsx("div",{className:"flex item-center justify-between w-full",children:e.jsx(O,{theme:{token:{fontFamily:"Baloo2",colorPrimary:"#8086AC",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:e.jsx("div",{children:e.jsx(ae,{className:"rounded-[10px]",size:"large",placeholder:"Search Anything",style:{height:"44px"}})})})}),e.jsx("div",{className:"w-full",children:e.jsx(ie,{refreshAlertList:$})}),e.jsxs("div",{className:"w-full flex flex-col gap-4 lg3:flex-row",children:[e.jsx("div",{className:"w-full p-0",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 h-[650px] flex flex-col",children:[e.jsx("div",{className:"flex justify-between items-center mb-5",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Room View"})}),e.jsx("div",{className:"w-full h-full overflow-y-auto rounded-xl",children:e.jsx(Re,{refreshAlertList:$})})]})}),e.jsx("div",{className:"bg-white w-full lg3:w-[48%] rounded-2xl p-6 h-[650px] overflow-hidden",children:e.jsx(re,{})})]}),e.jsxs("div",{id:"Active_Alerts",className:"w-full flex flex-col gap-4 justify-center items-center bg-white rounded-2xl p-6",children:[e.jsxs("div",{id:"Active_Alerts_Header",className:"w-full flex justify-between",children:[e.jsx("h1",{className:"text-[24px] font-bold",children:"Active Alerts"}),e.jsx("div",{children:e.jsx(O,{theme:{components:{Segmented:{itemSelectedBg:"#252F67",itemSelectedColor:"#fff",fontFamily:"Baloo2"}}},children:e.jsx(Z,{options:te,onChange:r=>B(r)})})})]}),e.jsx("div",{id:"Active_Alerts_Table",className:"w-full",children:e.jsx(W.Provider,{value:{total:k==null?void 0:k.length,page:1,SetPage:g},children:e.jsx(U,{pageSize:6,loading:F,tableData:k,columns:i})})})]}),e.jsxs("div",{id:"Recently_Closed_Alerts",className:"w-full flex flex-col gap-4 justify-center items-center bg-white rounded-2xl p-6",children:[e.jsxs("div",{id:"Recently_Closed_Alerts_Header",className:"w-full flex justify-between",children:[e.jsx("h1",{className:"text-[24px] font-bold",children:"Recently Closed Alerts"}),e.jsx("div",{children:e.jsx(O,{theme:{components:{Segmented:{itemSelectedBg:"#252F67",itemSelectedColor:"#fff",fontFamily:"Baloo2"}}},children:e.jsx(Z,{options:te,onChange:r=>T(r)})})})]}),e.jsx("div",{id:"Recently_Closed_Alerts_Table",className:"w-full",children:e.jsx(W.Provider,{value:{total:S==null?void 0:S.length,page:1,SetPage:j},children:e.jsx(U,{pageSize:6,loading:M,tableData:S,columns:t})})})]}),e.jsxs("div",{id:"Events",className:"w-full flex flex-col gap-4 justify-center items-center bg-white rounded-2xl p-6",children:[e.jsx("div",{id:"Events_Header",className:"w-full flex justify-between",children:e.jsx("h1",{className:"text-[24px] font-bold",children:"Events"})}),e.jsx("div",{id:"Events_Table",className:"w-full",children:e.jsx(W.Provider,{value:{total:l==null?void 0:l.length,page:1,SetPage:m,getList:()=>Y},children:e.jsx(U,{pageSize:6,tableData:l,columns:p})})})]})]}),e.jsx(we,{modalOpen:o,setModalOpen:c,type:"event"})]})}const ut=[{label:" Map View",value:"Map View",icon:e.jsx(Ce,{})},{label:"Room View",value:"Room View",icon:e.jsx(ye,{})}],te=[{label:"All Alerts",value:"All Alerts"},{label:"Critical",value:"Critical"},{label:"Warning",value:"Warning"},{label:"Informational",value:"Info"}];export{te as activeAlertSegmentOptions,ut as alertViewSegmentOptions,ft as default};
