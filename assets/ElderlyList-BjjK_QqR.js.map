{"version":3,"file":"ElderlyList-BjjK_QqR.js","sources":["../../src/Components/ActionManu/ElderlyAction.jsx","../../src/Pages/Elderlies/Utiles/utiles2.jsx","../../src/Pages/Elderlies/ElderlyList.jsx"],"sourcesContent":["import { Button, Space } from \"antd\";\r\nimport React, { useContext, useState } from \"react\";\r\nimport { AiOutlineEdit, AiOutlineEye } from \"react-icons/ai\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport CreateAndEditUsers from \"../PubTable/CreateAndEditUsers\";\r\nimport { SidebarContext } from \"@/Context/CustomUsertable\";\r\n\r\nexport default function ElderlyAction({ row = {} }) {\r\n  const navigate = useNavigate();\r\n  const sharedMethod = useContext(SidebarContext);\r\n  const [edit, setEdit] = useState(false);\r\n\r\n  const handleViewClick = (row) => {\r\n    window.scrollTo(0, 0);\r\n    navigate(`/supporter/elderlies/elderly-profile/${row?._id}`);\r\n  };\r\n  function handleEditClick() {\r\n    setEdit(true);\r\n    // sharedMethod?.getlist();\r\n  }\r\n  return (\r\n    <>\r\n      <Space>\r\n        <Button\r\n          type=\"primary\"\r\n          icon={<AiOutlineEdit />}\r\n          onClick={() => handleEditClick()}\r\n        >\r\n          Edit\r\n        </Button>\r\n        <Button icon={<AiOutlineEye />} onClick={() => handleViewClick(row)}>\r\n          View\r\n        </Button>\r\n      </Space>\r\n      <CreateAndEditUsers\r\n        item={{ ...row, role: \"elderly\" }}\r\n        getlist={sharedMethod?.getlist}\r\n        role={\"elderly\"}\r\n        modalOPen={edit}\r\n        setModalOpen={setEdit}\r\n        isEditMode={edit}\r\n      />\r\n    </>\r\n  );\r\n}\r\n","import { useEffect, useState } from \"react\";\r\nimport Elderly from \"@/Components/NameCol/Elderly\";\r\nimport { LuNavigation } from \"react-icons/lu\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport ls from \"store2\";\r\nimport { AiOutlineEdit, AiOutlineEye } from \"react-icons/ai\";\r\nimport { Button, Space } from \"antd\";\r\nimport ElderlyAction from \"@/Components/ActionManu/ElderlyAction\";\r\nexport default function useElderlyTableColumns(role) {\r\n  const navigate = useNavigate();\r\n  const user_role = JSON.parse(localStorage.getItem(\"user\"))?.role;\r\n\r\n  const randomId = Math.floor(Math.random() * 1000000);\r\n  const handleViewClick = (row) => {\r\n    window.scrollTo(0, 0);\r\n    navigate(`/supporter/elderlies/elderly-profile/${row?._id}`);\r\n  };\r\n  const elderlyTableColsMapping = {\r\n    support_agent: [\r\n      \"elderlyName\",\r\n      \"activeAlert\",\r\n      \"allergies\",\r\n      \"diseases\",\r\n      \"viewProfile\",\r\n    ],\r\n    nurse: [\r\n      \"elderlyName\",\r\n      \"activeAlert\",\r\n      \"allergies\",\r\n      \"diseases\",\r\n      \"medications\",\r\n      // \"viewOnMap\",\r\n      \"viewProfile\",\r\n    ],\r\n    end_user: [\r\n      \"elderlyName\",\r\n      \"activeAlert\",\r\n      \"allergies\",\r\n      \"diseases\",\r\n      \"medications\",\r\n      \"viewProfile\",\r\n    ],\r\n  };\r\n  const elderlyTableColumns = {\r\n    elderlyName: {\r\n      title: () => {\r\n        switch (user_role) {\r\n          case \"nurse\":\r\n            return \"Resident Name\";\r\n          default:\r\n            return \"User Name\";\r\n        }\r\n      },\r\n      render: (row) => (\r\n        <Elderly onClick={() => handleViewClick(row)} data={row} />\r\n      ),\r\n    },\r\n    roomName: {\r\n      title: \"Room Name\",\r\n      dataIndex: \"roomName\",\r\n      render: (text) => <span>{text}</span>,\r\n    },\r\n    activeAlert: {\r\n      title: \"Active Fall Alerts\",\r\n      dataIndex: \"unresolved_alarm_count\",\r\n      render: (text) => <span>{text}</span>,\r\n    },\r\n    address: {\r\n      title: \"Address\",\r\n      width: \"230px\",\r\n      render: (row) => (\r\n        <span className=\"!w-[230px] text-nowrap\">{row.address}</span>\r\n      ),\r\n    },\r\n    allergies: {\r\n      title: \"Comments\",\r\n      render: (row) => (\r\n        <span>\r\n          {row?.comments?.map((comment) => comment.comment).join(\", \") || \"N/A\"}\r\n        </span>\r\n      ),\r\n    },\r\n\r\n    diseases: {\r\n      title: \"Conditions\",\r\n      render: (row) => (\r\n        <span>{row?.diseases?.map((d) => d).join(\", \") || \"N/A\"}</span>\r\n      ),\r\n    },\r\n    medications: {\r\n      title: \"Daily Routine\",\r\n      render: (row) => (\r\n        <span>{row.medications?.map((d) => d.name).join(\", \")}</span>\r\n      ),\r\n    },\r\n    viewOnMap: {\r\n      title: \"View On Map\",\r\n      render: (row) => (\r\n        <span className=\"flex items-center transition-all duration-300 justify-start gap-2 text-sm font-medium text-text-primary hover:text-primary cursor-pointer p-2 rounded-md w-fit text-center hover:bg-slate-100\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <a\r\n              href={`https://www.google.com/maps?q=${row.latitude},${row.longitude}`}\r\n              target=\"_blank\"\r\n              rel=\"noopener noreferrer\"\r\n              className=\"text-base font-medium !text-blue-500\"\r\n            >\r\n              View on Map\r\n            </a>\r\n            <LuNavigation size={18} className=\"text-blue-500\" />\r\n          </div>\r\n        </span>\r\n      ),\r\n    },\r\n    viewProfile: {\r\n      title: \"Actions\",\r\n      render: (row) => <ElderlyAction row={row} />,\r\n    },\r\n  };\r\n\r\n  const [elderlyTableColumn, setElderlyTableColumns] = useState([]);\r\n  useEffect(() => {\r\n    console.log(\"Current role:\");\r\n    console.log(\"Available roles:\", Object.keys(elderlyTableColsMapping));\r\n    if (role === \"support_agent\") {\r\n      const cols = elderlyTableColsMapping.support_agent.map((col) => {\r\n        return elderlyTableColumns[col];\r\n      });\r\n      setElderlyTableColumns(cols);\r\n    } else if (role === \"nurse\") {\r\n      const cols = elderlyTableColsMapping.nurse.map((col) => {\r\n        return elderlyTableColumns[col];\r\n      });\r\n      setElderlyTableColumns(cols);\r\n    } else if (role === \"end_user\") {\r\n      const cols = elderlyTableColsMapping.end_user.map((col) => {\r\n        return elderlyTableColumns[col];\r\n      });\r\n      setElderlyTableColumns(cols);\r\n    } else {\r\n      setElderlyTableColumns([]);\r\n    }\r\n  }, []);\r\n  return elderlyTableColumn;\r\n}\r\n\r\nexport { useElderlyTableColumns };\r\n","import React, { useEffect, useState, useCallback, useMemo } from \"react\";\r\nimport CustomTable from \"@/Shared/Table/CustomTable\";\r\nimport { useElderlyTableColumns } from \"./Utiles/utiles2\";\r\nimport { SidebarContext } from \"@/Context/CustomUsertable\";\r\nimport SearchInput from \"@/Shared/Search/SearchInput\";\r\nimport { getElderlies } from \"@/api/elderly\";\r\nimport debounce from \"lodash/debounce\";\r\n\r\nexport default function ElderlyList() {\r\n  const [search, setSearch] = useState(\"\");\r\n  const [elderlies, setElderlies] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [elderliesQuery, setElderliesQuery] = useState({});\r\n  const columns = useElderlyTableColumns(\"support_agent\");\r\n  const user = JSON.parse(localStorage.getItem(\"user\"));\r\n  // Debounced search\r\n  const debouncedSetQuery = useMemo(\r\n    () =>\r\n      debounce((value) => {\r\n        setElderliesQuery((prev) => ({ ...prev, name: value.trim() }));\r\n      }, 500),\r\n    []\r\n  );\r\n\r\n  useEffect(() => {\r\n    return () => debouncedSetQuery.cancel();\r\n  }, [debouncedSetQuery]);\r\n\r\n  const handleSearchChange = (value) => {\r\n    setSearch(value);\r\n    if (value === \"\") {\r\n      debouncedSetQuery.cancel();\r\n      setElderliesQuery((prev) => ({ ...prev, name: \"\" }));\r\n    } else {\r\n      debouncedSetQuery(value);\r\n    }\r\n  };\r\n\r\n  const getElderlyList = useCallback(() => {\r\n    setLoading(true);\r\n    getElderlies(elderliesQuery)\r\n      .then((res) => setElderlies(res))\r\n      .catch((err) => console.log(err))\r\n      .finally(() => setLoading(false));\r\n  }, [elderliesQuery]);\r\n\r\n  useEffect(() => {\r\n    getElderlyList();\r\n  }, [getElderlyList]);\r\n\r\n  function hnadleChangeElderlyFilter(data) {\r\n    switch (data) {\r\n      case \"diseases\":\r\n        return setElderliesQuery({ diseases: true });\r\n      case \"comments\":\r\n        return setElderliesQuery({ comments: true });\r\n      case \"medications\":\r\n        return setElderliesQuery({ medications: true });\r\n      default:\r\n        return setElderliesQuery({});\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div\r\n      id=\"Elderlies\"\r\n      className=\"w-full flex flex-col gap-4 justify-center items-center bg-white rounded-2xl p-6 mt-8\"\r\n    >\r\n      <div id=\"Elderlies_Header\" className=\"w-full flex justify-between\">\r\n        <h1 className=\"text-[24px] font-bold\">\r\n          {user?.role == \"nurse\" ? \"Residents\" : \"Users\"}\r\n        </h1>\r\n        <div className=\"flex gap-4\">\r\n          <SearchInput\r\n            search={search}\r\n            setSearch={handleSearchChange}\r\n            placeholder=\"Search Users\"\r\n          />\r\n        </div>\r\n      </div>\r\n      <SidebarContext.Provider\r\n        value={{\r\n          total: elderlies?.data?.length,\r\n          page: 1,\r\n          SetPage: () => {},\r\n          getlist: getElderlyList,\r\n        }}\r\n      >\r\n        <CustomTable\r\n          loading={loading}\r\n          columns={columns}\r\n          tableData={elderlies?.data}\r\n        />\r\n      </SidebarContext.Provider>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["ElderlyAction","row","navigate","useNavigate","sharedMethod","useContext","SidebarContext","edit","setEdit","useState","handleViewClick","handleEditClick","jsxs","Fragment","Space","jsx","Button","AiOutlineEdit","AiOutlineEye","CreateAndEditUsers","useElderlyTableColumns","role","user_role","_a","elderlyTableColsMapping","elderlyTableColumns","Elderly","text","comment","d","LuNavigation","elderlyTableColumn","setElderlyTableColumns","useEffect","cols","col","ElderlyList","search","setSearch","elderlies","setElderlies","loading","setLoading","elderliesQuery","setElderliesQuery","columns","user","debouncedSetQuery","useMemo","debounce","value","prev","handleSearchChange","getElderlyList","useCallback","getElderlies","res","err","SearchInput","CustomTable"],"mappings":"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"}