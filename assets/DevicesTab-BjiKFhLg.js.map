{"version":3,"file":"DevicesTab-BjiKFhLg.js","sources":["../../src/Pages/Elderlies/Components/TabContents/Devices/DevicesTab.jsx"],"sourcesContent":["import React, { useCallback, useContext, useEffect, useState } from \"react\";\r\nimport deviceImg from \"./images/1.png\";\r\nimport { IoCheckmarkSharp } from \"react-icons/io5\";\r\nimport { PiShieldWarning } from \"react-icons/pi\";\r\nimport { CustomContext } from \"@/Context/UseCustomContext\";\r\nimport { Button, Modal, Tag, Tooltip } from \"antd\";\r\nimport { PiGearBold } from \"react-icons/pi\";\r\nimport ModalComponent from \"@/Components/Modal\";\r\nimport { ExclamationCircleFilled } from \"@ant-design/icons\";\r\nimport DeviceConfigurationModal from \"@/Components/Modal\";\r\nimport { getDeviceInfo } from \"@/api/deviceReports\";\r\nimport { getSignalStrength } from \"@/utils/helper\";\r\nimport { FaWifi } from \"react-icons/fa6\";\r\nexport default function DevicesTab() {\r\n  const { elderlyDetails } = useContext(CustomContext);\r\n\r\n  return (\r\n    <>\r\n      <div className=\"flex flex-col gap-4 mt-6\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <h1 className=\"text-[24px] font-bold text-[#1B2559]\">Devices</h1>\r\n        </div>\r\n        <div\r\n          id=\"devices\"\r\n          className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-6\"\r\n        >\r\n          {elderlyDetails?.rooms\r\n            ?.filter((tab) => tab?.device_no)\r\n            .map((device) => (\r\n              <DeviceCard key={device.id} device={device} />\r\n            ))}\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n\r\nconst DeviceCard = ({ device = {} }) => {\r\n  const [visible, setVisible] = useState(false);\r\n  const [openOfflineModal, setOpenOfflineModal] = useState(false);\r\n  const { elderlyDetails } = useContext(CustomContext);\r\n  const [loadingDevice, setLoadingDevice] = useState(false);\r\n  const [deviceInfo, setDeviceInfo] = useState();\r\n  const deviceUID = device?.device_no;\r\n  const fetchDeviceInfo = useCallback(async () => {\r\n    if (!deviceUID) return;\r\n    setLoadingDevice(true);\r\n    try {\r\n      const res = await getDeviceInfo(deviceUID);\r\n      setDeviceInfo(res?.data);\r\n    } catch (err) {\r\n      console.error(\"Error fetching device info\", err);\r\n    } finally {\r\n      setLoadingDevice(false);\r\n    }\r\n  }, [deviceUID]);\r\n  useEffect(() => {\r\n    fetchDeviceInfo();\r\n\r\n    const interval = setInterval(() => {\r\n      fetchDeviceInfo();\r\n    }, 5000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [fetchDeviceInfo]);\r\n\r\n  const signal =\r\n    deviceInfo?.signal_intensity &&\r\n    getSignalStrength(\"wifi\", deviceInfo?.signal_intensity);\r\n\r\n  return (\r\n    <div className=\"flex flex-col gap-8 bg-white rounded-xl p-4 group  cursor-pointer device_modal\">\r\n      <div className=\"flex items-center justify-between gap-4 w-full \">\r\n        <div className=\"flex items-center gap-4\">\r\n          <div id=\"deviceImg\">\r\n            <img src={deviceImg} alt=\"device\" width={84} height={84} />\r\n          </div>\r\n          <div className=\"flex flex-col\">\r\n            <h1 className=\"text-[22px] font-semibold text-[#1B2559] flex items-center gap-2\">\r\n              {device?.name}{\" \"}\r\n              <div className=\"size-1.5 bg-slate-400 rounded-full\"></div>\r\n              <span className=\"text-base opacity-85 cursor-pointer\">\r\n                {device?.device_no}\r\n              </span>\r\n            </h1>\r\n            <div id=\"status\" className=\"flex items-center gap-2\">\r\n              {/* <div\r\n                className=\"rounded-full w-[8px] h-[8px]\"\r\n                style={{ backgroundColor: signal?.color }}\r\n              ></div> */}\r\n              {device?.is_device_bind ? (\r\n                <FaWifi color={signal?.color} />\r\n              ) : (\r\n                <FaWifi color={\"red\"} />\r\n              )}\r\n              <p className=\"text-[16px] font-semibold text-primary capitalize\">\r\n                {device?.is_device_bind ? \"Online\" : \"Offline\"}\r\n              </p>\r\n              {signal && <Tag color={signal?.color}>{signal.label}</Tag>}\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <Tooltip title=\"Settings\">\r\n          <Button\r\n            shape=\"circle\"\r\n            onClick={() => {\r\n              if (device?.is_device_bind) {\r\n                setVisible(true);\r\n              } else {\r\n                setOpenOfflineModal(true);\r\n              }\r\n            }}\r\n          >\r\n            <PiGearBold />\r\n          </Button>\r\n        </Tooltip>\r\n      </div>\r\n      {/* <div id=\"issue\" className=\"flex items-start justify-start gap-2 w-[60%]\">\r\n        <div id=\"icon\">\r\n          {device.issueStatus === \"0\" ? (\r\n            <IoCheckmarkSharp size={18} color=\"#00c42e\" />\r\n          ) : (\r\n            <PiShieldWarning size={18} color=\"#ff9f0d\" />\r\n          )}\r\n        </div>\r\n        <p className=\"text-[15px] font-medium text-[#1B2559] capitalize\">\r\n          {device.issue || \"--\"}\r\n        </p>\r\n      </div> */}\r\n      <DeviceConfigurationModal\r\n        isvisible={visible}\r\n        setVisible={setVisible}\r\n        elderly_id={elderlyDetails._id}\r\n        device_id={device?.device_no}\r\n        room_id={device?._id}\r\n      />\r\n      <DeviceOfflineModal\r\n        isvisible={openOfflineModal}\r\n        setVisible={setOpenOfflineModal}\r\n      />\r\n    </div>\r\n  );\r\n};\r\nconst DeviceOfflineModal = ({ isvisible = false, setVisible }) => {\r\n  function onClose() {\r\n    setVisible(false);\r\n  }\r\n  return (\r\n    <>\r\n      <Modal\r\n        centered\r\n        open={isvisible}\r\n        onCancel={onClose}\r\n        onOk={onClose}\r\n        className=\"device-offline-modal \"\r\n        title={\r\n          <div className=\"flex items-center gap-2 p-6\">\r\n            <ExclamationCircleFilled className=\"text-yellow-500\" />\r\n            <span>Offline Device</span>\r\n          </div>\r\n        }\r\n        footer={\r\n          <div className=\"p-6\">\r\n            <Button onClick={() => setVisible(false)}>Ok</Button>\r\n          </div>\r\n        }\r\n        okText=\"OK\"\r\n        cancelButtonProps={{ style: { display: \"none\" } }}\r\n      >\r\n        <div className=\"px-4\">\r\n          <p>\r\n            This device is currently offline. You cannot make any changes now.\r\n          </p>\r\n        </div>\r\n      </Modal>\r\n    </>\r\n  );\r\n};\r\n"],"names":["DevicesTab","elderlyDetails","useContext","CustomContext","jsx","Fragment","jsxs","tab","device","DeviceCard","visible","setVisible","useState","openOfflineModal","setOpenOfflineModal","loadingDevice","setLoadingDevice","deviceInfo","setDeviceInfo","deviceUID","fetchDeviceInfo","useCallback","res","getDeviceInfo","err","useEffect","interval","signal","getSignalStrength","deviceImg","FaWifi","Tag","Tooltip","Button","PiGearBold","DeviceConfigurationModal","DeviceOfflineModal","isvisible","onClose","Modal","ExclamationCircleFilled"],"mappings":"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"}