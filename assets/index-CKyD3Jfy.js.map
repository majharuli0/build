{"version":3,"file":"index-CKyD3Jfy.js","sources":["../../src/MonitoringService/Components/CustomerTable/index.jsx"],"sourcesContent":["import React, { useEffect, useCallback, useMemo, useState } from \"react\";\r\nimport CardUI from \"../common/card\";\r\nimport TableUI from \"../common/table\";\r\nimport { Button } from \"../ui/button\";\r\nimport {\r\n  TableProvider,\r\n  useTable,\r\n} from \"@/MonitoringService/Context/TableContext\";\r\nimport { useColumns } from \"@/MonitoringService/Utiles/columnsUtil\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { Badge } from \"../ui/badge\";\r\nimport { BiSort } from \"react-icons/bi\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { Input } from \"../ui/input\";\r\nimport { useCustomers } from \"@/MonitoringService/hooks/useCustomer\";\r\nimport debounce from \"lodash/debounce\";\r\nimport { useCustomerStore } from \"@/MonitoringService/store/useCustomerStore\";\r\n\r\nexport default function CustomerTable() {\r\n  const { page, setPage, actions, setActions } = useTable();\r\n  const { setCustomers } = useCustomerStore();\r\n  const { type } = useParams();\r\n  const [isAsc, setIsAsc] = useState(true);\r\n  const columns = useColumns(\"customer\");\r\n  const [total, setTotal] = useState(0);\r\n  const [quary, setQuay] = useState({});\r\n  const {\r\n    data: customer,\r\n    isLoading,\r\n    isSuccess,\r\n    refetch,\r\n  } = useCustomers({ ...page, ...quary, soft_deleted: type === \"deactivated\" });\r\n  useEffect(() => {\r\n    if (isSuccess && customer) setCustomers(customer?.data || []);\r\n    setTotal(customer?.total || 0);\r\n  }, [customer, isSuccess]);\r\n  const fetchData = useCallback(() => {}, [page]);\r\n\r\n  const deleteRow = useCallback(\r\n    (row) => {\r\n      console.log(\"ðŸ—‘ï¸ Deleting row:\", row);\r\n      fetchData();\r\n    },\r\n    [fetchData]\r\n  );\r\n\r\n  useEffect(() => {\r\n    setActions({\r\n      fetchData,\r\n      deleteRow,\r\n    });\r\n  }, [fetchData, deleteRow, setActions]);\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, [page, fetchData]);\r\n  const handleToggle = () => setIsAsc((prev) => !prev);\r\n  const handleSearchChnage = useCallback(\r\n    debounce((value) => {\r\n      setQuay((prev) => ({ ...prev, search: value?.trim() }));\r\n      setPage((prev) => ({ ...prev, page: 1 }));\r\n    }, 1000),\r\n    []\r\n  );\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      handleSearchChnage.cancel();\r\n    };\r\n  }, []);\r\n  return (\r\n    <CardUI\r\n      variant=\"noborder\"\r\n      title={\r\n        <div className=\"text-xl font-normal capitalize flex items-center gap-2\">\r\n          {type} Customers{\" \"}\r\n          <Badge\r\n            className={`text-sm ${\r\n              type !== \"active\"\r\n                ? type == \"paused\"\r\n                  ? \"bg-yellow-600\"\r\n                  : \"bg-red-500\"\r\n                : \"\"\r\n            }`}\r\n          >\r\n            {total}\r\n          </Badge>\r\n        </div>\r\n      }\r\n      className=\"mb-7\"\r\n      actions={\r\n        <div className=\"flex items-center gap-2\">\r\n          <Input\r\n            className=\"\"\r\n            size=\"bt\"\r\n            variant=\"outline\"\r\n            placeholder=\"Search Customer\"\r\n            onChange={(e) => {\r\n              if (total > 0) {\r\n                handleSearchChnage(e.target.value);\r\n              }\r\n            }}\r\n          />\r\n          <Button\r\n            variant=\"tertiary\"\r\n            onClick={handleToggle}\r\n            className=\"flex items-center gap-2 select-none\"\r\n          >\r\n            <motion.span\r\n              animate={{ rotate: isAsc ? 0 : 180 }}\r\n              transition={{ duration: 0.25, ease: \"easeInOut\" }}\r\n              className=\"inline-block\"\r\n            >\r\n              <BiSort className=\"w-5 h-5\" />\r\n            </motion.span>\r\n            <span>Priority</span>\r\n          </Button>\r\n        </div>\r\n      }\r\n    >\r\n      <div className=\"bg-background/50\">\r\n        <TableUI\r\n          columns={columns}\r\n          data={customer?.data || []}\r\n          isPagination\r\n          total={total}\r\n          limit={15}\r\n          headerClassName=\"bg-background/60\"\r\n          headerTextClassName=\"text-text/60\"\r\n          isLoading={isLoading}\r\n          rowClassName=\"\"\r\n          //   cellClassName=\"text-gray-200\"\r\n        />\r\n      </div>\r\n    </CardUI>\r\n  );\r\n}\r\n"],"names":["CustomerTable","page","setPage","actions","setActions","useTable","setCustomers","useCustomerStore","type","useParams","isAsc","setIsAsc","useState","columns","useColumns","total","setTotal","quary","setQuay","customer","isLoading","isSuccess","refetch","useCustomers","useEffect","fetchData","useCallback","deleteRow","row","handleToggle","prev","handleSearchChnage","debounce","value","jsx","CardUI","jsxs","Badge","Input","e","Button","motion","BiSort","TableUI"],"mappings":"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"}