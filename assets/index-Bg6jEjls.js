import{j as e,r as a,Z as el,a0 as ll,Y as tl,X as al,$ as sl,aN as nl,aO as G,a9 as me,E as C,a2 as w,aP as ol,aQ as il,aR as rl,l as K,a3 as dl,ac as ue,aS as cl}from"./index-BKgsd5ix.js";import{E as _}from"./index-D-dVG7k9.js";import"./line-DSLxdCJP.js";import{F as fe}from"./lines-Bj-V7FuR.js";import"./bar-Ti1iyFnf.js";import{b as xl,c as ul,d as fl,e as pl,f as hl,h as ml,i as gl,j as E,k as bl,g as jl}from"./Dashboard-BVH8pG8w.js";import"./FileSaver.min-DZOLjBMf.js";import{I as yl}from"./index-CTJBQug3.js";import{B as vl}from"./index-C0OG5Gj1.js";/* empty css                */import{R as wl}from"./ReportActionModal-ClwSS63r.js";import{W as Nl}from"./WeeklyMonthlyPicker-CZN0yFOO.js";import{g as pe}from"./helper-Q2f27-hf.js";function Cl({data:t=[]}){const s=t.map(r=>r._id),i=t.map(r=>r.total_orders),d={tooltip:{trigger:"axis"},grid:{left:"0%",right:"0%",bottom:"10%",containLabel:!0},xAxis:{type:"category",data:s},yAxis:{type:"value"},series:[{data:i,type:"line",symbol:"circle",symbolSize:10,itemStyle:{color:"#4379EE"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(67, 121, 238, 0.5)"},{offset:1,color:"rgba(255, 255, 255, 0) "}]}},lineStyle:{color:"#4379EE"}}],graphic:i.length===0?{type:"text",left:"center",top:"middle",style:{text:"No Data Available",fontSize:20,fontWeight:"bold",fill:"#999"}}:null};return e.jsx(_,{notMerge:!0,option:d,style:{width:"100%",height:"100%"}})}function he({data:t=[],chartFor:s=""}){const i=t.reduce((o,u)=>o+u.total_orders,0),[d,r]=a.useState({}),f={completed:"Completed",pending:"In Progress",cancelled:"Cancelled",not_started:"Not Started"};a.useEffect(()=>{s==="totalSales"?r({completed:"#4379EE",pending:"#F1963A",cancelled:"#D90000"}):s==="totalInstallations"&&r({completed:"#36b610",pending:"#833af1",not_started:"#5d5d5d"})},[s]);const n={tooltip:{trigger:"item"},grid:{left:"0%",right:"0%",bottom:"0%",top:"0%",containLabel:!0},series:[{type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,position:"center"},emphasis:{label:{show:!1}},labelLine:{show:!0},data:t.map(o=>({value:o.total_orders,name:f[o.property_name]||"Unknown Status",itemStyle:{color:d[o.property_name]}}))}],graphic:{elements:[{type:"text",id:"center-total-text",left:"center",top:"53%",style:{text:"Total",textAlign:"center",fill:"#333",fontSize:16}},{type:"text",id:"center-value-text",left:"center",top:"45%",style:{text:i,textAlign:"center",fill:"#333",fontSize:22,fontWeight:"bold"},position:[0,50]}]}};return e.jsx(_,{notMerge:!0,option:n,style:{width:"340px",height:"340px"}})}function F({data:t=[],graphTitle:s}){const i=t.map(f=>f.property_name||f.elderly_name||"Unknown"),d=t.map(f=>f.total_orders||f.count);console.log(t);const r={xAxis:{max:"dataMax"},tooltip:{},grid:{left:"0%",right:"0%",bottom:"10%",top:"5%",containLabel:!0},yAxis:{type:"category",data:i,inverse:!0,animationDuration:300,animationDurationUpdate:300},dataZoom:[{type:"inside",yAxisIndex:0,start:0,end:100}],series:[{name:s,type:"bar",data:d,itemStyle:{color:"#4379EE"},label:{show:!0,valueAnimation:!0},barWidth:d.length<5?30:"auto"}],label:{show:!0},legend:{show:!1},graphic:d.length===0?{type:"text",left:"center",top:"middle",style:{text:"No Data Available",fontSize:20,fontWeight:"bold",fill:"#999"}}:null};return e.jsx(_,{notMerge:!0,option:r,style:{width:"100%",height:"100%"}})}function P({data:t=[],chartFor:s}){const[i,d]=a.useState({});return a.useEffect(()=>{if(t.length===0){d({graphic:{type:"text",left:"center",top:"middle",style:{text:"No Data Available",fontSize:20,fontWeight:"bold",fill:"#999"}}});return}const f=s==="age"?["20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99"]:t.map(g=>g._id),n=[{name:"Male",type:"bar",color:"#357AF6",data:f.map(g=>{const b=t.find(j=>j._id===g);return b?b.male_count:0})},{name:"Female",type:"bar",color:"#5CC8BE",data:f.map(g=>{const b=t.find(j=>j._id===g);return b?b.female_count:0})}],o=Math.max(...n.flatMap(g=>g.data)),u={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{show:!0,top:0,data:["Male","Female"]},grid:{left:s==="age"?"0%":"5%",right:"0%",bottom:"10%",top:"10%",containLabel:!0},series:n};s==="age"?(u.xAxis={type:"category",data:f},u.yAxis={type:"value",boundaryGap:[0,.01],min:0,max:o,interval:1,axisLabel:{formatter:g=>Math.floor(g)}}):s==="diseases"&&(u.yAxis={type:"category",data:f},u.xAxis={type:"value",boundaryGap:[0,.01],min:0,max:o,interval:1,axisLabel:{formatter:g=>Math.floor(g)}}),d(u)},[t.length]),e.jsx(_,{notMerge:!0,option:i,style:{width:"100%",height:"100%"}})}function U({data:t=[],chartFor:s}){const[i,d]=a.useState([]);a.useEffect(()=>{let n=t==null?void 0:t.map(o=>{if(s==="device"){console.log(t);const u={completed:"#08A1F7",pending:"#922BF2",not_started:"#FF3B11"},g=t.map(h=>u[h._id]),b={...r,color:g};f(b);const j={not_started:"Not Started",completed:"Completed",pending:"Pending"};return{value:o.count,name:j[o._id]||o._id}}else return{value:o.male_count+o.female_count,name:o._id==="male"?"Male":o._id==="fe-male"?"Female":null}});d(n)},[t]);const[r,f]=a.useState({title:{},tooltip:{trigger:"item"},legend:{show:!1},labelLine:{show:!1},color:["#4379EE","#5CC8BE","#243642","#BC7C7C"]});return a.useEffect(()=>{const n={...r};s=="gender"?n.series=[{type:"pie",radius:"50%",data:i,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]:s=="device"&&(n.series=[{type:"pie",radius:"50%",data:i,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]),f(n)},[s,i]),e.jsx(_,{notMerge:!0,option:r,style:{width:"340px",height:"340px"}})}const Sl=[{role:"monitoring_station",label:"Monitoring Station",color:"#EA5A92",icon:el,rolesAllowed:["sales_agent","distributor","office"]},{role:"supports_agent",label:"Support Agent",color:"#17C3A5",icon:ll,rolesAllowed:["supports_agent","monitoring_station"]},{role:"nursing_home",label:"Nursing Home",color:"#5096F6",icon:tl,rolesAllowed:["sales_agent","distributor","office"]},{role:"distributor",label:"Distributor",color:"#FA8035",icon:yl,rolesAllowed:[]},{role:"sales_agent",label:"Sales Agent",color:"#D188E1",icon:al,rolesAllowed:["sales_agent","distributor","office"]},{role:"end_user",label:"End User",color:"#7DBBE2",icon:fe,rolesAllowed:["sales_agent","distributor","office"]},{role:"installer",label:"Installer",color:"#7695FF",icon:fe,rolesAllowed:["monitoring_station","office","sales_agent"]},{role:"elderly",label:"Elderly",color:"#FF885B",icon:sl,rolesAllowed:["monitoring_station"]},{role:"office",label:"Office",color:"#FF885B",icon:nl,rolesAllowed:[""]},{role:"device",label:"Device",color:"#FF885B",icon:vl,rolesAllowed:["distributor"]}];function Al({data:t=[]}){const s=t.filter(o=>o.type===1).reduce((o,u)=>o+u.count,0),i=t.filter(o=>o.type===2).reduce((o,u)=>o+u.count,0),d=t.filter(o=>o.type===3).reduce((o,u)=>o+u.count,0),r=[{value:s,name:"Info"},{value:i,name:"Warning"},{value:d,name:"Critical"}],f=r.reduce((o,u)=>o+u.value,0),n={tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},color:["#4379EE","#F1963A","#D90000"],series:[{name:"Activity",type:"pie",radius:["40%","70%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:10,borderColor:"#fff",borderWidth:2},label:{show:!1,formatter:"{b}: {c} ({d}%)"},emphasis:{label:{show:!1,fontSize:18,fontWeight:"bold"}},data:t.length!==0?r:null}],graphic:{elements:[{type:"text",left:"center",top:"53%",style:{text:"Total",textAlign:"center",fill:"#333",fontSize:16}},{type:"text",left:"center",top:"45%",style:{text:f.toString(),textAlign:"center",fill:"#333",fontSize:22,fontWeight:"bold"}}]}};return e.jsx(_,{option:n,style:{width:"340px",height:"340px"}})}const ge=({data:t=[]})=>{const s=t.length>0,i={title:{},tooltip:{trigger:"item",textStyle:{color:"#333",fontSize:16,fontFamily:"Arial, sans-serif"},formatter:function(d){return`
            <div style="padding: 5px; text-align: left;">
              <div><strong>Activity:</strong> ${d.data[0]}</div>
              <div><strong>Count:</strong> ${d.data[1]}</div>
            </div>
          `}},grid:{left:"2%",right:"0%",bottom:"30%",top:"12%",containLabel:!0},xAxis:{type:"category",axisLabel:{show:!1},axisLine:{show:!1},axisTick:{show:!1}},yAxis:{type:"value",name:"Count",nameLocation:"center",nameGap:40,scale:!0,splitLine:{show:!1}},dataZoom:s?[{type:"inside",start:0,end:100},{type:"slider",start:0,end:100}]:[],series:s?[{type:"scatter",symbolSize:function(d){return Math.min(Math.sqrt(d[1])*5,40)},data:t.map(d=>[d.property_name,d.count]),label:{show:!1},itemStyle:{color:"rgba(67, 121, 238, 0.8)"}}]:[]};return t.length===0?e.jsxs("div",{className:"w-full h-full flex items-center justify-center",children:[" ",e.jsxs("span",{className:"text-[#999999] font-semibold text-xl",children:[" ","No Data Available"]})," "]}):e.jsx(_,{option:i,style:{height:"370px",width:"100%"},opts:{renderer:"canvas"}})};function _l({count:t,chartByAge:s=[],chartByGender:i=[],diseasesCountByGender:d=[],alertsCountByName:r=[],alertsCountByElderly:f=[]}){return console.log(s),e.jsxs("div",{className:"w-full flex flex-col gap-6 pt-6",children:[e.jsxs("div",{className:"flex gap-6 lg:flex-row flex-col h-fit",children:[e.jsxs("div",{className:"rounded-2xl lg:w-[75%] w-full flex flex-col gap-6 h-full",children:[e.jsx("div",{id:"Reports",className:"w-full rounded-2xl flex flex-col gap-6",children:e.jsx("div",{id:"Cards",className:"grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-3",children:t==null?void 0:t.map((n,o)=>{let u=n.icon;return e.jsxs("div",{id:"Card",style:{backgroundColor:n==null?void 0:n.color},className:"cursor-pointer group flex w-full items-center p-4 py-6 text-white gap-3 rounded-[12px] relative overflow-hidden",children:[e.jsx("div",{id:"circle",className:"w-[100px] h-[100px] bg-white/20 absolute -right-11 -top-14 rounded-full group-hover:-right-5 group-hover:-top-[75px] transition-all duration-200 ease-in-out"}),e.jsx("div",{id:"circle",className:"w-[100px] h-[100px] bg-white/10 absolute -right-3 -top-[70px] rounded-full group-hover:-right-[50px] group-hover:-top-[45px] transition-all duration-200 ease-in-out"}),e.jsx("div",{className:"bg-opacity-10 h-fit rounded-[8px] p-2 bg-black/20",children:u&&e.jsx(u,{color:"#fff",size:20})}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("h1",{className:"text-[26px] font-semibold leading-none",children:n.count||0}),e.jsx("span",{className:"text-[14px] font-medium text-white/70 leading-none",children:n.label})]})]},o)})})}),e.jsxs("div",{className:"p-[25px] rounded-2xl bg-white w-full h-[445px] flex-grow",children:[e.jsx("div",{id:"ChartHeader",className:"w-full flex justify-between",children:e.jsx("h1",{className:"text-[24px] font-bold",children:"Ages"})}),e.jsx(P,{data:i,chartFor:"age"})]}),e.jsxs("div",{className:"p-[25px] rounded-2xl bg-white w-full h-[445px] flex-grow",children:[e.jsx("div",{id:"ChartHeader",className:"w-full flex justify-between",children:e.jsx("h1",{className:"text-[24px] font-bold",children:"Diseases"})}),e.jsx(P,{data:d,chartFor:"diseases"})]})]}),e.jsxs("div",{className:"rounded-2xl lg:w-[35%] w-full flex flex-col gap-6 h-full",children:[e.jsxs("div",{className:"p-[25px] rounded-2xl bg-white w-full flex flex-col h-[496px] justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{id:"ChartHeader",className:"w-full flex justify-between",children:e.jsx("h1",{className:"text-[24px] font-bold",children:"Gender"})}),e.jsx("div",{className:"h-[260px] my-0 mx-auto flex items-center justify-center",children:e.jsx(U,{data:s,chartFor:"gender"})})]}),e.jsxs("div",{id:"ChartInfo",className:"w-full flex flex-col gap-2",children:[e.jsxs("div",{id:"InfoItem",className:"w-full flex justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"w-[12px] h-[12px] bg-text-primary rounded-full"}),e.jsx("span",{className:"text-lg font-medium",children:"Total"})]}),e.jsx("span",{className:"text-lg font-semibold",children:s.reduce((n,o)=>n+o.male_count+o.female_count,0)})]}),e.jsxs("div",{id:"InfoItem",className:"w-full flex justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"w-[12px] h-[12px] bg-[#4379EE] rounded-full"}),e.jsx("span",{className:"text-lg font-medium",children:"Male"})]}),e.jsxs("span",{className:"text-lg font-semibold",children:[s.map(n=>n._id==="male"&&n.male_count||0),s.length===0&&e.jsx(e.Fragment,{children:"0"})]})]}),e.jsxs("div",{id:"InfoItem",className:"w-full flex justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"w-[12px] h-[12px] bg-[#5CC8BE] rounded-full"}),e.jsx("span",{className:"text-lg font-medium",children:"Female"})]}),e.jsxs("span",{className:"text-lg font-semibold",children:[" ",s.map(n=>n._id==="female"&&n.male_count||0),s.length===0&&e.jsx(e.Fragment,{children:"0"})]})]})]})]}),e.jsxs("div",{className:"p-[25px] rounded-2xl bg-white w-full flex flex-col h-[496px] justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{id:"ChartHeader",className:"w-full flex justify-between",children:[e.jsx("h1",{className:"text-[24px] font-bold",children:"Activity"}),e.jsx("div",{id:"chartController",className:"flex gap-4"})]}),e.jsx("div",{className:"h-[260px] my-0 mx-auto flex items-center justify-center",children:e.jsx(Al,{data:r})})]}),e.jsxs("div",{id:"ChartInfo",className:"w-full flex flex-col gap-2",children:[e.jsxs("div",{id:"InfoItem",className:"w-full flex justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"w-[12px] h-[12px] bg-[#4379EE] rounded-full"}),e.jsx("span",{className:"text-lg font-medium",children:"Info"})]}),e.jsx("span",{className:"text-lg font-semibold",children:r.filter(n=>n.type===1).reduce((n,o)=>n+o.count,0)})]}),e.jsxs("div",{id:"InfoItem",className:"w-full flex justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"w-[12px] h-[12px] bg-[#F1963A] rounded-full"}),e.jsx("span",{className:"text-lg font-medium",children:"Warning"})]}),e.jsx("span",{className:"text-lg font-semibold",children:r.filter(n=>n.type===2).reduce((n,o)=>n+o.count,0)})]}),e.jsxs("div",{id:"InfoItem",className:"w-full flex justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"w-[12px] h-[12px] bg-[#D90000] rounded-full"}),e.jsx("span",{className:"text-lg font-medium",children:"Critical"})]}),e.jsx("span",{className:"text-lg font-semibold",children:r.filter(n=>n.type===3).reduce((n,o)=>n+o.count,0)})]})]})]})]})]}),e.jsxs("div",{className:"w-full flex gap-6 xl:flex-row flex-col h-[500px] justify-between",children:[e.jsxs("div",{className:"p-[25px] rounded-2xl bg-white w-full h-[445px]",children:[e.jsx("div",{id:"ChartHeader",className:"w-full flex justify-between",children:e.jsx("h1",{className:"text-[24px] font-bold",children:"Most Alerts"})}),e.jsx(F,{data:f})]}),e.jsxs("div",{className:"p-[25px] rounded-2xl bg-white w-full h-[445px]",children:[e.jsx("div",{id:"ChartHeader",className:"w-full flex justify-between",children:e.jsx("h1",{className:"text-[24px] font-bold",children:"Activity Count"})}),e.jsx(ge,{data:r})]})]})]})}function Il({row:t}){const s=a.useContext(me),[i,d]=a.useState(t==null?void 0:t.installation_status),[r,f]=a.useState(!1),n=o=>{d(o),f(!0),ol(t==null?void 0:t._id,{installation_status:o}).then(u=>{console.log(u),s.getInstallationList.getCompletedandToBeInstalled(),s.getInstallationList.getDeviceSalesCounts(),u&&d(o)}).catch(u=>{console.log(u),d(t==null?void 0:t.installation_status)}).finally(()=>{f(!1)})};return a.useEffect(()=>{d(t==null?void 0:t.installation_status)},[t==null?void 0:t.installation_status]),e.jsxs("div",{className:"flex items-center space-x-2 mr-0 ",children:[e.jsx("span",{className:`w-3 h-3 rounded-full relative -right-2 ${i==="completed"?"bg-[#1EB564]":i==="pending"?"bg-yellow-500":"bg-red-500"}`}),e.jsx(C,{theme:{token:{colorText:"#707EAE",colorPrimary:"#8086AC",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:e.jsx(w,{value:i,variant:"borderless",onChange:n,loading:r,optionSelectedColor:"#8086AC",className:"w-fit !text-red-100",options:[{value:"completed",label:e.jsx("span",{children:"Complete"})},{value:"pending",label:e.jsx("span",{children:"Pending"})},{value:"not_started",label:e.jsx("span",{children:"Not Started"})}]})})]})}const kl=[{title:"Installation Status",render:t=>e.jsx(Il,{row:t})},{title:"Report",render:t=>e.jsx("div",{className:"flex justify-center",children:e.jsx(wl,{report:t})})},{title:"Product Name",render:t=>e.jsx("button",{children:e.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary flex  gap-2",children:t.products.filter((s,i,d)=>{const r=s.type==="Seenyor Kit"&&d.findIndex(f=>f.type==="Seenyor Kit")===i;return!/^AI Sensor/.test(s.type)&&(s.type!=="Seenyor Kit"||r)}).map((s,i)=>{const d=s.type==="Seenyor Kit"?"blue":s.type==="Installation"?"orange":"default";return e.jsx(G,{color:d,children:s.type==="Seenyor Kit"?"Package":s.type},i)})})})},{title:"Product Price",render:t=>e.jsx("button",{children:e.jsxs("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary",children:["$",t.products.filter(s=>["Seenyor Kit","Installation","AI Monitoring"].includes(s.type)).reduce((s,i)=>s+i.price,0).toFixed(2)]})})},{title:"Addon Name",render:t=>e.jsx("button",{children:e.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary flex gap-2",children:t.products.filter(s=>!["Seenyor Kit","Installation","AI Monitoring"].includes(s.type)).map((s,i)=>e.jsx(G,{children:s.type},i)).length===0?e.jsx("span",{children:"--"}):t.products.filter(s=>!["Seenyor Kit","Installation","AI Monitoring"].includes(s.type)).map((s,i)=>e.jsx(G,{children:s.type},i))})})},{title:"Addon Price",render:t=>e.jsx("button",{children:e.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:t.products.map((s,i)=>["Seenyor Kit","Installation","AI Monitoring"].includes(s.type)?null:e.jsxs("span",{children:["$",s.price.toFixed(2)]},i)).filter(Boolean).length===0?e.jsx("span",{children:"--"}):t.products.map((s,i)=>["Seenyor Kit","Installation","AI Monitoring"].includes(s.type)?null:e.jsxs("span",{children:["$",s.price.toFixed(2)]},i))})})},{title:"Total Price",render:t=>e.jsx("button",{children:e.jsxs("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:["$",t.total]})})},{title:"Date of Sales",render:t=>{const s=new Date(t.created_at).toLocaleDateString("en-CA");return e.jsx("button",{children:e.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:s})})}},{title:"Location",render:t=>{var s,i,d,r,f,n;return e.jsx("button",{children:e.jsxs("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:[(s=t.address)==null?void 0:s.line1,","," ",(i=t.address)!=null&&i.line2?((d=t.address)==null?void 0:d.line2)+", ":"",","," ",(r=t.address)==null?void 0:r.city,", ",(f=t.address)==null?void 0:f.state,","," ",t.address?t.address.postal_code:" ",", ",(n=t.address)==null?void 0:n.country]})})}},{title:"Payment Status",dataIndex:"payment_status",key:"payment_status",filters:[{text:"Completed",value:"completed"},{text:"Pending",value:"pending"},{text:"Cancelled",value:"cancelled"}],filterMultiple:!0,onFilter:(t,s)=>s.payment_status.includes(t),render:t=>{let s="";switch(t){case"completed":s="green";break;case"pending":s="orange";break;case"cancelled":s="red";break;default:s="black"}return e.jsx("span",{style:{backgroundColor:s,color:"white",padding:"4px 8px",borderRadius:"4px",fontWeight:500,textTransform:"capitalize"},children:t})}}];function Dl(){const[t,s]=a.useState(!1),[i,d]=a.useState(1),[r,f]=a.useState(0),[n,o]=a.useState([]);a.useState([]);const[u,g]=a.useState([]);function b(y){s(!0),rl(y).then(v=>{o(v.data),f(v.total)}).catch(v=>{console.log(v)}).finally(()=>{s(!1)})}const j=a.useCallback(()=>{xl().then(y=>{g(y.data),console.log(y.data)}).catch(y=>{console.log(y)})},[i]),h=a.useCallback(()=>{b({installation_status:"completed",ne:!0,page:i})},[i]);return a.useEffect(()=>{h()},[h]),a.useEffect(()=>{j()},[j]),e.jsx("div",{className:"flex flex-col gap-6 pt-6",children:e.jsxs("div",{className:"w-full flex  gap-6 lg:flex-row flex-col",children:[e.jsxs("div",{id:"NewInstallation",className:"p-[25px] rounded-2xl  bg-white lg:w-[65%] w-full  h-full",children:[e.jsxs("div",{id:"ChartHeader",className:"w-full flex justify-between mb-8",children:[e.jsx("h1",{className:"text-[24px] font-bold",children:"To Be Installed"}),e.jsx("div",{id:"chartController",className:"flex gap-4"})]}),e.jsx(C,{theme:{token:{fontFamily:"Baloo2",colorPrimary:"#8086AC",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:e.jsx(me.Provider,{value:{getInstallationList:{getCompletedandToBeInstalled:h,getDeviceSalesCounts:j},total:r,page:i,SetPage:d},children:e.jsx(il,{loading:t,scroll:{x:750},columns:kl,tableData:n})})})]}),e.jsxs("div",{className:" p-[25px] rounded-2xl  bg-white lg:w-[35%] w-full",children:[e.jsxs("div",{children:[e.jsx("div",{id:"ChartHeader",className:"w-full flex justify-between",children:e.jsx("h1",{className:"text-[24px] font-bold",children:"Device Installed"})}),e.jsx("div",{className:"h-[260px] my-0 mx-auto flex items-center justify-center",children:e.jsx(U,{data:u,chartFor:"device"})})]}),e.jsx("div",{id:"ChartInfo",className:"w-full flex flex-col gap-2",children:["completed","pending","not_started"].map((y,v)=>{const S=u.find(I=>I._id===y)||{_id:y,count:0};return e.jsxs("div",{id:"InfoItem",className:"w-full flex justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:`w-[12px] h-[12px] ${S._id==="completed"?"bg-[#08A1F7]":S._id==="pending"?"bg-[#922BF2]":"bg-[#FF3B11]"} rounded-full`}),e.jsx("span",{className:"text-lg font-medium capitalize",children:S._id==="completed"?"Completed":S._id==="pending"?"Pending":"Not Started"})]}),e.jsx("span",{className:"text-lg font-semibold",children:S.count})]},v)})})]})]})})}const{RangePicker:Bl}=dl,Ll=t=>{console.log("onOk: ",t)},k=t=>{console.log("search:",t)},Yl=()=>{a.useState(!1),a.useState("Overview"),a.useState(""),a.useState(""),a.useState(!1),a.useState([]),a.useState({current:"1",size:"10"});const[t,s]=a.useState({page:1,limit:10}),[i,d]=a.useState(!1),[r,f]=a.useState(K.get("user")),[n,o]=a.useState(K.get("role")),[u,g]=a.useState(K.get("mainRole")),[b,j]=a.useState(null),[h,y]=a.useState(null),[v,S]=a.useState(null),[I,$]=a.useState("all"),[O,be]=a.useState(null),[M,je]=a.useState(null),[z,ye]=a.useState(null),[H,Q]=a.useState(null),[T,X]=a.useState(null),[V,Y]=a.useState(null),[R,El]=a.useState(null),[W,Fl]=a.useState(null),[Z,ve]=a.useState([]),[D,we]=a.useState([]),[B,Ne]=a.useState(null),[L,Ce]=a.useState([]),[Se,Ae]=a.useState([]),[_e,Ie]=a.useState([]),[ke,De]=a.useState([]),[q,Be]=a.useState([]),[J,Le]=a.useState([]),[Pl,Ee]=a.useState([]),[m,ee]=a.useState({}),[Fe,Ol]=a.useState({}),[le,Pe]=a.useState([]),[A,Oe]=a.useState([]),[te,Me]=a.useState([]),[ae,ze]=a.useState([]),[se,He]=a.useState([]),[Te,Ve]=a.useState([]),Re=a.useCallback(()=>{ul().then(l=>{Pe(l.data)}).catch(l=>{console.log(l)})},[]),We=a.useCallback(()=>{fl().then(l=>{Oe(l==null?void 0:l.data)}).catch(l=>{console.log(l)})},[]),Ge=a.useCallback(()=>{pl().then(l=>{Me(l.data)}).catch(l=>{console.log(l)})},[]),Ke=a.useCallback(()=>{hl().then(l=>{ze(l.data)}).catch(l=>{console.log(l)})},[]),Ue=a.useCallback(()=>{ml().then(l=>{const x=l.data.map(c=>{var p,N;return{property_name:(p=pe(c))==null?void 0:p.title,count:c.count,type:(N=pe(c))==null?void 0:N.status}});console.log(x),He(x)}).catch(l=>{console.log(l)})},[]);function $e(){jl().then(l=>{const c=Sl.map(p=>{var xe;const N=(xe=l.data)==null?void 0:xe.find(Je=>Je.role===p.role);return{...p,count:N?N.count:0}}).filter(p=>p.rolesAllowed.includes(r.role));Ce(c)}).catch(l=>{console.log(l)})}const ne=a.useCallback((l,x)=>{gl({office_id:m.office_id,agent_id:l,payment_status:x,from_date:b,to_date:h}).then(c=>{console.log("sales Overview",c),Ae(c.data)}).catch(c=>{console.log(c)})},[I,v,m.office_id,h]),oe=a.useCallback((l,x)=>{E({...m,total_sales_by:"agent_name",city:l,payment_status:x,from_date:b,to_date:h}).then(c=>{Ie(c.data)}).catch(c=>{console.log(c)})},[M,O,m.office_id,h]),ie=a.useCallback((l,x)=>{E({...m,total_sales_by:"location",payment_status:x,agent_id:l,from_date:b,to_date:h}).then(c=>{De(c.data),console.log(c)}).catch(c=>{console.log(c)})},[H,z,m.office_id,h]),re=a.useCallback(l=>{E({...m,total_sales_by:"payment_status",agent_id:l,from_date:b,to_date:h}).then(x=>{Be(x.data),console.log(x)}).catch(x=>{console.log(x)})},[T,m.office_id,h]),de=a.useCallback(l=>{E({...m,total_sales_by:"installation_status",agent_id:l,from_date:b,to_date:h}).then(x=>{Le(x.data),console.log(x)}).catch(x=>{console.log(x)})},[V,m.office_id,h]),ce=a.useCallback((l,x)=>{d(!0),bl({...t,...m,agent_id:l,payment_status:x,from_date:b,to_date:h}).then(c=>{console.log(c),Ee(c),d(!1)}).catch(c=>{console.log(c)})},[R,W,m.office_id,h,t]);a.useEffect(()=>{ne(I==="all"?null:I,v==="all"?null:v)},[ne]),a.useEffect(()=>{oe(M==="all"?null:M,O==="all"?null:O)},[oe]),a.useEffect(()=>{ie(H==="all"?null:H,z==="all"?null:z)},[ie]),a.useEffect(()=>{re(T==="all"?null:T)},[re]),a.useEffect(()=>{de(V==="all"?null:V)},[de]),a.useEffect(()=>{ce(W==="all"?null:W,R==="all"?null:R)},[ce]),a.useEffect(()=>{if(B)if(B==="all"){if(m.office_id){const l={...m};delete l.office_id,ee(l)}}else ee(l=>({...l,office_id:B})),X("all"),Y("all"),Q("all"),$("all")},[B]);function Qe(l){console.log(l),j(l.start),y(l.end)}function Xe(l){j(l[0]),y(l[1])}function Ye(){ue({role:"office"}).then(l=>{ve(l.data)}).catch(l=>{console.log(l)})}function Ze(){console.log("called agent get list!",Fe),ue({...m,role:"sales_agent"}).then(l=>{we(l.data)}).catch(l=>{console.log(l)})}function qe(){cl({...m}).then(l=>{Ve(l.data)}).catch(l=>{console.log(l)})}return a.useEffect(()=>{$e(),Ye(),(r.role==="nursing_home"||r.role==="monitoring_station")&&(Re(),We(),Ge(),Ke(),Ue())},[]),a.useEffect(()=>{Ze(),qe()},[m]),e.jsxs("div",{className:"",children:[(r.role=="distributor"||r.role=="office"||r.role=="sales_agent")&&e.jsxs("div",{className:"pt-[29px] flex flex-col w-full gap-6 pb-10",children:[e.jsx("div",{id:"Distributor_Dash_Top",className:"flex justify-between w-full mb-5 flex-wrap gap-5",children:e.jsxs(C,{theme:{token:{fontFamily:"Baloo2",colorPrimary:"#8086AC",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:[r.role=="office"?e.jsx("div",{className:"p-2 px-4 rounded-lg text-[36px] font-bold  text-primary",children:r.office}):r.role=="sales_agent"?null:e.jsx(w,{showSearch:!0,optionFilterProp:"label",onChange:l=>Ne(l.value),onSearch:k,defaultValue:"all",size:"large",className:"custom-select",labelInValue:!0,options:[{value:"all",label:e.jsxs(e.Fragment,{children:["All Offices"," ",e.jsx("span",{className:"highlighted-number",children:Z.length})]})},...Z.map(l=>({value:l._id,label:l.name}))]}),e.jsxs("div",{id:"DatePickers",className:"flex gap-4 items-center",children:[e.jsx(Nl,{placeholder:"Weekly/Monthly",style:{width:"140px",borderRadius:"10px"},handleChnage:Qe}),e.jsx(Bl,{showTime:!1,style:{width:"200px",borderRadius:"10px"},size:"large",placeholder:["Pick Data Range (Start)","End"],format:"YYYY-MM-DD",onChange:(l,x)=>{Xe(x)},onOk:Ll})]})]})}),e.jsx("div",{id:"Reports",className:"w-full rounded-2xl bg-transparent flex flex-col gap-6",children:e.jsx("div",{id:"Cards",className:"grid gap-5 grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5",children:L==null?void 0:L.map((l,x)=>{let c=l.icon;return e.jsxs("div",{id:"Card",className:"cursor-pointer group flex w-full items-center p-4 py-6 bg-[#fff] text-white gap-3 rounded-[12px] relative overflow-hidden",children:[e.jsx("div",{id:"circle",style:{backgroundColor:l.color,opacity:"0.9"},className:"w-[100px] h-[100px] absolute -right-11 -top-14 rounded-full group-hover:-right-5 group-hover:-top-[75px] transition-all duration-200 ease-in-out"}),e.jsx("div",{id:"circle",style:{backgroundColor:l.color,opacity:"0.2"},className:"w-[100px] h-[100px] absolute -right-3 -top-[70px] rounded-full group-hover:-right-[50px] group-hover:-top-[45px] transition-all duration-200 ease-in-out"}),e.jsx("div",{style:{backgroundColor:`${l.color}15`},className:"h-fit rounded-[8px] p-2",children:c&&e.jsx(c,{style:{color:l==null?void 0:l.color},size:20})}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("h1",{className:"text-[26px] font-semibold leading-none text-text-primary",children:l.count}),e.jsx("span",{className:"text-[14px] font-medium text-text-primary/70 leading-none",children:l.label})]})]},x)})})}),e.jsxs("div",{id:"SalesOverview&Total",className:"w-full flex  gap-6 flex-col",children:[e.jsxs("div",{className:"w-full flex gap-6",children:[e.jsxs("div",{className:" p-[25px] rounded-2xl  bg-white lg:w-[50%] w-full  h-[445px]",children:[e.jsxs("div",{id:"ChartHeader",className:"w-full flex justify-between",children:[e.jsx("h1",{className:"text-[24px] font-bold",children:"Total Sales"}),e.jsx("div",{id:"chartController",className:"flex gap-4",children:u!=="sales_agent"?e.jsx(C,{theme:{token:{fontFamily:"Baloo2",colorPrimary:"#8086AC",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:e.jsx(w,{showSearch:!0,optionFilterProp:"label",onChange:l=>X(l.value),onSearch:k,defaultValue:"all",size:"large",style:{maxWidth:150,zIndex:"400"},labelInValue:!0,options:[{value:"all",label:"All Agents"},...D.map(l=>({value:l._id,label:l.name+" "+l.last_name}))]})}):null})]}),e.jsx("div",{className:"h-[260px] my-0 mx-auto flex items-center justify-center",children:e.jsx(he,{data:q,chartFor:"totalSales"})}),e.jsx("div",{id:"ChartInfo",className:"w-full flex flex-col gap-2",children:["completed","pending","cancelled"].map(l=>{const x=q.find(N=>N.property_name===l)||{property_name:l,total_orders:0};let c,p;switch(x.property_name){case"completed":c="#4379EE",p="Completed";break;case"pending":c="#F1963A",p="Pending";break;case"cancelled":c="#D90000",p="Cancelled";break;default:c="#000000",p="Unknown"}return e.jsxs("div",{id:"InfoItem",className:"w-full flex justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"w-[12px] h-[12px] rounded-full",style:{backgroundColor:c}}),e.jsx("span",{className:"text-lg font-medium",children:p})]}),e.jsx("span",{className:"text-lg font-semibold",children:x.total_orders})]},x.property_name)})})]}),e.jsxs("div",{className:" p-[25px] rounded-2xl  bg-white lg:w-[50%] w-full  h-[445px]",children:[e.jsxs("div",{id:"ChartHeader",className:"w-full flex justify-between",children:[e.jsx("h1",{className:"text-[24px] font-bold",children:"Total Installations"}),e.jsx("div",{id:"chartController",className:"flex gap-4",children:u!=="sales_agent"?e.jsx(C,{theme:{token:{fontFamily:"Baloo2",colorPrimary:"#8086AC",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:e.jsx(w,{showSearch:!0,optionFilterProp:"label",onChange:l=>Y(l.value),onSearch:k,defaultValue:"all",size:"large",style:{maxWidth:150,zIndex:"400"},labelInValue:!0,options:[{value:"all",label:"All Agents"},...D.map(l=>({value:l._id,label:l.name+" "+l.last_name}))]})}):null})]}),e.jsx("div",{className:"h-[260px] my-0 mx-auto flex items-center justify-center",children:e.jsx(he,{data:J,chartFor:"totalInstallations"})}),e.jsx("div",{id:"ChartInfo",className:"w-full flex flex-col gap-2",children:["completed","pending","not_started"].map(l=>{const x=J.find(N=>N.property_name===l)||{property_name:l,total_orders:0};let c,p;switch(x.property_name){case"completed":c="#36b610",p="Completed";break;case"pending":c="#833af1",p="In Progress";break;case"not_started":c="#5d5d5d",p="Not Started";break;default:c="#000000",p="Unknown"}return e.jsxs("div",{id:"InfoItem",className:"w-full flex justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"w-[12px] h-[12px] rounded-full",style:{backgroundColor:c}}),e.jsx("span",{className:"text-lg font-medium",children:p})]}),e.jsx("span",{className:"text-lg font-semibold",children:x.total_orders})]},x.property_name)})})]})]}),e.jsxs("div",{className:" p-[25px] rounded-2xl  bg-white lg:w-[100%] w-full  h-[445px]",children:[e.jsxs("div",{id:"ChartHeader",className:"w-full flex justify-between",children:[e.jsx("h1",{className:"text-[24px] font-bold",children:"Sales Overview"}),e.jsx("div",{id:"chartController",className:"flex gap-4",children:e.jsxs(C,{theme:{token:{fontFamily:"Baloo2",colorPrimary:"#8086AC",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:[e.jsx(w,{optionFilterProp:"label",onChange:l=>S(l.value),defaultValue:"all",size:"large",labelInValue:!0,options:[{value:"all",label:"All Sales"},{value:"completed",label:"Completed"},{value:"pending",label:"Pending"},{value:"cancelled",label:"Cancelled"}]}),u!=="sales_agent"?e.jsx(w,{showSearch:!0,optionFilterProp:"label",onChange:l=>$(l.value),onSearch:k,value:I,defaultValue:"all",size:"large",style:{maxWidth:150,zIndex:"400"},labelInValue:!0,options:[{value:"all",label:"All Agents"},...D.map(l=>({value:l._id,label:l.name+" "+l.last_name}))]}):null]})})]}),e.jsx(Cl,{data:Se})]})]}),e.jsxs("div",{id:"SalesByLucation&Agents",className:"w-full flex gap-6 xl:flex-row flex-col",children:[r.role=="sales_agent"?null:e.jsxs("div",{className:" p-[25px] rounded-2xl  bg-white w-full h-[445px]",children:[e.jsxs("div",{id:"ChartHeader",className:"w-full flex justify-between",children:[e.jsx("h1",{className:"text-[24px] font-bold",children:" Sales by Agent"}),e.jsx("div",{id:"chartController",className:"flex gap-4",children:e.jsxs(C,{theme:{token:{fontFamily:"Baloo2",colorPrimary:"#8086AC",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:[e.jsx(w,{optionFilterProp:"label",onChange:l=>be(l.value),defaultValue:"all",size:"large",labelInValue:!0,options:[{value:"all",label:"All Sales"},{value:"completed",label:"Completed"},{value:"pending",label:"Pending"},{value:"cancelled",label:"Cancelled"}]}),e.jsx(w,{showSearch:!0,optionFilterProp:"label",onChange:l=>je(l.value),onSearch:k,defaultValue:"all",size:"large",labelInValue:!0,options:[{value:"all",label:"All Locations"},...Te.map(l=>({value:l.city_name,label:l.city_name}))]})]})})]}),e.jsx(F,{data:_e,graphTitle:"Sales by Agent"})]}),e.jsxs("div",{className:"p-[25px] rounded-2xl  bg-white w-full h-[445px]",children:[e.jsxs("div",{id:"ChartHeader",className:"w-full flex justify-between",children:[e.jsx("h1",{className:"text-[24px] font-bold",children:"Sales by Location"}),e.jsx("div",{id:"chartController",className:"flex gap-4",children:e.jsxs(C,{theme:{token:{fontFamily:"Baloo2",colorPrimary:"#8086AC",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:[e.jsx(w,{optionFilterProp:"label",onChange:l=>ye(l.value),defaultValue:"all",size:"large",labelInValue:!0,options:[{value:"all",label:"All Sales"},{value:"completed",label:"Completed"},{value:"pending",label:"Pending"},{value:"cancelled",label:"Cancelled"}]}),u!=="sales_agent"?e.jsx(w,{showSearch:!0,optionFilterProp:"label",onChange:l=>Q(l.value),onSearch:k,defaultValue:"all",size:"large",labelInValue:!0,options:[{value:"all",label:"All Agents"},...D.map(l=>({value:l._id,label:l.name+" "+l.last_name}))]}):null]})})]}),e.jsx(F,{data:ke,graphTitle:"Sales by Location"})]})]})]}),r.role=="monitoring_station"?e.jsx(_l,{count:L,chartByAge:A,chartByGender:le,diseasesCountByGender:te,alertsCountByName:se,alertsCountByElderly:ae}):null,n=="installer"?e.jsx(Dl,{}):null,r.role=="nursing_home"?e.jsxs("div",{className:"w-full flex flex-col gap-6 pt-6",children:[e.jsxs("div",{className:"w-full flex gap-6 xl:flex-row flex-col h-fit justify-between",children:[e.jsxs("div",{className:"p-[25px] rounded-2xl bg-white w-full h-[445px]",children:[e.jsx("div",{id:"ChartHeader",className:"w-full flex justify-between",children:e.jsx("h1",{className:"text-[24px] font-bold",children:"Most Alerts"})}),e.jsx(F,{data:ae})]}),e.jsxs("div",{className:"p-[25px] rounded-2xl bg-white w-full h-[445px]",children:[e.jsx("div",{id:"ChartHeader",className:"w-full flex justify-between",children:e.jsx("h1",{className:"text-[24px] font-bold",children:"Activity Count"})}),e.jsx(ge,{data:se})]})]}),e.jsxs("div",{className:"flex gap-6 lg:flex-row flex-col h-fit",children:[e.jsxs("div",{className:"rounded-2xl lg:w-[75%] w-full flex flex-col gap-6 h-full",children:[e.jsxs("div",{className:"p-[25px] rounded-2xl bg-white w-full h-[445px] flex-grow",children:[e.jsx("div",{id:"ChartHeader",className:"w-full flex justify-between",children:e.jsx("h1",{className:"text-[24px] font-bold",children:"Ages"})}),e.jsx(P,{chartFor:"age",data:le})]}),e.jsxs("div",{className:"p-[25px] rounded-2xl bg-white w-full h-[445px] flex-grow",children:[e.jsx("div",{id:"ChartHeader",className:"w-full flex justify-between",children:e.jsx("h1",{className:"text-[24px] font-bold",children:"Diseases"})}),e.jsx(P,{chartFor:"diseases",data:te})]})]}),e.jsx("div",{className:"rounded-2xl lg:w-[35%] w-full flex flex-col gap-6 h-full",children:e.jsxs("div",{className:"p-[25px] rounded-2xl bg-white w-full flex flex-col h-[496px] justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{id:"ChartHeader",className:"w-full flex justify-between",children:e.jsx("h1",{className:"text-[24px] font-bold",children:"Gender"})}),e.jsx("div",{className:"h-[260px] my-0 mx-auto flex items-center justify-center",children:e.jsx(U,{data:A,chartFor:"gender"})})]}),e.jsxs("div",{id:"ChartInfo",className:"w-full flex flex-col gap-2",children:[e.jsxs("div",{id:"InfoItem",className:"w-full flex justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"w-[12px] h-[12px] bg-text-primary rounded-full"}),e.jsx("span",{className:"text-lg font-medium",children:"Total"})]}),e.jsx("span",{className:"text-lg font-semibold",children:A.reduce((l,x)=>l+x.male_count+x.female_count,0)})]}),e.jsxs("div",{id:"InfoItem",className:"w-full flex justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"w-[12px] h-[12px] bg-[#4379EE] rounded-full"}),e.jsx("span",{className:"text-lg font-medium",children:"Male"})]}),e.jsxs("span",{className:"text-lg font-semibold",children:[A.map(l=>l._id==="male"&&l.male_count||0),A.length===0&&e.jsx(e.Fragment,{children:"0"})]})]}),e.jsxs("div",{id:"InfoItem",className:"w-full flex justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"w-[12px] h-[12px] bg-[#5CC8BE] rounded-full"}),e.jsx("span",{className:"text-lg font-medium",children:"Female"})]}),e.jsxs("span",{className:"text-lg font-semibold",children:[" ",A.map(l=>l._id==="female"&&l.male_count||0),A.length===0&&e.jsx(e.Fragment,{children:"0"})]})]})]})]})})]})]}):null]})};export{Yl as default};
