import{e as le,K as R,bt as ae,i as ce,f as E,m as je,r as s,n as Q,bu as de,p as O,b2 as ue,aZ as we,u as Oe,bs as se,br as Ee,j as l,d as Ie,aE as Te,S as Pe,bq as re}from"./index-BbvltKIV.js";import"./alertsOverview-CAe4ChTY.js";import{u as _e,D as Re,a as De}from"./RoomMap4-CO5OPrP0.js";import{d as Be,a as B,t as ze,c as Ae,g as We}from"./helper-C_2_l4sE.js";import{g as He}from"./elderlySupport-BWWQnx38.js";import{S as Me}from"./index-Bu7MvyGb.js";const Fe=new R("antStatusProcessing",{"0%":{transform:"scale(0.8)",opacity:.5},"100%":{transform:"scale(2.4)",opacity:0}}),Ze=new R("antZoomBadgeIn",{"0%":{transform:"scale(0) translate(50%, -50%)",opacity:0},"100%":{transform:"scale(1) translate(50%, -50%)"}}),Ve=new R("antZoomBadgeOut",{"0%":{transform:"scale(1) translate(50%, -50%)"},"100%":{transform:"scale(0) translate(50%, -50%)",opacity:0}}),Le=new R("antNoWrapperZoomBadgeIn",{"0%":{transform:"scale(0)",opacity:0},"100%":{transform:"scale(1)"}}),qe=new R("antNoWrapperZoomBadgeOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0)",opacity:0}}),ke=new R("antBadgeLoadingCircle",{"0%":{transformOrigin:"50%"},"100%":{transform:"translate(50%, -50%) rotate(360deg)",transformOrigin:"50%"}}),Ye=e=>{const{componentCls:o,iconCls:a,antCls:n,badgeShadowSize:t,textFontSize:b,textFontSizeSM:c,statusSize:C,dotSize:x,textFontWeight:y,indicatorHeight:m,indicatorHeightSM:d,marginXS:g,calc:v}=e,i=`${n}-scroll-number`,f=ae(e,(p,r)=>{let{darkColor:h}=r;return{[`&${o} ${o}-color-${p}`]:{background:h,[`&:not(${o}-count)`]:{color:h},"a:hover &":{background:h}}}});return{[o]:Object.assign(Object.assign(Object.assign(Object.assign({},ce(e)),{position:"relative",display:"inline-block",width:"fit-content",lineHeight:1,[`${o}-count`]:{display:"inline-flex",justifyContent:"center",zIndex:e.indicatorZIndex,minWidth:m,height:m,color:e.badgeTextColor,fontWeight:y,fontSize:b,lineHeight:E(m),whiteSpace:"nowrap",textAlign:"center",background:e.badgeColor,borderRadius:v(m).div(2).equal(),boxShadow:`0 0 0 ${E(t)} ${e.badgeShadowColor}`,transition:`background ${e.motionDurationMid}`,a:{color:e.badgeTextColor},"a:hover":{color:e.badgeTextColor},"a:hover &":{background:e.badgeColorHover}},[`${o}-count-sm`]:{minWidth:d,height:d,fontSize:c,lineHeight:E(d),borderRadius:v(d).div(2).equal()},[`${o}-multiple-words`]:{padding:`0 ${E(e.paddingXS)}`,bdi:{unicodeBidi:"plaintext"}},[`${o}-dot`]:{zIndex:e.indicatorZIndex,width:x,minWidth:x,height:x,background:e.badgeColor,borderRadius:"100%",boxShadow:`0 0 0 ${E(t)} ${e.badgeShadowColor}`},[`${o}-count, ${o}-dot, ${i}-custom-component`]:{position:"absolute",top:0,insetInlineEnd:0,transform:"translate(50%, -50%)",transformOrigin:"100% 0%",[`&${a}-spin`]:{animationName:ke,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear"}},[`&${o}-status`]:{lineHeight:"inherit",verticalAlign:"baseline",[`${o}-status-dot`]:{position:"relative",top:-1,display:"inline-block",width:C,height:C,verticalAlign:"middle",borderRadius:"50%"},[`${o}-status-success`]:{backgroundColor:e.colorSuccess},[`${o}-status-processing`]:{overflow:"visible",color:e.colorInfo,backgroundColor:e.colorInfo,borderColor:"currentcolor","&::after":{position:"absolute",top:0,insetInlineStart:0,width:"100%",height:"100%",borderWidth:t,borderStyle:"solid",borderColor:"inherit",borderRadius:"50%",animationName:Fe,animationDuration:e.badgeProcessingDuration,animationIterationCount:"infinite",animationTimingFunction:"ease-in-out",content:'""'}},[`${o}-status-default`]:{backgroundColor:e.colorTextPlaceholder},[`${o}-status-error`]:{backgroundColor:e.colorError},[`${o}-status-warning`]:{backgroundColor:e.colorWarning},[`${o}-status-text`]:{marginInlineStart:g,color:e.colorText,fontSize:e.fontSize}}}),f),{[`${o}-zoom-appear, ${o}-zoom-enter`]:{animationName:Ze,animationDuration:e.motionDurationSlow,animationTimingFunction:e.motionEaseOutBack,animationFillMode:"both"},[`${o}-zoom-leave`]:{animationName:Ve,animationDuration:e.motionDurationSlow,animationTimingFunction:e.motionEaseOutBack,animationFillMode:"both"},[`&${o}-not-a-wrapper`]:{[`${o}-zoom-appear, ${o}-zoom-enter`]:{animationName:Le,animationDuration:e.motionDurationSlow,animationTimingFunction:e.motionEaseOutBack},[`${o}-zoom-leave`]:{animationName:qe,animationDuration:e.motionDurationSlow,animationTimingFunction:e.motionEaseOutBack},[`&:not(${o}-status)`]:{verticalAlign:"middle"},[`${i}-custom-component, ${o}-count`]:{transform:"none"},[`${i}-custom-component, ${i}`]:{position:"relative",top:"auto",display:"block",transformOrigin:"50% 50%"}},[i]:{overflow:"hidden",transition:`all ${e.motionDurationMid} ${e.motionEaseOutBack}`,[`${i}-only`]:{position:"relative",display:"inline-block",height:m,transition:`all ${e.motionDurationSlow} ${e.motionEaseOutBack}`,WebkitTransformStyle:"preserve-3d",WebkitBackfaceVisibility:"hidden",[`> p${i}-only-unit`]:{height:m,margin:0,WebkitTransformStyle:"preserve-3d",WebkitBackfaceVisibility:"hidden"}},[`${i}-symbol`]:{verticalAlign:"top"}},"&-rtl":{direction:"rtl",[`${o}-count, ${o}-dot, ${i}-custom-component`]:{transform:"translate(-50%, -50%)"}}})}},me=e=>{const{fontHeight:o,lineWidth:a,marginXS:n,colorBorderBg:t}=e,b=o,c=a,C=e.colorBgContainer,x=e.colorError,y=e.colorErrorHover;return je(e,{badgeFontHeight:b,badgeShadowSize:c,badgeTextColor:C,badgeColor:x,badgeColorHover:y,badgeShadowColor:t,badgeProcessingDuration:"1.2s",badgeRibbonOffset:n,badgeRibbonCornerTransform:"scaleY(0.75)",badgeRibbonCornerFilter:"brightness(75%)"})},be=e=>{const{fontSize:o,lineHeight:a,fontSizeSM:n,lineWidth:t}=e;return{indicatorZIndex:"auto",indicatorHeight:Math.round(o*a)-2*t,indicatorHeightSM:o,dotSize:n/2,textFontSize:n,textFontSizeSM:n,textFontWeight:"normal",statusSize:n/2}},Xe=le("Badge",e=>{const o=me(e);return Ye(o)},be),Ke=e=>{const{antCls:o,badgeFontHeight:a,marginXS:n,badgeRibbonOffset:t,calc:b}=e,c=`${o}-ribbon`,C=`${o}-ribbon-wrapper`,x=ae(e,(y,m)=>{let{darkColor:d}=m;return{[`&${c}-color-${y}`]:{background:d,color:d}}});return{[C]:{position:"relative"},[c]:Object.assign(Object.assign(Object.assign(Object.assign({},ce(e)),{position:"absolute",top:n,padding:`0 ${E(e.paddingXS)}`,color:e.colorPrimary,lineHeight:E(a),whiteSpace:"nowrap",backgroundColor:e.colorPrimary,borderRadius:e.borderRadiusSM,[`${c}-text`]:{color:e.colorTextLightSolid},[`${c}-corner`]:{position:"absolute",top:"100%",width:t,height:t,color:"currentcolor",border:`${E(b(t).div(2).equal())} solid`,transform:e.badgeRibbonCornerTransform,transformOrigin:"top",filter:e.badgeRibbonCornerFilter}}),x),{[`&${c}-placement-end`]:{insetInlineEnd:b(t).mul(-1).equal(),borderEndEndRadius:0,[`${c}-corner`]:{insetInlineEnd:0,borderInlineEndColor:"transparent",borderBlockEndColor:"transparent"}},[`&${c}-placement-start`]:{insetInlineStart:b(t).mul(-1).equal(),borderEndStartRadius:0,[`${c}-corner`]:{insetInlineStart:0,borderBlockEndColor:"transparent",borderInlineStartColor:"transparent"}},"&-rtl":{direction:"rtl"}})}},Qe=le(["Badge","Ribbon"],e=>{const o=me(e);return Ke(o)},be),Ue=e=>{const{className:o,prefixCls:a,style:n,color:t,children:b,text:c,placement:C="end",rootClassName:x}=e,{getPrefixCls:y,direction:m}=s.useContext(Q),d=y("ribbon",a),g=`${d}-wrapper`,[v,i,f]=Qe(d,g),p=de(t,!1),r=O(d,`${d}-placement-${C}`,{[`${d}-rtl`]:m==="rtl",[`${d}-color-${t}`]:p},o),h={},$={};return t&&!p&&(h.background=t,$.color=t),v(s.createElement("div",{className:O(g,x,i,f)},b,s.createElement("div",{className:O(r,i),style:Object.assign(Object.assign({},h),n)},s.createElement("span",{className:`${d}-text`},c),s.createElement("div",{className:`${d}-corner`,style:$}))))},ie=e=>{const{prefixCls:o,value:a,current:n,offset:t=0}=e;let b;return t&&(b={position:"absolute",top:`${t}00%`,left:0}),s.createElement("span",{style:b,className:O(`${o}-only-unit`,{current:n})},a)};function Ge(e,o,a){let n=e,t=0;for(;(n+10)%10!==o;)n+=a,t+=a;return t}const Je=e=>{const{prefixCls:o,count:a,value:n}=e,t=Number(n),b=Math.abs(a),[c,C]=s.useState(t),[x,y]=s.useState(b),m=()=>{C(t),y(b)};s.useEffect(()=>{const v=setTimeout(m,1e3);return()=>clearTimeout(v)},[t]);let d,g;if(c===t||Number.isNaN(t)||Number.isNaN(c))d=[s.createElement(ie,Object.assign({},e,{key:t,current:!0}))],g={transition:"none"};else{d=[];const v=t+10,i=[];for(let r=t;r<=v;r+=1)i.push(r);const f=i.findIndex(r=>r%10===c);d=i.map((r,h)=>{const $=r%10;return s.createElement(ie,Object.assign({},e,{key:r,value:$,offset:h-f,current:h===f}))});const p=x<b?1:-1;g={transform:`translateY(${-Ge(c,t,p)}00%)`}}return s.createElement("span",{className:`${o}-only`,style:g,onTransitionEnd:m},d)};var et=function(e,o){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&o.indexOf(n)<0&&(a[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,n=Object.getOwnPropertySymbols(e);t<n.length;t++)o.indexOf(n[t])<0&&Object.prototype.propertyIsEnumerable.call(e,n[t])&&(a[n[t]]=e[n[t]]);return a};const tt=s.forwardRef((e,o)=>{const{prefixCls:a,count:n,className:t,motionClassName:b,style:c,title:C,show:x,component:y="sup",children:m}=e,d=et(e,["prefixCls","count","className","motionClassName","style","title","show","component","children"]),{getPrefixCls:g}=s.useContext(Q),v=g("scroll-number",a),i=Object.assign(Object.assign({},d),{"data-show":x,style:c,className:O(v,t,b),title:C});let f=n;if(n&&Number(n)%1===0){const p=String(n).split("");f=s.createElement("bdi",null,p.map((r,h)=>s.createElement(Je,{prefixCls:v,count:Number(n),value:r,key:p.length-h})))}return c!=null&&c.borderColor&&(i.style=Object.assign(Object.assign({},c),{boxShadow:`0 0 0 1px ${c.borderColor} inset`})),m?ue(m,p=>({className:O(`${v}-custom-component`,p==null?void 0:p.className,b)})):s.createElement(y,Object.assign({},i,{ref:o}),f)});var ot=function(e,o){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&o.indexOf(n)<0&&(a[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,n=Object.getOwnPropertySymbols(e);t<n.length;t++)o.indexOf(n[t])<0&&Object.prototype.propertyIsEnumerable.call(e,n[t])&&(a[n[t]]=e[n[t]]);return a};const nt=s.forwardRef((e,o)=>{var a,n,t,b,c;const{prefixCls:C,scrollNumberPrefixCls:x,children:y,status:m,text:d,color:g,count:v=null,overflowCount:i=99,dot:f=!1,size:p="default",title:r,offset:h,style:$,className:I,rootClassName:ge,classNames:w,styles:N,showZero:F=!1}=e,U=ot(e,["prefixCls","scrollNumberPrefixCls","children","status","text","color","count","overflowCount","dot","size","title","offset","style","className","rootClassName","classNames","styles","showZero"]),{getPrefixCls:G,direction:Z,badge:u}=s.useContext(Q),S=G("badge",C),[J,fe,pe]=Xe(S),V=v>i?`${i}+`:v,z=V==="0"||V===0,he=v===null||z&&!F,L=(m!=null||g!=null)&&he,D=f&&!z,T=D?"":V,P=s.useMemo(()=>(T==null||T===""||z&&!F)&&!D,[T,z,F,D]),ee=s.useRef(v);P||(ee.current=v);const _=ee.current,te=s.useRef(T);P||(te.current=T);const q=te.current,oe=s.useRef(D);P||(oe.current=D);const A=s.useMemo(()=>{if(!h)return Object.assign(Object.assign({},u==null?void 0:u.style),$);const j={marginTop:h[1]};return Z==="rtl"?j.left=parseInt(h[0],10):j.right=-parseInt(h[0],10),Object.assign(Object.assign(Object.assign({},j),u==null?void 0:u.style),$)},[Z,h,$,u==null?void 0:u.style]),ve=r??(typeof _=="string"||typeof _=="number"?_:void 0),xe=P||!d?null:s.createElement("span",{className:`${S}-status-text`},d),ye=!_||typeof _!="object"?void 0:ue(_,j=>({style:Object.assign(Object.assign({},A),j.style)})),W=de(g,!1),Ce=O(w==null?void 0:w.indicator,(a=u==null?void 0:u.classNames)===null||a===void 0?void 0:a.indicator,{[`${S}-status-dot`]:L,[`${S}-status-${m}`]:!!m,[`${S}-color-${g}`]:W}),k={};g&&!W&&(k.color=g,k.background=g);const ne=O(S,{[`${S}-status`]:L,[`${S}-not-a-wrapper`]:!y,[`${S}-rtl`]:Z==="rtl"},I,ge,u==null?void 0:u.className,(n=u==null?void 0:u.classNames)===null||n===void 0?void 0:n.root,w==null?void 0:w.root,fe,pe);if(!y&&L){const j=A.color;return J(s.createElement("span",Object.assign({},U,{className:ne,style:Object.assign(Object.assign(Object.assign({},N==null?void 0:N.root),(t=u==null?void 0:u.styles)===null||t===void 0?void 0:t.root),A)}),s.createElement("span",{className:Ce,style:Object.assign(Object.assign(Object.assign({},N==null?void 0:N.indicator),(b=u==null?void 0:u.styles)===null||b===void 0?void 0:b.indicator),k)}),d&&s.createElement("span",{style:{color:j},className:`${S}-status-text`},d)))}return J(s.createElement("span",Object.assign({ref:o},U,{className:ne,style:Object.assign(Object.assign({},(c=u==null?void 0:u.styles)===null||c===void 0?void 0:c.root),N==null?void 0:N.root)}),y,s.createElement(we,{visible:!P,motionName:`${S}-zoom`,motionAppear:!1,motionDeadline:1e3},j=>{let{className:Se}=j;var Y,X;const $e=G("scroll-number",x),K=oe.current,Ne=O(w==null?void 0:w.indicator,(Y=u==null?void 0:u.classNames)===null||Y===void 0?void 0:Y.indicator,{[`${S}-dot`]:K,[`${S}-count`]:!K,[`${S}-count-sm`]:p==="small",[`${S}-multiple-words`]:!K&&q&&q.toString().length>1,[`${S}-status-${m}`]:!!m,[`${S}-color-${g}`]:W});let H=Object.assign(Object.assign(Object.assign({},N==null?void 0:N.indicator),(X=u==null?void 0:u.styles)===null||X===void 0?void 0:X.indicator),A);return g&&!W&&(H=H||{},H.background=g),s.createElement(tt,{prefixCls:$e,show:!P,motionClassName:Se,className:Ne,count:q,title:ve,style:H,key:"scrollNumber"},ye)}),xe))}),M=nt;M.Ribbon=Ue;function st({data:e=[]}){var C,x,y,m,d,g,v;const o=Oe(),[a,n]=s.useState(null),t=s.useRef(null),b=i=>{switch(i){case"Info":return"bg-blue-500";case"Critical":return"bg-red-500";case"Warning":return"bg-yellow-500";default:return"bg-blue-500"}};s.useEffect(()=>{var f;const i=(f=e==null?void 0:e.rooms)==null?void 0:f.device_no;return i&&(t.current&&t.current!==i&&se({uid:t.current,messageType:["1","2","3","4"]}).then(()=>{}).catch(p=>console.error(`Error unsubscribing: ${p}`)),Ee({uid:i,messageType:["1","2","3","4"],topics:{pub:[i]}}).then(()=>{}).catch(p=>console.error(`Error subscribing: ${p}`)),t.current=i),()=>{t.current&&se({uid:t.current,messageType:["1","2","3","4"]}).then(()=>{}).catch(p=>console.error(`Error during cleanup unsubscribe: ${p}`))}},[e]);const c=s.useCallback(i=>{const f=Be(i);n(f)},[]);return _e({onMessage:i=>{var p,r;const f=(p=JSON.parse(i==null?void 0:i.message))==null?void 0:p.payload;f!=null&&f.position&&(f==null?void 0:f.deviceCode)===((r=i==null?void 0:i.rooms)==null?void 0:r.device_no)&&c(f.position)},dependencies:[e]}),l.jsxs("div",{className:"w-full flex flex-col gap-4 p-4 pr-0 h-full pt-0",children:[l.jsxs("div",{id:"roomAlertHeader",className:`alert-header !h-[75px] flex justify-between items-center relative px-4 overflow-hidden rounded-lg ${b((C=B(e))==null?void 0:C.label)}`,children:[l.jsx("div",{className:"loader"}),l.jsxs("div",{className:"text-container flex flex-col gap-0 h-full justify-center text-white",children:[l.jsx("p",{className:"text-sm text-gray-100 m-0 font-medium",children:e.room_name}),l.jsx("h2",{className:"text-lg font-bold m-0 leading-none ",children:(x=B(e))==null?void 0:x.title})]}),l.jsx("span",{onClick:()=>{o(`/supporter/elderlies/elderly-profile/${e==null?void 0:e.elderly_id}`)},className:"text-sm text-gray-100 cursor-pointer p-3 py-2 bg-white/0 rounded-lg hover:bg-white/10 transition-all duration-300",children:"View Elderly"})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex flex-col gap-0 border-b border-gray-200 pb-2 ",children:[l.jsx("h2",{className:"text-lg font-bold m-0 leading-none",children:e.elderly_name}),l.jsx("p",{className:"text-sm text-gray-500 m-0",children:e.address})]}),l.jsx("div",{})]}),l.jsxs("div",{id:"roomMapAndDetails",className:"flex gap-4 h-full overflow-hidden",children:[l.jsxs("div",{className:"map-container w-2/3 border overflow-hidden h-full",children:[((y=e==null?void 0:e.rooms)==null?void 0:y.mount_type)===1&&((m=e==null?void 0:e.rooms)==null?void 0:m.is_device_bind)&&l.jsx(Re,{roomInfo:e==null?void 0:e.rooms,position:a}),((d=e==null?void 0:e.rooms)==null?void 0:d.mount_type)===2&&((g=e==null?void 0:e.rooms)==null?void 0:g.is_device_bind)&&l.jsx(De,{roomInfo:e==null?void 0:e.rooms,position:a}),!((v=e==null?void 0:e.rooms)!=null&&v.is_device_bind)&&l.jsx("span",{className:"w-full h-full flex items-center justify-center",children:l.jsx("p",{children:" No Device Data Available"})})]}),l.jsxs("div",{className:"details-container w-1/3 ",children:[l.jsxs("div",{className:"flex flex-col gap-0 p-3",children:[l.jsx("h2",{className:"text-xl font-bold m-0 leading-none",children:ze(e.created_at)}),l.jsx("p",{className:"text-sm text-gray-500 m-0 font-medium",children:"Time of Incident"})]}),l.jsxs("div",{className:"flex flex-col gap-0 p-3",children:[l.jsx("h2",{className:"text-xl font-bold m-0 leading-none",children:Ae(e.created_at)}),l.jsx("p",{className:"text-sm text-gray-500 m-0 font-medium",children:"Alert Life"})]})]})]})]})}function mt(){s.useState("All");const[e,o]=s.useState([]),[a,n]=s.useState(null),[t,b]=s.useState(null),[c,C]=s.useState(null),[x,y]=s.useState(!1),[m,d]=s.useState(1),g=s.useRef(null),v=s.useCallback(()=>{y(!0),He({to_date:"2024-11-30",from_date:Ie().format("YYYY-MM-DD"),is_resolved:!1,limit:20,page:m,...c}).then(r=>{o(h=>[...h,...r.data]),y(!1)}).catch(r=>{console.error(r),y(!1)})},[c,m]);s.useEffect(()=>{v()},[m,c]),s.useEffect(()=>{if(e.length>0&&!a){const r=e[0];n(r._id),b(r)}},[e,a]);const i=r=>{n(r);const h=e.find($=>$._id===r);b(h)},f=()=>{const{scrollTop:r,scrollHeight:h,clientHeight:$}=g.current;r+$>=h-10&&!x&&d(I=>I+1)},p=r=>{C(We(r)),d(1),o([])};return l.jsxs("div",{className:"w-full flex justify-center items-center h-[495px] overflow-hidden",children:[l.jsxs("div",{className:"w-[30%] flex flex-col gap-4 h-full",children:[l.jsx(Me,{style:{width:"100%"},block:!0,options:rt,onChange:r=>p(r)}),l.jsxs("div",{ref:g,className:"w-full overflow-auto",style:{height:"440px"},onScroll:f,children:[e.map(r=>{var h,$,I;return l.jsxs("div",{onClick:()=>i(r._id),className:`custom-tab-label flex justify-between items-center p-2.5 rounded-md cursor-pointer ${a===r._id?"bg-gray-100":""}`,children:[l.jsx("span",{className:"text-black font-semibold",children:r.room_name}),l.jsxs(Te,{children:[((h=B(r))==null?void 0:h.label)==="Critical"&&l.jsx(M,{color:"red"}),(($=B(r))==null?void 0:$.label)==="Warning"&&l.jsx(M,{color:"orange"}),((I=B(r))==null?void 0:I.label)==="Info"&&l.jsx(M,{color:"blue"})]})]},r._id)}),x&&l.jsx("div",{className:"w-full flex justify-center py-4",children:l.jsx(Pe,{})}),!x&&e.length===0&&l.jsx(re,{description:"No active alerts available"})]})]}),l.jsx("div",{className:"w-[70%] h-full",children:t?l.jsx(st,{data:t}):l.jsx(re,{description:"Select an alert to view details"})})]})}const rt=[{label:"All",value:"All"},{label:"Critical",value:"Critical"},{label:"Warning",value:"Warning"},{label:"Info",value:"Info"}];export{mt as R};
