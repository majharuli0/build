import{e as f,az as _,ac as L,r as o,j as t,D as E,S as D,u as k,N as u,as as M,aA as W,aB as Y,aC as B,ax as R,aD as F,av as $}from"./index-CnZYSSOF.js";import{A as O}from"./AlertName-BQanjVhy.js";import{A as S,a as P}from"./ActionManu-BXN5r9gy.js";import{L as z}from"./LargeTextViewerModal-CneRYCDA.js";import{S as U}from"./slick-theme-yDYFl3t-.js";import{a as V,A as G}from"./AlertCloseModal-aLquSSxE.js";import{g as J}from"./elderlySupport-BelUapVX.js";try{let s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},c=new s.Error().stack;c&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[c]="b4f74556-1e58-4eef-a035-69a9bfc6d9ee",s._sentryDebugIdIdentifier="sentry-dbid-b4f74556-1e58-4eef-a035-69a9bfc6d9ee")}catch{}f.extend(_);f.extend(L);const te=({placeholder:s,style:c,handleChange:m,value:n})=>{const[d,i]=o.useState("This Week"),l=e=>{const r=f(e).startOf("week").format("YYYY-MM-DD"),h=f(e).endOf("week").format("YYYY-MM-DD");return{week:f(e).week(),start:r,end:h}},p=e=>`Week ${l(e).week}`;return o.useEffect(()=>{if(n){const e=f().week(),r=f(n.start).week();r===e-1?i("Last Week"):i(`Week ${r}`)}else i("This Week")},[n]),t.jsx(E,{style:c,placeholder:d,size:"large",format:p,picker:"week",onChange:e=>{if(e){const r=l(e);m(r)}else m(""),i("This Week")}})};function ae(s){const{rolesFormatter:c}=o.useContext(D),m=k(),n=e=>{window.scrollTo(0,0),m(`/supporter/elderlies/elderly-profile/${e.elderly_id}?tab=overview`)},d={activeAlertsTableData:["alertName","alertType","elderlyName","roomName","incidentTime","alertLife","address","viewElderly"],recentlyClosedAlertsTableData:["alertName","alertType","elderlyName","roomName","incidentTime","alertLife","alertStatus","closedAt","closedBy","address","viewElderly"],eventsTableData:["eventName","elderlyName","eventTime","place","largeText","status","action"]},i={alertName:{title:"Notification Name",render:e=>t.jsx(O,{data:e})},alertType:{title:"Notification Type",render:e=>{var r;return t.jsx("span",{children:(r=u(e))==null?void 0:r.label})}},elderlyName:{title:"User Name",dataIndex:"elderly_name",render:e=>t.jsx("span",{children:e})},roomName:{title:"Room Name",dataIndex:"room_name",render:e=>t.jsx("span",{children:e})},incidentTime:{title:"Observation Time",dataIndex:"created_at",render:e=>t.jsx("span",{className:"text-nowrap",children:M(e)})},alertLifetime:{title:"Notification Duration",render:e=>t.jsx("span",{className:"text-nowrap",children:W(e==null?void 0:e.created_at,e==null?void 0:e.closed_at)})},alertLife:{title:"Notification Duration",dataIndex:"created_at",render:e=>t.jsx("span",{className:"text-nowrap",children:t.jsx(S,{date:e})})},alertStatus:{title:"Notification Status",dataIndex:"status",render:e=>t.jsx("span",{className:"text-nowrap",children:e==0?"True Notification":"False Notification"})},address:{title:"Address",width:"230px",render:e=>t.jsx("span",{className:"!w-[230px] text-nowrap",children:e.address})},closedAt:{title:"Closed At",dataIndex:"closed_at",render:e=>t.jsx("span",{className:"text-nowrap",children:M(e)})},closedBy:{title:"Closed By",render:e=>t.jsxs("span",{className:"text-nowrap",children:[e.closed_by," (",c[e.closed_by_role]," )"]})},eventName:{title:"Event Name",dataIndex:"event_name",render:e=>t.jsx("span",{children:e})},eventTime:{title:"Event Time",dataIndex:"date_time",render:e=>t.jsx("span",{className:"text-nowrap",children:M(e)})},eventTimeline:{title:"Event Timeline",dataIndex:"alertLifetime",render:e=>t.jsx("span",{className:"text-nowrap",children:e})},disabilityType:{title:"Disability Type",dataIndex:"disabilityType",render:e=>t.jsx("span",{className:"text-nowrap",children:e})},place:{title:"Place",dataIndex:"place",render:e=>t.jsx("span",{className:"text-nowrap",children:e})},status:{title:"Status",dataIndex:"event_status",render:e=>t.jsx("span",{className:"text-nowrap capitalize",children:e!=="open"?e:"Done"})},largeText:{title:()=>{switch(s){case"events":return"Note";default:return""}},render:e=>t.jsx(z,{data:e.note,title:"Additional Info"})},expandColumn:Y.EXPAND_COLUMN,viewElderly:{render:e=>t.jsxs("span",{onClick:()=>n(e),className:"flex items-center transition-all duration-300 justify-center gap-2 text-sm font-medium text-text-primary hover:text-primary cursor-pointer p-2 rounded-md  text-center hover:bg-slate-100",children:["View ",t.jsx(B,{})]})},action:{title:"Action",render:e=>t.jsx(P,{row:e})}},[l,p]=o.useState(void 0);return o.useEffect(()=>{if(s=="activeAlert"){const e=d.activeAlertsTableData.map(r=>i[r]);p(e)}else if(s=="recentlyClosedAlert"){const e=d.recentlyClosedAlertsTableData.map(r=>i[r]);p(e)}else if(s=="events"){const e=d.eventsTableData.map(r=>i[r]);p(e)}else p([])},[]),l}const w=s=>{const c=["Critical","Info","Warning"],m=["Living Room","Kitchen","Bedroom","Bathroom"],n=["John Doe","Jane Doe","Alice Smith","Bob Johnson","Emma Brown","Michael Wilson","Sarah Davis","David Miller","Lisa Garcia","James Rodriguez"],d=["Fall Detected","Fire Detected","Inactivity Alert","Medication Reminder","Unusual Behavior","High Temperature","Low Temperature","Water Leak","Door Left Open","Window Broken"],i=["Medication Taken","Medication Not Taken","Medication Reminder"],l=["Wheelchair","Crutches","Cane","None"],p=["Yes","No"],e=["Yes","No"],r=["Yes","No"],h=["1","4","2","No"],g=["True","False"];return Array.from({length:s},(y,v)=>({_id:v+1,alertType:c[Math.floor(Math.random()*c.length)],elderlyName:n[Math.floor(Math.random()*n.length)],alertName:d[Math.floor(Math.random()*d.length)],roomId:String(v+1),roomName:m[Math.floor(Math.random()*m.length)],alertLifetime:`${Math.floor(Math.random()*10)}m ${Math.floor(Math.random()*60)}s`,time:new Date().toLocaleString(),alertDescription:`${d[Math.floor(Math.random()*d.length)]} in the ${m[Math.floor(Math.random()*m.length)]}`,status:"Active",isAlert:g[Math.floor(Math.random()*g.length)],address:"123 Main St, Anytown, USA",coordinates:{latitude:37.7749+(Math.random()-.5)*.01,longitude:-122.4194+(Math.random()-.5)*.01},closedAt:new Date().toLocaleString(),closedBy:n[Math.floor(Math.random()*n.length)],eventName:i[Math.floor(Math.random()*i.length)],disabilityType:l[Math.floor(Math.random()*l.length)],additionalInfo:"This is additional info for event",hospital:{name:"Hospital For Special Surgery",phone:"1234567890",latitude:-33.8743612,longitude:151.2261153},allergies:p[Math.floor(Math.random()*p.length)],diseases:e[Math.floor(Math.random()*e.length)],medications:r[Math.floor(Math.random()*r.length)],activeAlert:h[Math.floor(Math.random()*h.length)],alertComments:"This is alert comments",alertLifespan:[{dateTime:"24-01-2024 10:00 AM",description:"At 10:00 AM, the alert was created"},{dateTime:"24-01-2024 10:30 AM",description:"Agent (petar) clicked on the incident in 10:30 (30mins later)"},{dateTime:"24-01-2024 10:32 AM",description:"Agent (petar) clicked on “Call Elderly” in 10:32 (2mins later)"},{dateTime:"24-01-2024 10:34 AM",description:"Agent (petar) clicked on “Call 911” in 10:34 (2mins later)"},{dateTime:"24-01-2024 10:36 AM",description:"Agent (petar) clicked on “Close Alert” in 10:36 (2mins later)"}]}))};w(14);w(20);w(20);w(20);w(20);function re({refreshAlertList:s,isElderlyVisible:c=!1}){o.useContext(D);const[m,n]=o.useState(!1),[d,i]=o.useState(null),[l,p]=o.useState([]),e=["Critical","Warning"],r=k(),{notificationEvent:h}=R(),g=o.useRef(0),y=o.useCallback(async()=>{let a=[],x=30;for(const b of e){if(x<=0)break;const N=$(b);if(N)try{const T=(await J({to_date:"2024-11-30",from_date:f().format("YYYY-MM-DD"),is_resolved:!1,limit:x,...N})).data||[];if(a=[...a,...T],x-=T.length,x<=0)break}catch(A){console.error(`Error fetching ${b} alerts:`,A)}}a.length>g.current&&s(),g.current=a.length,p(a)},[]);o.useEffect(()=>{y()},[y]);const v={dots:l.length>=2,infinite:l.length>2,speed:500,slidesToShow:l.length===1?1:2,slidesToScroll:1,draggable:!0,arrows:!1,appendDots:a=>t.jsx("div",{style:{backgroundColor:"transparent",borderRadius:"10px",padding:"2px"},children:t.jsx("ul",{id:"dots",style:{margin:"0px"},children:a})}),responsive:[{breakpoint:1200,settings:{slidesToShow:(l.length===1,1),slidesToScroll:1}},{breakpoint:800,settings:{slidesToShow:1,slidesToScroll:1}}]},I=a=>{window.scrollTo(0,0),r(`/supporter/elderlies/elderly-profile/${a.elderly_id}?tab=overview`)};return o.useEffect(()=>{h&&(console.log(h),y())},[h]),t.jsxs(t.Fragment,{children:[l.length>0&&t.jsx("div",{id:"ActiveAlertsCards",className:"w-full mb-2 transition-all duration-300",children:t.jsx(U,{...v,className:"w-full transition-all duration-300",children:l.map((a,x)=>{var b,N,A,T,j,C;return t.jsx("div",{className:"px-2 overflow-hidden transition-all duration-300 relative w-full",children:t.jsxs("div",{id:"alertItem",className:`rounded-2xl overflow-hidden w-full ${((b=u(a))==null?void 0:b.label)==="Critical"?"bg-red-500":((N=u(a))==null?void 0:N.label)==="Warning"?"bg-yellow-500":"bg-blue-500"} p-4 w-full flex justify-between items-center`,children:[t.jsx("div",{id:"leftSide",className:"z-50",children:t.jsx("div",{id:"alertItemHeader",children:t.jsxs("div",{id:"alertItemTitleAndDescription",className:"flex flex-col gap-6",children:[t.jsxs("div",{id:"time",className:"flex gap-2",children:[c&&t.jsxs("span",{onClick:()=>I(a),className:"bg-white font-semibold p-1 px-2 pl-1 rounded-full text-text-primary flex items-center gap-2 cursor-pointer hover:opacity-90",children:[t.jsx(F,{size:22,style:{opacity:"0.8"}}),a==null?void 0:a.elderly_name]}),t.jsxs("span",{className:"bg-white font-semibold p-1 px-2 rounded-full text-text-primary flex items-center gap-2",children:[t.jsx("div",{id:"dot",className:`w-2 h-2 ${((A=u(a))==null?void 0:A.label)==="Critical"?"bg-red-500":((T=u(a))==null?void 0:T.label)==="Warning"?"bg-yellow-500":"bg-blue-500"} rounded-full animate-ping`}),M(a.created_at)]}),t.jsx("span",{className:"bg-white font-semibold p-1 px-2 rounded-full text-text-primary",children:t.jsx(S,{date:a.created_at})})]}),t.jsxs("div",{id:"alertItemTitleAndDescription",children:[t.jsx("h1",{className:"text-xl font-bold text-white m-0",children:(j=u(a))==null?void 0:j.title}),t.jsx("p",{className:"text-white text-base m-0 leading-none",children:(C=u(a))==null?void 0:C.message})]})]})})}),t.jsx("div",{id:"rightSide",className:"z-50 w-fit",children:t.jsx("span",{onClick:()=>{i(a),n(!0)},className:"text-sm p-2 px-3 bg-white rounded-xl text-text-primary cursor-pointer hover:bg-white/90 transition-all duration-300 text-nowrap",children:"Mark as Complete"})}),t.jsx("img",{src:V,alt:"",className:"absolute top-0 right-0"})]})},x)})})}),t.jsx(G,{openAlertCloseModal:m,setOpenAlertCloseModal:n,selectedAlert:d,getAlertListDatas:()=>{y(),s()}})]})}export{re as A,te as W,ae as u};
//# sourceMappingURL=ActiveAlertsCards-D7CUb02J.js.map
