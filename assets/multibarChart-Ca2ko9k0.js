import{Q as D,g as O,r as y,a1 as Y,d as p,j as E,bt as C}from"./index-B9uzjFUT.js";import{E as w}from"./index-BIXB-bsF.js";var b={exports:{}};(function(s,c){(function(a,o){s.exports=o()})(D,function(){return function(a,o){o.prototype.isSameOrAfter=function(n,i){return this.isSame(n,i)||this.isAfter(n,i)}}})})(b);var N=b.exports;const k=O(N);var $={exports:{}};(function(s,c){(function(a,o){s.exports=o()})(D,function(){return function(a,o){o.prototype.isSameOrBefore=function(n,i){return this.isSame(n,i)||this.isBefore(n,i)}}})})($);var R=$.exports;const V=O(R);p.extend(k);p.extend(V);function L({data:s,fromDate:c,toDate:a,valueType:o="duration"}){console.log(s,c,a,o);const[n,i]=y.useState([]),{sleepEventsType:g,sleepEventsColor:A}=y.useContext(Y);y.useEffect(()=>{i(Array.isArray(s)?s:[]),console.log(s)},[s]);const m=(x,l)=>{if(l==="duration"){const d=Math.floor(x/60),h=x%60;return`${d}hr ${h}m`}return x.toString()},j=y.useMemo(()=>{const l=((e,t)=>{const r=[];let u=p(e);const f=p(t);for(;u.isSameOrBefore(f);)r.push(u.format("YYYY-MM-DD")),u=u.add(1,"day");return r})(c,a);console.log("All Dates:",l);const d=(Array.isArray(n)?n:[]).reduce((e,t)=>{if(!(t!=null&&t.date)||!(t!=null&&t.data))return e;const r=p(t.date).format("YYYY-MM-DD");return e[r]=t.data,e},{});console.log("Data By Date:",d);const h=[...new Set((Array.isArray(n)?n:[]).flatMap(e=>{var t;return((t=e==null?void 0:e.data)==null?void 0:t.map(r=>r.status))||[]}))];console.log("Active Statuses:",h);const S=Object.entries(g).filter(([e])=>h.includes(e));console.log("Active Events:",S);const B=S.map(([e,t])=>{const r=l.map(u=>{const f=d[u],v=f==null?void 0:f.find(M=>M.status===e);return v?Number(v.value):0});return console.log(`Series data for ${t}:`,r),{name:t,type:"bar",stack:"total",data:r,itemStyle:{color:A[t]}}});return{tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:e=>{let t=`${e[0].axisValue}<br/>`;return e.forEach(r=>{r.value>0&&(t+=`${r.marker} ${r.seriesName}: ${m(r.value,o)}<br/>`)}),t}},legend:{data:S.map(([e,t])=>t)},xAxis:{type:"category",data:l},yAxis:{type:"value",axisLabel:{formatter:e=>m(e,o)}},series:B}},[n,c,a,g,A,o]);return(s==null?void 0:s.length)===0||!a||!c?E.jsx(C,{description:"No data available to show"}):E.jsx(w,{option:j,style:{height:"350px"}})}export{L as default};
