{"version":3,"file":"SleepEvents-0t-EpnVf.js","sources":["../../src/Pages/Elderlies/Components/TabContents/Sleep/Components/SleepEvents.jsx"],"sourcesContent":["import { useState, useEffect, useCallback, useContext } from \"react\";\r\nimport TimelineBar from \"@/Components/GraphAndChart/TimelineBar\";\r\nimport { getSleepEvents } from \"@/api/deviceReports\";\r\nimport useApi from \"@/hook/useApi\";\r\nimport ls from \"store2\";\r\nimport { FaTimeline } from \"react-icons/fa6\";\r\nimport Template from \"@/Components/GraphAndChartTemp/Template\";\r\nimport { SidebarContext } from \"@/Context/CustomContext\";\r\nimport { transformTime } from \"@/utils/helper\";\r\nimport { CustomContext } from \"@/Context/UseCustomContext\";\r\nexport default function SleepEvents() {\r\n  const { sleepEventsType, sleepEventsColor } = useContext(SidebarContext);\r\n  const { sleepData, elderlyDetails } = useContext(CustomContext);\r\n  const [eventCounts, setEventCounts] = useState([]);\r\n  const summaryProps = {\r\n    title: \"Sleep Events Summary\",\r\n    pickerTypes: [\"day\", \"range\"],\r\n    chartType: \"multibar_sleep_events\",\r\n    dataType: \"time\",\r\n    color: \"#FF725E\",\r\n    apisProps: {\r\n      endpoint: getSleepEvents,\r\n      query: {\r\n        uids: elderlyDetails?.deviceId,\r\n      },\r\n    },\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (sleepData?.alarm_events) {\r\n      const alarmEventCounts = sleepData?.alarm_events.reduce((acc, event) => {\r\n        const eventName = sleepEventsType[event.event_type];\r\n        const existingEvent = acc.find((e) => e.event_name === eventName);\r\n        if (existingEvent) {\r\n          existingEvent.count += 1;\r\n        } else {\r\n          acc.push({\r\n            event_name: eventName,\r\n            count: 1,\r\n            color: sleepEventsColor[eventName],\r\n          });\r\n        }\r\n        return acc;\r\n      }, []);\r\n      setEventCounts(alarmEventCounts);\r\n    }\r\n  }, [sleepData]);\r\n  return (\r\n    <>\r\n      <Template\r\n        title=\"Sleep Events\"\r\n        color=\"#FF725E\"\r\n        icon={<FaTimeline />}\r\n        isDataAnalysis={false}\r\n        headerClassName=\"!text-2xl\"\r\n        summaryProps={summaryProps}\r\n      >\r\n        <TimelineBar\r\n          alarmEvents={sleepData?.alarm_events}\r\n          enterBedTime={transformTime(sleepData?.get_bed_idx)}\r\n          getupAfterTime={transformTime(sleepData?.leave_bed_idx)}\r\n          noDataText=\"No Data Detected for Today\"\r\n        />\r\n        <div className=\"flex flex-wrap gap-4 items-center justify-center \">\r\n          {eventCounts.map((event, index) => (\r\n            <EventItem\r\n              key={index}\r\n              count={event.count}\r\n              eventName={event.event_name}\r\n              color={event.color}\r\n            />\r\n          ))}\r\n        </div>\r\n      </Template>\r\n    </>\r\n  );\r\n}\r\nconst EventItem = ({ count, eventName, color }) => {\r\n  return (\r\n    <div\r\n      className={`flex p-[4px] pr-4 items-center gap-2 rounded-xl`}\r\n      style={{ backgroundColor: color }}\r\n    >\r\n      <span className=\"text-[17px] p-2 py-1 font-bold bg-white rounded-[9px] text-primary\">\r\n        {count}\r\n      </span>\r\n      <span className=\"text-[15px] font-medium text-white leading-[1.2]\">\r\n        {eventName}\r\n      </span>\r\n    </div>\r\n  );\r\n};\r\n"],"names":["SleepEvents","sleepEventsType","sleepEventsColor","useContext","SidebarContext","sleepData","elderlyDetails","CustomContext","eventCounts","setEventCounts","useState","summaryProps","getSleepEvents","useEffect","alarmEventCounts","acc","event","eventName","existingEvent","e","jsx","Fragment","jsxs","Template","FaTimeline","TimelineBar","transformTime","index","EventItem","count","color"],"mappings":"qqBAUA,SAAwBA,GAAc,CACpC,KAAM,CAAE,gBAAAC,EAAiB,iBAAAC,CAAiB,EAAIC,aAAWC,CAAc,EACjE,CAAE,UAAAC,EAAW,eAAAC,CAAe,EAAIH,aAAWI,CAAa,EACxD,CAACC,EAAaC,CAAc,EAAIC,EAAA,SAAS,CAAE,CAAA,EAC3CC,EAAe,CACnB,MAAO,uBACP,YAAa,CAAC,MAAO,OAAO,EAC5B,UAAW,wBACX,SAAU,OACV,MAAO,UACP,UAAW,CACT,SAAUC,EACV,MAAO,CACL,KAAMN,GAAA,YAAAA,EAAgB,QACxB,CACF,CAAA,EAGFO,OAAAA,EAAAA,UAAU,IAAM,CACd,GAAIR,GAAA,MAAAA,EAAW,aAAc,CAC3B,MAAMS,EAAmBT,GAAA,YAAAA,EAAW,aAAa,OAAO,CAACU,EAAKC,IAAU,CAChE,MAAAC,EAAYhB,EAAgBe,EAAM,UAAU,EAC5CE,EAAgBH,EAAI,KAAMI,GAAMA,EAAE,aAAeF,CAAS,EAChE,OAAIC,EACFA,EAAc,OAAS,EAEvBH,EAAI,KAAK,CACP,WAAYE,EACZ,MAAO,EACP,MAAOf,EAAiBe,CAAS,CAAA,CAClC,EAEIF,CACT,EAAG,CAAE,GACLN,EAAeK,CAAgB,CACjC,CAAA,EACC,CAACT,CAAS,CAAC,EAGVe,MAAAC,EAAAA,SAAA,CAAA,SAAAC,EAAA,KAACC,EAAA,CACC,MAAM,eACN,MAAM,UACN,WAAOC,EAAW,EAAA,EAClB,eAAgB,GAChB,gBAAgB,YAChB,aAAAb,EAEA,SAAA,CAAAS,EAAA,IAACK,EAAA,CACC,YAAapB,GAAA,YAAAA,EAAW,aACxB,aAAcqB,EAAcrB,GAAA,YAAAA,EAAW,WAAW,EAClD,eAAgBqB,EAAcrB,GAAA,YAAAA,EAAW,aAAa,EACtD,WAAW,4BAAA,CACb,EACAe,EAAAA,IAAC,OAAI,UAAU,oDACZ,WAAY,IAAI,CAACJ,EAAOW,IACvBP,EAAA,IAACQ,EAAA,CAEC,MAAOZ,EAAM,MACb,UAAWA,EAAM,WACjB,MAAOA,EAAM,KAAA,EAHRW,CAKR,CAAA,EACH,CAAA,CAAA,CAEJ,CAAA,CAAA,CAEJ,CACA,MAAMC,EAAY,CAAC,CAAE,MAAAC,EAAO,UAAAZ,EAAW,MAAAa,KAEnCR,EAAA,KAAC,MAAA,CACC,UAAW,kDACX,MAAO,CAAE,gBAAiBQ,CAAM,EAEhC,SAAA,CAACV,EAAA,IAAA,OAAA,CAAK,UAAU,qEACb,SACHS,EAAA,EACCT,EAAA,IAAA,OAAA,CAAK,UAAU,mDACb,SACHH,EAAA,CAAA,CAAA,CAAA"}