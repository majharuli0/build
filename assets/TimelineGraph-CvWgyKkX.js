import{r as b,$ as C,x as L,j as s,bq as M}from"./index-xg-tzkqX.js";import{E as D}from"./index-DgT4v-pJ.js";const V=({statisticalData:o=[],alarmEvents:h=[],enterBedTime:d,getupAfterTime:u})=>{console.log(o,h,d,u);const{sleepEventsType:l,sleepEventsColor:g}=b.useContext(C),a=[...o.map(e=>({name:l[e.status],startTime:new Date(e.start_time),endTime:new Date(e.end_time),color:g[l[e.status]]})),...h.map(e=>({name:l[e.event_type],startTime:new Date(e.ts),endTime:new Date(e.ts),color:g[l[e.event_type]]}))].filter(e=>e.name),m=[...new Set(a.map(e=>e.name))].filter(Boolean),[i,x]=b.useState(()=>m.reduce((e,t)=>(e[t]=!0,e),{}));L.useEffect(()=>{const e=m.filter(t=>!(t in i));e.length>0&&x(t=>({...t,...e.reduce((r,n)=>({...r,[n]:!0}),{})}))},[m,i]),console.log("Visibility state:",i);const S=e=>{x(t=>({...t,[e]:!t[e]}))},w=Math.min(...a.map(e=>e.startTime.getTime())),E=Math.max(...a.map(e=>e.endTime.getTime())),f=a.map(e=>{const t=e.startTime.getTime()===e.endTime.getTime();return{name:e.name,value:[e.startTime.getTime(),e.endTime.getTime(),t?15:10],itemStyle:{color:e.color}}}).filter(e=>i[e.name]);if(console.log("Filtered series data:",f),(o==null?void 0:o.length)===0)return s.jsx(M,{description:"No data available to show"});const j={tooltip:{trigger:"item",formatter:e=>{const t=a[e.dataIndex],r=t.startTime.getTime()===t.endTime.getTime(),n=new Date(t.startTime).toLocaleString();if(r)return`${t.name}<br/>Date & Time: ${n}`;{const c=new Date(t.endTime).toLocaleString(),$=t.endTime-t.startTime,p=Math.floor($/(1e3*60)),T=Math.floor(p/60),y=p%60,v=T>0?`${T} hour(s) ${y} minute(s)`:`${y} minute(s)`;return`<b>${t.name}</b> <br/>Start: ${n}<br/>End: ${c}<br/>Duration: ${v}`}}},grid:{left:"5%",right:"5%",bottom:"15%",containLabel:!1},xAxis:{type:"time",boundaryGap:!0,min:w,max:E,splitNumber:5,axisLabel:{formatter:e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),interval:0,margin:5},axisTick:{show:!0,alignWithLabel:!0}},yAxis:{show:!1},series:[{name:"Events",type:"custom",renderItem:(e,t)=>{const r=t.coord([t.value(0),0]),n=t.coord([t.value(1),0]),c=t.size([0,t.value(2)])[1];return{type:"rect",shape:{x:r[0],y:e.coordSys.height-c+60,width:Math.max(n[0]-r[0],5),height:c},style:{fill:t.style().fill,stroke:"#fff",lineWidth:1}}},encode:{x:[0,1]},data:f}],graphic:d&&u?[{type:"text",left:"5%",bottom:"1%",style:{text:`Enter Bed ${d}`,fontSize:12}},{type:"text",right:"5%",bottom:"1%",style:{text:`Getup After ${u}`,fontSize:12}}]:[]};return s.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 w-full",children:[s.jsx("div",{id:"customLegend",className:"w-full",children:s.jsx("div",{className:"flex flex-wrap gap-4 items-center justify-center",children:m.map(e=>s.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>S(e),children:[s.jsx("div",{id:"legendColorShape",className:"size-3 rounded-[4px] border-2",style:{backgroundColor:i[e]?g[e]:"grey",borderColor:i[e]?"transparent":"#ccc",color:i[e]?"grey":"inherit"}}),s.jsx("div",{children:e})]},e))})}),s.jsx(D,{option:j,style:{height:200,width:"100%"}})]})};export{V as default};
