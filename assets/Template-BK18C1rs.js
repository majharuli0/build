const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DataAnalysis-D3UeyCbg.js","assets/index-DJPLPkhr.js","assets/index-cd6XYGQk.css","assets/LargeTextViewerModal-Dx_C-mS8.js","assets/MoonFilled-_famdDLt.js","assets/barChart-CsR0Fjxd.js","assets/index-YLV9fS2A.js","assets/multibarChart-Dgz_qLpB.js","assets/TimelineGraph-Co8aLoms.js","assets/TimelineBar-gafQVb3F.js","assets/LiveRateChart-CcuMrIlY.js","assets/SkeletonRateChart-DiQTTaR9.js","assets/index-C3H4sGjQ.js","assets/DayRateChart-JqBHAOrS.js","assets/scatterChart-D7S-BZgu.js"])))=>i.map(i=>d[i]);
import{aG as j,aF as s,r as w,S as de,j as i,f7 as fe,D as X,e as F,f6 as G,gF as J,gB as re,gy as he,aM as xe,e6 as ue}from"./index-DJPLPkhr.js";import{W as ve}from"./WeeklyMonthlyPicker-mKUy-ZkM.js";import{C as _e}from"./UseCustomContext-C_RoMH9_.js";try{let d=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},h=new d.Error().stack;h&&(d._sentryDebugIds=d._sentryDebugIds||{},d._sentryDebugIds[h]="4ba9a70b-8c9d-4bbf-97a5-e875af64c3ff",d._sentryDebugIdIdentifier="sentry-dbid-4ba9a70b-8c9d-4bbf-97a5-e875af64c3ff")}catch{}const ge=()=>Array.from({length:12},(d,h)=>({date:`2023-10-${String(h*2+1).padStart(2,"0")}`,value:Math.floor(Math.random()*100)+1})),De=()=>Array.from({length:12},(d,h)=>({date:`2023-10-${String(h*2+2).padStart(2,"0")}`,value:Math.floor(Math.random()*100)+1})),be=()=>Array.from({length:12},(d,h)=>({date:`2023-10-${String(h*2+1).padStart(2,"0")}`,value:Math.floor(Math.random()*180)+1}));ge();De();be();function Ee(d,h){return typeof d!="function"?(console.error("apiFunction is not a function or is undefined"),Promise.reject(new Error("apiFunction is not a function"))):d(h).then(E=>E).catch(E=>{throw console.error("API Request Error:",E),E})}j.lazy(()=>s(()=>import("./DataAnalysis-D3UeyCbg.js"),__vite__mapDeps([0,1,2,3,4])));const Te=j.lazy(()=>s(()=>import("./barChart-CsR0Fjxd.js"),__vite__mapDeps([5,1,2,6]))),K=j.lazy(()=>s(()=>import("./multibarChart-Dgz_qLpB.js"),__vite__mapDeps([7,1,2,6]))),Se=j.lazy(()=>s(()=>import("./TimelineGraph-Co8aLoms.js"),__vite__mapDeps([8,1,2,6]))),we=j.lazy(()=>s(()=>import("./TimelineBar-gafQVb3F.js"),__vite__mapDeps([9,1,2,6])));j.lazy(()=>s(()=>import("./LiveRateChart-CcuMrIlY.js"),__vite__mapDeps([10,1,2,6])));const je=j.lazy(()=>s(()=>import("./SkeletonRateChart-DiQTTaR9.js").then(d=>d.a),__vite__mapDeps([11,1,2,6,12]))),se=j.lazy(()=>s(()=>import("./DayRateChart-JqBHAOrS.js"),__vite__mapDeps([13,1,2,6]))),Re=j.lazy(()=>s(()=>import("./scatterChart-D7S-BZgu.js"),__vite__mapDeps([14,1,2,6]))),{RangePicker:Me,DatePicker:Oe}=X;function Q(d){const[h,E,e]=d.split(":").map(Number);return h*60+E+e/60}function Ce({visible:d,onClose:h,modalData:E,summaryProps:e}){var W;const[x,k]=w.useState(""),[u,I]=w.useState(""),[M,N]=w.useState(null),[g,C]=w.useState([]),[R,V]=w.useState([]),[L,z]=w.useState([]),{sleepEventsType:O,sleepEventsColor:$}=w.useContext(de),Z=w.useContext(_e),{elderlyDetails:B}=Z||{};function y(t){k(t.end),I(t.start),N("weeklyMonthly")}function m(t,n){k(n[1]||""),I(n[0]||""),N("range")}function P(t,n){k(null),I(n||""),N("day")}function Y(t){return t.map(({date:n,events:a})=>{const o=a.reduce((r,{event_type:b})=>(r[b]=(r[b]||0)+1,r),{}),l=Object.entries(o).map(([r,b])=>({name:O[r],value:`${b}`,status:r,color:$[r]}));return{date:n,data:l}})}function ee(t){return Array.isArray(t)?t.map(a=>{var l;const o=((l=a.sleep_index_common_list)==null?void 0:l.reduce((r,b)=>{const A=Number(b==null?void 0:b.value)||0;return r+A},0))||"0";return{date:(a==null?void 0:a.date)||null,bed_exit_duration:o}}):(console.error("Invalid data format: Expected an array."),[])}function te(t){return t.map(a=>{const o=a.sleep_index_common_list.reduce((l,r)=>l+parseInt(r.value,10),0);return{date:a.date,totalFallAsleepDuration:o}})}function ne(t){const n=[];return t==null||t.forEach(a=>{var l;const o=a.date;(l=a==null?void 0:a.events)==null||l.forEach(r=>{if(r.event_type===14||r.event_type===15){const b=n.find(A=>A.date===o);b?b.anomalyHeartRate+=1:n.push({date:o,anomalyHeartRate:1})}})}),n}function ae(t){const n=[];return t==null||t.forEach(a=>{const l={date:a.date,data:[]};a.still_time!==void 0&&l.data.push({name:"still_time",value:a.still_time,status:"30"}),a.walk_duration!==void 0&&l.data.push({name:"walking_duration",value:Q(a.walk_duration),status:"31"}),a.other_duration!==void 0&&l.data.push({name:"other_duration",value:Q(a.other_duration),status:"32"}),n.push(l)}),n}function le(t){var a,o,l,r,b,A,U,q;let n=[];if(t||z([]),(e==null?void 0:e.title)==="Breath Rate Summary"||(e==null?void 0:e.title)==="Heart Rate Summary")!x&&((a=t[0])!=null&&a.avg)&&(n=[{name:"Avg. Breath Rate",value:(o=t[0])==null?void 0:o.avg},{name:"Min. Breath Rate",value:(l=t[0])==null?void 0:l.min},{name:"Max. Breath Rate",value:(r=t[0])==null?void 0:r.max}]);else if((e==null?void 0:e.title)==="Sleep Timeline Summary")if((b=t[0])!=null&&b.statistical_data&&u&&x==null){const D=(A=t[0])==null?void 0:A.statistical_data.reduce((v,f)=>{const c=new Date(f.start_time),S=(new Date(f.end_time)-c)/(1e3*60),_=O[f.status];return v[_]||(v[_]={duration:0}),v[_].duration+=S,v},{});n=Object.entries(D).map(([v,{duration:f}])=>{const c=Math.floor(f/60),T=Math.floor(f%60);return{name:v,value:`${c}hr ${T}m`}})}else{const D={},v=t.map(f=>({data:f.sleep_index_common_list,date:f.date}));v==null||v.forEach(f=>{var c;(c=f==null?void 0:f.data)==null||c.forEach(({name:T,value:S,status:_,ratio:ce})=>{D[_]||(D[_]={name:`Avg. ${O[_]}`,totalValue:0,totalRatio:0,count:0}),D[_].totalValue+=parseInt(S),D[_].totalRatio+=ce,D[_].count+=1})}),n=Object.entries(D).map(([f,c])=>{const T=Math.round(c.totalValue/c.count),S=Math.floor(T/60),_=T%60;return{name:c.name,value:`${S}hr ${_}m`,ratio:Math.round(c.totalRatio/c.count)}})}else if((e==null?void 0:e.title)==="Sleep Events Summary")if((U=t[0])!=null&&U.events&&u&&x==null)n=(q=t[0])==null?void 0:q.events.reduce((v,f)=>{const c=O[f.event_type],T=v.find(S=>S.name===c);if(T){const S=parseInt(T.value.replace("x",""));T.value=`${S+1}x`}else v.push({name:c,value:"1x",color:$[c]});return v},[]);else{const D={},v=Y(t);v==null||v.forEach(f=>{var c;(c=f==null?void 0:f.data)==null||c.forEach(({name:T,value:S,status:_})=>{D[_]||(D[_]={name:`Avg. ${O[_]}`,totalValue:0,count:0}),D[_].totalValue+=parseInt(S),D[_].count+=1})}),n=Object.entries(D).map(([f,c])=>{const T=Math.round(c.totalValue/c.count);return{name:c.name,value:`${T}x`}})}return z(n),n}function H(t){if(t||C([]),(e==null?void 0:e.title)==="Sleep Timeline Summary")if(u&&x){const n=t.map(a=>({data:a.sleep_index_common_list,date:a.date}));C(n)}else C(t[0]);else if((e==null?void 0:e.title)==="Sleep Events Summary"){const n=Y(t);C(n)}else if((e==null?void 0:e.title)==="Breathing Rate Overview Summary"||(e==null?void 0:e.title)==="Heart Rate Overview Summary"){if(x&&u){const n={xdata:t.map(a=>a.date),maxArray:t.map(a=>a.max),minArray:t.map(a=>a.min),allAvgNumber:Math.round(t.reduce((a,o)=>a+o.avg,0)/t.length)};C(n)}}else{if((e==null?void 0:e.title)==="Bed Exit Duration Overview Summary")return ee(t);if((e==null?void 0:e.title)==="Time to Fall Asleep Overview Summary")return te(t);if((e==null?void 0:e.title)==="Heart Rate Variation Overview Summary")return ne(t);if((e==null?void 0:e.title)==="Room Occupancy Duration Overview Summary"){const n=ae(t);C(n)}}return t}w.useEffect(()=>{async function t(){var n,a,o;if((n=e==null?void 0:e.apisProps)!=null&&n.endpoint)try{const l=await Ee((a=e==null?void 0:e.apisProps)==null?void 0:a.endpoint,{...(o=e==null?void 0:e.apisProps)==null?void 0:o.query,elderly_id:B==null?void 0:B._id,from_date:x,to_date:u});l&&(l!=null&&l.data)&&(V(H(l==null?void 0:l.data)),le(l==null?void 0:l.data),H(l==null?void 0:l.data))}catch(l){console.error("Error fetching summary data:",l),V([])}}t()},[(W=e==null?void 0:e.apisProps)==null?void 0:W.endpoint,x,u]);const ie=()=>{var t;return(t=e==null?void 0:e.pickerTypes)==null?void 0:t.map(n=>{switch(n){case"weeklyMonthly":return i.jsx(ve,{placeholder:"Weekly/Monthly",style:{width:"140px",borderRadius:"10px"},handleChnage:y,value:M==="weeklyMonthly"&&u&&x?{start:u,end:x}:null},"weeklyMonthly");case"range":return i.jsx(Me,{showTime:!1,style:{width:"200px",borderRadius:"10px"},size:"large",placeholder:["Pick Data Range (Start)","End"],format:"YYYY-MM-DD",onChange:(a,o)=>m(a,o),value:M==="range"&&x&&u?[F(u),F(x)]:null,allowClear:!0},"range");case"day":return i.jsx(X,{style:{width:"200px",borderRadius:"10px"},size:"large",format:"YYYY-MM-DD",onChange:(a,o)=>P(a,o),value:M==="day"&&u?F(u):null,allowClear:!0},"day");default:return null}})},p={multibar:{default:{component:K,getProps:()=>({data:g,toDate:x,fromDate:u,valueType:e==null?void 0:e.dataType})},day:{component:Se,getProps:()=>({statisticalData:g==null?void 0:g.statistical_data,enterBedTime:G(g==null?void 0:g.get_bed_idx),getupAfterTime:G(g==null?void 0:g.leave_bed_idx)})}},multibar_sleep_events:{default:{component:K,getProps:()=>({data:g,toDate:x,fromDate:u,valueType:e==null?void 0:e.dataType})},day:{component:we,getProps:()=>{var t,n,a;return{alarmEvents:(t=R[0])==null?void 0:t.events,enterBedTime:J((n=R[0])==null?void 0:n.get_bed_idx),getupAfterTime:J((a=R[0])==null?void 0:a.leave_bed_idx)}}}},bar:{default:{component:Te,getProps:()=>({data:R,dataType:e==null?void 0:e.dataType,color:e==null?void 0:e.color,xUnit:e==null?void 0:e.xUnit,toDate:e!=null&&e.isFromToDate?x:"",fromDate:e!=null&&e.isFromToDate?u:"",numberLimit:e==null?void 0:e.numberLimit,dataUnit:e==null?void 0:e.dataUnit,chartFor:e==null?void 0:e.chartFor})}},rate:{default:{component:je,getProps:()=>({cheartInfo:g,color:e==null?void 0:e.color,dateType:"Month",fromDate:u,toDate:x})},day:{component:se,getProps:()=>{var t,n;return{data:((t=R[0])==null?void 0:t.data_list)||[],timestamp:((n=R[0])==null?void 0:n.timestamps)||[],color:e==null?void 0:e.color,type:e==null?void 0:e.dataType}}}},scatter:{default:{component:Re,getProps:()=>({data:(e==null?void 0:e.title)!=="Distribution of bed exit times Summary"?re(R):he(R),colors:{gotobed:"#2EC7C9",wakeup:"#5AB1EF",getup:"#FFB980",fallasleep:"#B6A2DE",bedexit:"#508C9B"}})}}},oe=()=>{var l,r;const t=e==null?void 0:e.chartType,n=((l=p[t])==null?void 0:l[M])||((r=p[t])==null?void 0:r.default);if(!n)return null;const{component:a,getProps:o}=n;return i.jsx(w.Suspense,{fallback:i.jsx("div",{children:"Loading..."}),children:i.jsx(a,{...o()})})};return i.jsx(fe,{open:d,onCancel:h,footer:null,width:"100%",style:{height:"100vh",padding:0,borderRadius:0,top:0},className:"!rounded-none summaryModal !h-[100vh] overflow-hidden",children:i.jsxs("div",{className:"p-4 h-[100vh]",children:[i.jsxs("div",{className:"flex flex-col justify-center items-center mb-4 gap-2",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary",children:e==null?void 0:e.title}),i.jsx("div",{id:"DatePickers",className:"flex gap-4 items-center justify-center mt-4",children:ie()})]}),L.length>0&&i.jsx("div",{id:"chartTotal",className:"flex w-full items-center justify-center border-b mt-12",children:L.map((t,n,a)=>i.jsx(Ae,{label:t.name,value:t.value,isFirst:n===0,isLast:n===a.length-1},n))}),i.jsx("div",{className:"report-content max-h-[350px]  w-[90%] mt-16 mx-auto",children:oe()})]})})}const Ae=({label:d,value:h,isFirst:E,isLast:e})=>i.jsxs("div",{id:"totalItem",className:`max-w-[160px] w-full border p-1 flex items-center justify-center border-b-0 flex-col ${E&&e?"rounded-tl-xl rounded-tr-xl":E?"rounded-tl-xl":e?"rounded-tr-xl":""}`,children:[i.jsx("h1",{className:"text-2xl font-bold text-primary",children:h}),i.jsx("span",{className:"text-sm font-medium opacity-80 text-primary",children:d})]});function Be({children:d,title:h,color:E,icon:e,dataAnalysis:x,isDataAnalysis:k=!0,isSummaryBtn:u=!0,summaryProps:I,headerClassName:M}){const[N,g]=w.useState(!1);return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex flex-col gap-6 p-6 bg-white rounded-2xl !w-full h-full ",children:[i.jsxs("div",{id:"header",className:"flex justify-between items-center w-full",children:[i.jsx("h1",{className:`text-[21px] font-bold text-primary ${M}`,children:h}),u&&i.jsx(xe,{onClick:()=>g(!0),icon:i.jsx(ue,{}),size:"large",children:"Summary"})]}),i.jsx("div",{className:"h-full",children:d}),k&&x!==""&&i.jsxs("div",{id:"footer",className:"flex gap-3 items-center p-2 px-3",children:[i.jsx("div",{id:"icon",style:{color:"white",fontSize:"20px",backgroundColor:E},className:"p-2 rounded-full",children:e}),i.jsx("span",{className:"text-[15px] capitalize",children:x})]})]}),i.jsx(Ce,{visible:N,onClose:()=>g(!1),summaryProps:{...I,color:E,icon:e}})]})}export{Be as T};
//# sourceMappingURL=Template-BK18C1rs.js.map
