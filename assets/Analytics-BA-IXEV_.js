import{bk as ge,j as e,h1 as ye,gG as de,h2 as ve,h3 as be,h4 as De,h5 as v,h6 as w,h as j,E as K,h7 as z,h8 as B,bd as we,r as E,h9 as je,bN as ie,ha as Se,hb as Te,hc as Ae,hd as Me,he as Ce,hf as _e,hg as Ye,hh as Le,hi as Ne,hj as Fe,gR as G,gI as $e}from"./index-BvE10wmv.js";import{n as Oe,o as Ee,p as Pe,q as ke,r as ze}from"./Dashboard-C378gjaP.js";try{let t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},o=new t.Error().stack;o&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[o]="ba82e911-4f4b-43f7-8902-79cba5a45b92",t._sentryDebugIdIdentifier="sentry-dbid-ba82e911-4f4b-43f7-8902-79cba5a45b92")}catch{}/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],Ie=ge("arrow-right",Be),f=De.create({page:{padding:30,fontSize:10,fontFamily:"Helvetica",color:"#111"},header:{textAlign:"center",marginBottom:20},companyName:{fontSize:16,fontWeight:"bold"},reportTitle:{fontSize:13,marginTop:4,textDecoration:"underline"},dateRange:{fontSize:10,marginTop:4,color:"#555"},section:{marginTop:15},sectionTitle:{fontSize:12,fontWeight:"bold",marginBottom:6,borderBottom:"1 solid #ccc",paddingBottom:3},infoBoxContainer:{display:"flex",flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap",marginBottom:10},infoBox:{width:"49.9%",backgroundColor:"#f0f0f0",padding:8,marginBottom:2,fontWeight:600,fontSize:"11px"},table:{display:"table",width:"100%",border:"1 solid #ddd",borderRadius:3,marginTop:5},tableRow:{flexDirection:"row"},tableCol:{width:"25%",borderRight:"0.5 solid #ddd",padding:4},tableColHeader:{width:"25%",borderRight:"0.5 solid #ddd",backgroundColor:"#f0f0f0",padding:4},tableCellHeader:{fontWeight:"bold",fontSize:10},tableCell:{fontSize:9},noData:{fontSize:9,fontStyle:"italic",color:"#777",marginTop:4}}),We=()=>{const t=Array.from({length:30},(a,l)=>j().subtract(29-l,"day").format("YYYY-MM-DD")),o=["Device Offline Alert","Fall Alert"],s=[];return t.forEach(a=>{const l=Math.floor(Math.random()*12)+8;for(let d=0;d<l;d++){const c=Math.floor(Math.random()*24),n=Math.floor(Math.random()*60),g=Math.floor(Math.random()*25)+5,x=15,y=g<=x,$=o[Math.floor(Math.random()*o.length)];s.push({day:a,time:`${c.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`,hour:c+n/60,responseTime:g,slaTime:x,alertId:`A${a.replace(/-/g,"")}${d+1}`,compliance:y,alertType:$})}}),s},ce={fall:25,offline:40,total:65};Array.from({length:30},(t,o)=>{const s=j().subtract(29-o,"day").format("MMM DD"),a=Math.floor(Math.random()*5),l=Math.floor(Math.random()*3),d=a+l;return{date:s,fall:a,offline:l,total:d}});Array.from({length:30},(t,o)=>{const s=j().subtract(29-o,"day").format("MMM DD"),a=Math.floor(Math.random()*50)+10,l=Math.floor(Math.random()*50)+10,d=a+l,c=(a/d*100).toFixed(0)+"%";return{date:s,compliance:a,nonCompliance:l,percent:c}});const Re=()=>{const t=We(),o={};return t.forEach(a=>{o[a.day]||(o[a.day]={date:j(a.day).format("MMM DD"),fallCount:0,offlineCount:0,totalAlerts:0,slaMet:0}),o[a.day].totalAlerts++,a.alertType==="Fall Alert"&&o[a.day].fallCount++,a.alertType==="Device Offline Alert"&&o[a.day].offlineCount++,a.compliance&&o[a.day].slaMet++}),Object.values(o).map(a=>({date:a.date,fallCount:a.fallCount,offlineCount:a.offlineCount,slaPercent:a.totalAlerts>0?(a.slaMet/a.totalAlerts*100).toFixed(1)+"%":"0%"}))};Re();const q=(t,o)=>e.jsxs(v,{style:f.table,children:[e.jsx(v,{style:f.tableRow,children:t.map((s,a)=>e.jsx(v,{style:{width:"50%",padding:6,borderBottom:"0.5 solid #ccc",borderRight:a===0?"0.5 solid #ccc":"none"},children:e.jsx(w,{style:f.tableCellHeader,children:s})},a))}),o.map((s,a)=>e.jsx(v,{style:f.tableRow,children:Object.values(s).map((l,d)=>e.jsx(v,{style:{width:"50%",padding:6,borderBottom:"0.5 solid #ddd",borderRight:d===0?"0.5 solid #ddd":"none"},children:e.jsx(w,{style:f.tableCell,children:l})},d))},a))]}),Ue=t=>{const o=t.total||1,s=12;return e.jsx(v,{style:{marginTop:6},children:[{label:"Fall Alerts",value:t.fall,color:"#EF4444"},{label:"Device Offline Alerts",value:t.offline,color:"#FACC15"},{label:"Total",value:t.total,color:"#556270"}].map((a,l)=>e.jsxs(v,{style:{marginBottom:6,display:"flex",alignItems:a.label=="Fall Alerts"?"flex-start":a.label=="Device Offline Alerts"?"flex-end":"center"},children:[e.jsxs(w,{style:{fontSize:10,marginBottom:2},children:[a.label,": ",a.value]}),e.jsx(v,{style:{width:"100%",height:s,backgroundColor:"#eee",borderRadius:4,overflow:"hidden",display:"flex",alignItems:a.label=="Fall Alerts"?"flex-start":"flex-end"},children:e.jsx(v,{style:{width:`${a.value/o*100}%`,height:"100%",backgroundColor:a.color,borderRadius:4}})})]},l))})},Ge=({basicInfo:t={},totalAlertOverview:o={},alertTrends:s=[],agentPerformance:a=[],slaCompliance:l=[]})=>e.jsx(ve,{children:e.jsxs(be,{size:"A4",style:f.page,children:[e.jsxs(v,{style:f.header,children:[e.jsx(w,{style:f.companyName,children:t.companyName}),e.jsx(w,{style:f.reportTitle,children:"Analytics Report"}),e.jsxs(w,{style:f.dateRange,children:[t.startDate," â†’ ",t.endDate]})]}),e.jsxs(v,{style:f.infoBoxContainer,children:[e.jsx(v,{style:f.infoBox,children:e.jsxs(w,{children:["Total Alerts: ",t.totalAlerts]})}),e.jsx(v,{style:f.infoBox,children:e.jsxs(w,{children:["Avg. Response Time: ",t.avgResponseTime]})}),e.jsx(v,{style:f.infoBox,children:e.jsxs(w,{children:["SLA Compliance: ",t.slaCompliance]})}),e.jsx(v,{style:f.infoBox,children:e.jsxs(w,{children:["Device Uptime: ",t.deviceUptime]})})]}),e.jsxs(v,{style:f.section,children:[e.jsx(w,{style:f.sectionTitle,children:"Total Alert Overview"}),ce&&(o.fall||o.offline)?Ue(ce):e.jsx(w,{style:f.noData,children:"No data available."})]}),e.jsxs(v,{style:f.section,children:[e.jsx(w,{style:f.sectionTitle,children:"Alert Trends"}),s.length>0?q(["Date","Fall Alerts","Device Offline","Total"],s):e.jsx(w,{style:f.noData,children:"No data available."})]}),e.jsxs(v,{style:f.section,children:[e.jsx(w,{style:f.sectionTitle,children:"Agent Performance"}),a.length>0?q(["Agent","Performance %"],a):e.jsx(w,{style:f.noData,children:"No data available."})]}),e.jsxs(v,{style:f.section,children:[e.jsx(w,{style:f.sectionTitle,children:"SLA Compliance Report"}),l.length>0?q(["Date","Fall Alert","Device Offline","SLA Compliance (%)"],l):e.jsx(w,{style:f.noData,children:"No data available."})]})]})}),He=({pdfProps:t={}})=>e.jsx(ye,{document:e.jsx(Ge,{basicInfo:t.basicInfo,totalAlertOverview:t.totalAlertOverview,alertTrends:t.alertTrends,agentPerformance:t.agentPerformance,slaCompliance:t.slaCompliance}),fileName:"Analytics_Report.pdf",children:({loading:o})=>e.jsx(de,{children:o?"Generating...":"Export Report"})});function Qe({width:t="100%",height:o=400,data:s=[]}){const a=()=>{if(!s||s.length===0)return c();const i=new Map;s.forEach(h=>{const M=new Date(h.year,h.month-1,h.day),_=M.toISOString().split("T")[0],P=h.event==="5"?"Device Offline":"Fall Alert";i.has(_)||i.set(_,{date:M,timestamp:M.getTime(),dateFormatted:l(M,s),tooltipDate:d(M),"Fall Alert":0,"Device Offline":0});const V=i.get(_);V[P]+=h.count||0});const p=Array.from(i.values()).sort((h,M)=>h.timestamp-M.timestamp),T=p.map(h=>h.dateFormatted),m=p.map(h=>h.tooltipDate),A=p.map(h=>h["Fall Alert"]),S=p.map(h=>h["Device Offline"]);return{dates:T,tooltipDates:m,fallAlertData:A,deviceOfflineData:S}},l=(i,p)=>{if(!p||p.length===0)return i.toLocaleDateString("en-US",{month:"short",day:"numeric"});const T=p.map(M=>new Date(M.year,M.month-1,M.day)),m=new Date(Math.min(...T)),A=new Date(Math.max(...T)),S=Math.abs(A-m);return Math.ceil(S/(1e3*60*60*24))<=60?i.toLocaleDateString("en-US",{month:"short",day:"numeric"}):i.toLocaleDateString("en-US",{month:"short",year:"2-digit"})},d=i=>i.toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),c=()=>{const i=[],p=[],T=[],m=[],A=new Date;for(let S=9;S>=0;S--){const h=new Date(A);h.setDate(A.getDate()-S),i.push(h.toLocaleDateString("en-US",{month:"short",day:"numeric"})),p.push(h.toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"})),T.push(Math.floor(0)),m.push(Math.floor(0))}return{dates:i,tooltipDates:p,fallAlertData:T,deviceOfflineData:m}},{dates:n,tooltipDates:g,fallAlertData:x,deviceOfflineData:y}=a(),$=i=>i<=10?0:i<=20?1:i<=40?2:i<=60?3:Math.floor(i/12),I=x.reduce((i,p)=>i+p,0),r=y.reduce((i,p)=>i+p,0),N={tooltip:{trigger:"axis",backgroundColor:"transparent",borderWidth:0,className:"!shadow-none",axisPointer:{type:"line",lineStyle:{color:"rgb(var(--ms-text-color)/0.2)",width:1}},formatter:i=>{const p=i[0].dataIndex,T=g[p],m=i.find(S=>S.seriesName==="Fall Alert"),A=i.find(S=>S.seriesName==="Device Offline");return`
          <div class="bg-background border border-border rounded-lg shadow-xl p-3 min-w-[180px]">
            <div class="text-sm font-semibold text-text mb-3 border-b border-border pb-2">
              ${T}
            </div>
            <div class="space-y-2">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-2">
                  <div class="w-3 h-3 rounded-full" style="background-color: #ef4444"></div>
                  <span class="text-text/80 text-sm">Fall Alert</span>
                </div>
                <span class="font-mono font-medium text-text">${(m==null?void 0:m.value)||0}</span>
              </div>
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-2">
                  <div class="w-3 h-3 rounded-full" style="background-color: #f59e0b"></div>
                  <span class="text-text/80 text-sm">Device Offline</span>
                </div>
                <span class="font-mono font-medium text-text">${(A==null?void 0:A.value)||0}</span>
              </div>
            </div>
          </div>
        `}},legend:{show:!0,bottom:10,left:"center",itemWidth:12,itemHeight:12,itemGap:20,textStyle:{color:"rgb(var(--ms-text-color))",fontSize:12,fontWeight:"normal"},formatter:function(i){return i==="Fall Alert"?`Fall Alert: ${I.toLocaleString()}`:i==="Device Offline"?`Device Offline: ${r.toLocaleString()}`:i}},grid:{left:"3%",right:"4%",bottom:n.length>15?"80px":"50px",top:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:n,axisLine:{lineStyle:{color:"rgb(var(--ms-text-color)/0.2)"}},axisLabel:{color:"rgb(var(--ms-text-color)/0.7)",fontSize:11,interval:$(n.length),rotate:n.length>15?45:0,margin:n.length>15?15:8,formatter:i=>i},axisTick:{alignWithLabel:!0,interval:$(n.length)}},yAxis:{type:"value",axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"rgb(var(--ms-text-color)/0.1)",type:"dashed"}},axisLabel:{color:"rgb(var(--ms-text-color)/0.7)",fontSize:12}},series:[{name:"Fall Alert",type:"line",smooth:!0,showSymbol:!1,lineStyle:{width:3,color:"#ef4444"},itemStyle:{color:"#ef4444"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(239, 68, 68, 0.3)"},{offset:1,color:"rgba(239, 68, 68, 0.05)"}]}},data:x},{name:"Device Offline",type:"line",smooth:!0,showSymbol:!1,lineStyle:{width:3,color:"#f59e0b"},itemStyle:{color:"#f59e0b"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(245, 158, 11, 0.3)"},{offset:1,color:"rgba(245, 158, 11, 0.05)"}]}},data:y}],dataZoom:[{type:"inside",start:n.length>30?100-Math.floor(3e3/n.length):0,end:100},{show:!1}]};return e.jsx("div",{style:{width:t,height:o},children:e.jsx(K,{option:N,style:{width:"100%",height:"100%"},opts:{renderer:"svg"}})})}function Ke({data:t=[],width:o="100%",height:s=350}){const l=(()=>{const c=t.map(x=>x.score),n=Math.max(...c),g=Math.min(...c);return t.map(x=>({...x,isHighest:x.score===n,isLowest:x.score===g,itemStyle:{color:x.score===n?"#10b981":x.score===g?"#ef4444":"rgb(var(--ms-primary-color))"}}))})(),d={tooltip:{trigger:"item",backgroundColor:"transparent",borderWidth:0,renderMode:"html",appendToBody:!0,className:"!shadow-none",formatter:c=>{const{name:n,value:g,color:x}=c;return`
          <div class="bg-background border border-border rounded-lg shadow-xl p-3 min-w-[140px] z-999">
            <div class="flex items-center gap-2 mb-2">
              <div class="w-3 h-3 rounded-full" style="background-color: ${x}"></div>
              <span class="font-semibold text-text text-sm">${n}</span>
            </div>
            <div class="space-y-1">
              <div class="flex justify-between items-center">
                <span class="text-text/80 text-sm pr-1">Performance Score: </span>
                <span class="font-mono font-bold text-text text-sm">${g}%</span>
              </div>
            </div>
          </div>
        `}},legend:{show:!1},grid:{left:"3%",right:"4%",bottom:"3%",top:"5%",containLabel:!0},xAxis:{type:"category",show:!1,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!1}},yAxis:{type:"value",min:0,max:100,axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"rgb(var(--ms-text-color)/0.1)",type:"dashed"}},axisLabel:{color:"rgb(var(--ms-text-color)/0.7)",fontSize:12,formatter:"{value}%"}},series:[{name:"Performance Score",type:"bar",barWidth:"60%",itemStyle:{borderRadius:[7,7,0,0],borderWidth:0},label:{show:!0,position:"top",color:"rgb(var(--ms-text-color))",fontSize:12,fontWeight:"bold",formatter:"{c}%"},emphasis:{disabled:!0},data:l.map(c=>({value:c.score,name:c.name,itemStyle:{...c.itemStyle,borderWidth:0},emphasis:c.isHighest||c.isLowest?void 0:{itemStyle:{opacity:.8}}}))}]};return e.jsx("div",{style:{width:o,height:s},children:e.jsx(K,{option:d,style:{width:"100%",height:"100%"},opts:{renderer:"svg"}})})}function Ve({data:t,centerLabel:o,width:s="100%",height:a=400}){const l=t.reduce((n,g)=>n+g.value,0),d=Math.max(...t.map(n=>n.value)),c={tooltip:{trigger:"item",backgroundColor:"transparent",borderWidth:0,renderMode:"html",appendToBody:!0,className:"!shadow-none",formatter:n=>{const g=(n.value/l*100).toFixed(1);return`
          <div class="bg-background border border-border rounded-lg shadow-xl p-3 min-w-[140px] z-999">
            <div class="flex items-center gap-2 mb-2">
              <div class="w-3 h-3 rounded-full" style="background-color: ${n.color}"></div>
              <span class="font-semibold text-text text-sm">${n.name}</span>
            </div>
            <div class="space-y-1">
              <div class="flex justify-between items-center">
                <span class="text-text/80 text-sm">Count</span>
                <span class="font-mono font-medium text-text">${n.value.toLocaleString()}</span>
              </div>
              <div class="flex justify-between items-center">
                <span class="text-text/80 text-sm">Percent</span>
                <span class="font-mono font-medium text-text">${g}%</span>
              </div>
            </div>
          </div>
        `}},legend:{show:!1},series:[{type:"pie",radius:["37%","77%"],roseType:"area",emphasis:{scale:!0,scaleSize:10,focus:"self"},itemStyle:{borderWidth:0,borderColor:"#fff"},label:{show:!0,fontSize:14,color:"rgb(var(--ms-text-color))",formatter:({name:n,value:g})=>`${n}
{value|${g.toLocaleString()}}`,rich:{value:{fontSize:24,fontWeight:600,color:"rgb(var(--ms-text-color)/0.7)",padding:[2,0,0,0]}}},labelLine:{show:!0,length:20,length2:10,smooth:!0,lineStyle:{width:1,type:"solid"}},data:t.map(n=>({...n,...n.value===d&&{emphasis:{itemStyle:{shadowBlur:15,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(0, 0, 0, 0.5)"}},itemStyle:{...n.itemStyle,shadowBlur:8,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"rgba(0, 0, 0, 0.3)"}}}))}]};return e.jsxs("div",{className:"relative",style:{width:s,height:a},children:[e.jsx(K,{option:c,style:{width:"100%",height:"100%"},opts:{renderer:"svg"}}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none",children:[e.jsx("div",{className:"text-[22px] font-bold text-text",children:l.toLocaleString()}),e.jsx("div",{className:"text-xs text-muted-foreground mt-0",children:o||"Total"})]})]})}function Xe(t,o){const s=new Date(t),l=new Date(o)-s,d=Math.floor(l/(1e3*60*60)),c=Math.floor(l%(1e3*60*60)/(1e3*60)),n=Math.floor(l%(1e3*60)/1e3);return{hours:d,minutes:c,seconds:n,totalMinutes:l/(1e3*60)}}function qe(t){const o=Math.floor(t/60),s=Math.floor(t%60),a=Math.floor(t*60%60);return o>0?`${o}h ${s}m ${a}s`:s>0?`${s}m ${a}s`:`${a}s`}const Ze=t=>t.map(o=>{const s=new Date(o.created_at);new Date(o.closed_at);const a=Xe(o.created_at,o.closed_at),l=s.toISOString().split("T")[0],d=s.toTimeString().split(" ")[0].substring(0,5),c=s.getHours()+s.getMinutes()/60;qe(o.sla_minutes);const n={2:"Fall Alert",5:"Device Offline Alert"};return{_id:o._id,day:l,time:d,hour:c,responseTime:a.totalMinutes,responseTimeFormatted:`${a.hours}h ${a.minutes}m ${a.seconds}s`,slaTime:o.sla_minutes,slaTimeFormatted:"2m",alertId:o._id,compliance:o.sla_status,alertType:n[o.event]||`Event ${o.event}`,created_at:o.created_at,closed_at:o.closed_at,event:o.event}});function Je({data:t=[],width:o="100%",height:s=400}){const a=()=>{const r=["2024-01-01","2024-01-02","2024-01-03","2024-01-04","2024-01-05"],N=["Device Offline Alert","Fall Alert"],i=[];return r.forEach(p=>{const T=Math.floor(Math.random()*12)+8;for(let m=0;m<T;m++){const A=Math.floor(Math.random()*24),S=Math.floor(Math.random()*60),h=Math.floor(Math.random()*25)+5,M=15,_=h<=M,P=N[Math.floor(Math.random()*N.length)];i.push({day:p,time:`${A.toString().padStart(2,"0")}:${S.toString().padStart(2,"0")}`,hour:A+S/60,responseTime:h,slaTime:M,alertId:`A${p.replace(/-/g,"")}${m+1}`,compliance:_,alertType:P})}}),i},d=t.length>0?Ze(t):a(),c=d.length,n=d.filter(r=>r.compliance).length,g=d.filter(r=>!r.compliance).length,x=d.filter(r=>r.compliance),y=d.filter(r=>!r.compliance),$=[...new Set(d.map(r=>r.day))].sort(),I={tooltip:{trigger:"item",backgroundColor:"transparent",borderWidth:0,renderMode:"html",appendToBody:!0,className:"!shadow-none",formatter:r=>{const{name:N,compliance:i,responseTimeFormatted:p,slaTimeFormatted:T,time:m,day:A,alertType:S,event:h,created_at:M,closed_at:_}=r.data;return`
          <div class="bg-background border border-border rounded-lg shadow-xl p-3 min-w-[250px] z-999">
            <div class="text-sm font-semibold text-text mb-3 border-b border-border pb-2">
              ${S}
            </div>
            <div class="space-y-2">
              <div class="flex items-center justify-between">
                <span class="text-text/80 text-sm">Date</span>
                <span class="font-mono font-medium text-text">${A}</span>
              </div>
              <div class="flex items-center justify-between">
                <span class="text-text/80 text-sm">Time</span>
                <span class="font-mono font-medium text-text">${m}</span>
              </div>
              <div class="flex items-center justify-between">
                <span class="text-text/80 text-sm">Response Time</span>
                <span class="font-mono font-medium text-text">${p}</span>
              </div>
              <div class="flex items-center justify-between">
                <span class="text-text/80 text-sm">SLA Time</span>
                <span class="font-mono font-medium text-text">${T}</span>
              </div>
              <div class="flex items-center justify-between">
                <span class="text-text/80 text-sm">Status</span>
                <span class="font-mono font-medium" style="color: ${i?"#10b981":"#ef4444"}">${i?"Compliance":"Not Compliance"}</span>
              </div>
             
            </div>
          </div>
        `}},legend:{show:!0,bottom:0,left:"center",itemWidth:12,itemHeight:12,itemGap:20,textStyle:{color:"rgb(var(--ms-text-color))",fontSize:12},formatter:function(r){return r==="Total Alerts"?`Total Alerts: ${c}`:r==="Compliance"?`Compliance: ${n}`:r==="Not Compliance"?`Not Compliance: ${g}`:r},rich:{bold:{fontWeight:"bold",color:"rgb(var(--ms-text-color))",fontFamily:"monospace",fontSize:12}},data:[{name:"Total Alerts",itemStyle:{color:"rgb(var(--ms-primary-color))"}},{name:"Compliance",itemStyle:{color:(t==null?void 0:t.length)==0?"#ccc":"#10b981"}},{name:"Not Compliance",itemStyle:{color:(t==null?void 0:t.length)==0?"#ccc":"#ef4444"}}]},grid:{left:"3%",right:"4%",bottom:"15%",top:"3%",containLabel:!0},xAxis:{type:"value",nameLocation:"middle",nameGap:30,min:0,max:24,axisLine:{show:!1,lineStyle:{color:"rgb(var(--ms-text-color)/0.3)"}},axisTick:{show:!1},axisLabel:{show:!0,color:"rgb(var(--ms-text-color)/0.7)",formatter:function(r){return`${Math.floor(r)}:00`}},splitLine:{show:!1,lineStyle:{color:"rgb(var(--ms-text-color)/0.1)",type:"solid"}}},yAxis:{type:"category",nameLocation:"middle",nameGap:40,data:$,axisLine:{show:!1,lineStyle:{color:"rgb(var(--ms-text-color)/0.3)"}},axisTick:{show:!0},axisLabel:{show:!0,color:"rgb(var(--ms-text-color)/0.7)",formatter:function(r){return new Date(r).toLocaleDateString("en-US",{month:"short",day:"numeric"})}},splitLine:{show:!0,lineStyle:{color:"rgb(var(--ms-text-color)/0.1)"}}},dataZoom:[{type:"slider",yAxisIndex:0,filterMode:"filter",start:50,end:100,height:20,bottom:40,show:!1,handleStyle:{color:"rgb(var(--ms-primary-color))"}},{type:"inside",yAxisIndex:0,filterMode:"filter"}],series:[{name:"Compliance",type:"scatter",symbolSize:10,data:x.map(r=>({name:r.alertId,value:[r.hour,r.day],responseTime:r.responseTime,responseTimeFormatted:r.responseTimeFormatted,slaTime:r.slaTime,slaTimeFormatted:r.slaTimeFormatted,compliance:r.compliance,day:r.day,time:r.time,alertType:r.alertType,event:r.event,created_at:r.created_at,closed_at:r.closed_at,itemStyle:{color:(t==null?void 0:t.length)==0?"#ccc":"#10b981"}})),itemStyle:{color:(t==null?void 0:t.length)==0?"#ccc":"#10b981"},emphasis:{scale:!0,scaleSize:2}},{name:"Not Compliance",type:"scatter",symbolSize:10,data:y.map(r=>({name:r.alertId,value:[r.hour,r.day],responseTime:r.responseTime,responseTimeFormatted:r.responseTimeFormatted,slaTime:r.slaTime,slaTimeFormatted:r.slaTimeFormatted,compliance:r.compliance,day:r.day,time:r.time,alertType:r.alertType,event:r.event,created_at:r.created_at,closed_at:r.closed_at,itemStyle:{color:(t==null?void 0:t.length)==0?"#ccc":"#ef4444"}})),itemStyle:{color:(t==null?void 0:t.length)==0?"#ccc":"#ef4444"},emphasis:{scale:!0,scaleSize:2}}]};return e.jsx("div",{style:{width:o,height:s},children:e.jsx(K,{option:I,style:{width:"100%",height:"100%"},opts:{renderer:"svg"}})})}const et=(t={},o={})=>z([B.COUNT_STATISTICS,t],()=>Oe(t),{...o,retry:0}),tt=(t={},o={})=>z([B.TOTAL_ALERTS,t],()=>Ee(t),{...o,retry:0}),ot=(t={},o={})=>z([B.TOTAL_ALERTS_TREND,t],()=>Pe(t),{...o,retry:0}),at=(t={},o={})=>z([B.AGENT_PERFORMANCE,t],()=>ke(t),{...o,retry:0}),st=(t={},o={})=>z([B.SLA_STATISTICS,t],()=>ze(t),{...o,retry:0}),rt=t=>{if(!t||!Array.isArray(t)||t.length===0)return{totalAgents:0,averagePerformance:0,highestPerformance:0,lowestPerformance:0,highestAgent:null,lowestAgent:null};const o=t.length,s=t.reduce((c,n)=>c+n.score,0),a=Math.round(s/o),l=t.reduce((c,n)=>n.score>c.score?n:c),d=t.reduce((c,n)=>n.score<c.score?n:c);return{totalAgents:o,averagePerformance:a,highestPerformance:l.score,lowestPerformance:d.score,highestAgent:l,lowestAgent:d}},nt=t=>{const o={};return t.forEach(s=>{const a=new Date(s.created_at);a.toISOString().split("T")[0];const l=new Date(a).toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"}).replace(/,/g,"");o[l]||(o[l]={date:l,fall:0,offline:0,total:0,compliant:0});const c={2:"fall",5:"offline"}[s.event];c&&o[l][c]++,o[l].total++,(s.sla_status==="compliant"||s.sla_status===!0)&&o[l].compliant++}),Object.values(o).sort((s,a)=>new Date(s.date)-new Date(a.date)).map(s=>({date:s.date,fall:s.fall,offline:s.offline,percent:s.total>0?`${Math.round(s.compliant/s.total*100)}%`:"0%"}))};function gt(){var J,ee,te,oe;const{appName:t}=Se.branding,[o,s]=we.useState({from:null,to:null}),[a,l]=E.useState([]),[d,c]=E.useState([]),[n,g]=E.useState({}),x={2:{name:"Fall Alerts",color:"#ef4444"},5:{name:"Device Offline",color:"#f59e0b"}},{data:y,isLoading:$,isError:I,error:r}=et({to_date:o.from||j().subtract(30,"day").format("YYYY-MM-DD"),from_date:o.to||j().format("YYYY-MM-DD")}),N=((J=y==null?void 0:y.data)==null?void 0:J.device_uptime)??0,i=((ee=y==null?void 0:y.data)==null?void 0:ee.device_downtime)??0,p=N+i,T=p>0?Math.round(N/p*100):0,{data:m,isLoading:A,isError:S,isSuccess:h,error:M}=tt({to_date:o.from||j().subtract(30,"day").format("YYYY-MM-DD"),from_date:o.to||j().format("YYYY-MM-DD")});E.useEffect(()=>{var L,Y;const u=Array.isArray(m==null?void 0:m.data)&&((L=m==null?void 0:m.data)==null?void 0:L.length)>0?(Y=m==null?void 0:m.data)==null?void 0:Y.map(C=>{var F,k;return{value:(C==null?void 0:C.count)??0,name:((F=x[C==null?void 0:C._id])==null?void 0:F.name)||"Unknown",itemStyle:{color:((k=x[C==null?void 0:C._id])==null?void 0:k.color)||"#9ca3af"}}}):[{value:0,name:"No Data",itemStyle:{color:"#9ca3af"}}];l(u)},[m,h]);const{data:_,isLoading:P,isError:V,error:it}=ot({to_date:o.from||j().subtract(30,"day").format("YYYY-MM-DD"),from_date:o.to||j().format("YYYY-MM-DD")}),{data:W,isLoading:ct,isError:dt,isSuccess:me,error:mt}=at({to_date:o.from||j().subtract(30,"day").format("YYYY-MM-DD"),from_date:o.to||j().format("YYYY-MM-DD")});E.useEffect(()=>{var L;const u=(L=W==null?void 0:W.data)==null?void 0:L.map(Y=>{const C=(Y.countLessThan2Min??0)+(Y.countGreaterThan2Min??0),F=C>0?(Y.countLessThan2Min??0)/C*100:0;return{name:Y.closed_by,score:Math.round(F)}});c(u)},[W,me]);const{data:b,isLoading:ft,isError:ht,error:pt}=st({to_date:o.from||j().subtract(30,"day").format("YYYY-MM-DD"),from_date:o.to||j().format("YYYY-MM-DD")});function Z(u){if(!u||u.length===0)return 0;const Y=u.filter(C=>C.sla_status).length/u.length*100;return Math.round(Y*100)/100}const fe=je("(max-width: 1366px)"),R=rt(d),he=u=>u.toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"});return E.useEffect(()=>{var ae,se,re,ne,le;const u={companyName:t,startDate:o.from||j().format("YYYY-MM-DD"),endDate:o.to||j().subtract(30,"day").format("YYYY-MM-DD"),totalAlerts:((ae=m==null?void 0:m.data)==null?void 0:ae.reduce((D,O)=>D+O.count,0))||0,avgResponseTime:ie(((se=y==null?void 0:y.data)==null?void 0:se.avg_res_time)||0),slaCompliance:(b==null?void 0:b.data)&&Z(b==null?void 0:b.data)||"0%",deviceUptime:Math.round(T)+"%"},L=((re=a==null?void 0:a.filter(D=>D.name=="Fall Alerts")[0])==null?void 0:re.value)||0,Y=((ne=a==null?void 0:a.filter(D=>D.name=="Device Offline")[0])==null?void 0:ne.value)||0,C={fall:L,offline:Y,total:L+Y},F=new Map;(le=_==null?void 0:_.data)==null||le.forEach(D=>{const O=new Date(D.year,D.month-1,D.day),X=O.toISOString().split("T")[0],xe=D.event==="5"?"offline":"fall";F.has(X)||F.set(X,{timestamp:O.getTime(),date:he(O),fall:0,offline:0,total:0});const U=F.get(X);U[xe]+=D.count||0,U.total=U.fall+U.offline});const k=Array.from(F.values()).sort((D,O)=>D.timestamp-O.timestamp);k.forEach(D=>{delete D.timestamp});const pe=d==null?void 0:d.map(D=>({...D,score:`${D.score}%`})),ue=nt((b==null?void 0:b.data)||[]);g({basicInfo:u,totalAlertOverview:C,alertTrends:k,agentPerformance:pe,slaCompliance:ue})},[o.to,o.form]),e.jsxs("div",{className:"mb-6",children:[" ",e.jsxs("div",{id:"customer_heading",className:"flex justify-between sm:flex-row flex-col gap-4 items-center mb-6",children:[e.jsx(lt,{}),e.jsxs("div",{className:"flex gap-2  items-center",children:[e.jsxs(Te,{children:[e.jsx(Ae,{asChild:!0,children:e.jsxs(de,{variant:"tertiary",children:[e.jsx(Me,{}),o!=null&&o.from&&(o!=null&&o.to)?`${o.from} - ${o.to}`:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{children:"Start Date"})," ",e.jsx(Ie,{})," ",e.jsx("span",{children:"End Date"})]})]})}),e.jsx(Ce,{className:"overflow-hidden p-0",align:"end",children:e.jsx(_e,{className:"w-full border-border",mode:"range",selected:o,onSelect:u=>{if(!(u!=null&&u.from)||!(u!=null&&u.to)){s({from:null,to:null});return}s({from:j(u.from).format("YYYY-MM-DD"),to:j(u.to).format("YYYY-MM-DD")})},captionLayout:"dropdown",fixedWeeks:!0,showOutsideDays:!0})})]}),e.jsx(He,{pdfProps:n})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:" items-center justify-between grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4 lg:auto-rows-fr",children:[e.jsx(H,{label:"Total Alerts",value:((te=m==null?void 0:m.data)==null?void 0:te.reduce((u,L)=>u+L.count,0))||0,icon:e.jsx(Ye,{size:20,color:"white"})}),e.jsx(H,{label:"Avg. Response Time",value:ie(((oe=y==null?void 0:y.data)==null?void 0:oe.avg_res_time)||0),icon:e.jsx(Le,{size:20,color:"white"})}),e.jsx(H,{label:"SLA Compliance",value:(b==null?void 0:b.data)&&Z(b==null?void 0:b.data)||"0%",icon:e.jsx(Ne,{size:20,color:"white"})}),e.jsx(H,{label:"Device Uptime",value:Math.round(T)+"%",icon:e.jsx(Fe,{size:20,color:"white"})})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2 lg:auto-rows-fr",children:[e.jsx("div",{id:"Total Alert Overview Graph",children:e.jsx(G,{title:e.jsx("h1",{className:"text-lg",children:"Total Alert Overview"}),headerPadding:"p-4 !text-lg border-none",children:e.jsx("div",{className:"p-4 !h-full flex items-center justify-center",children:e.jsx(Ve,{data:a,centerLabel:" ",width:"100%",height:fe?340:400})})})}),e.jsx("div",{id:"Alert Trends Graph",children:e.jsx(G,{title:e.jsx("h1",{className:"text-lg",children:"Alert Trends"}),headerPadding:"p-4 !text-lg border-none",children:e.jsx("div",{className:"p-4",children:e.jsx(Qe,{data:_==null?void 0:_.data})})})}),e.jsx("div",{id:"Agent Performance Graph",children:e.jsx(G,{title:e.jsx("h1",{className:"text-lg",children:"Agent Performance"}),headerPadding:"p-4 !text-lg border-none",children:e.jsxs("div",{className:"p-4",children:[e.jsx(Ke,{data:d,height:340}),e.jsxs("div",{className:"flex items-center gap-4 justify-center mt-4",children:[e.jsx(Q,{title:"Total Agent",value:R.totalAgents}),e.jsx(Q,{title:"Avg. Performance",value:R.averagePerformance+"%"}),e.jsx(Q,{title:"Highest Performance",value:R.highestPerformance+"%"}),e.jsx(Q,{title:"Lowest Performance",value:R.lowestPerformance+"%"})]})]})})}),e.jsx("div",{id:"SLA Compliance Report Graph",children:e.jsx(G,{title:e.jsx("h1",{className:"text-lg",children:"SLA Compliance Report"}),headerPadding:"p-4 !text-lg border-none",children:e.jsx(Je,{width:"100%",height:400,data:b==null?void 0:b.data})})})]})]})]})}const lt=()=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col items-start gap-2 w-full",children:[e.jsx("h1",{className:"text-text sm:text-xl text-lg",children:"Reporting & Analytics"}),e.jsx("div",{className:"opacity-95",children:e.jsx($e,{})})]})}),H=({label:t="",value:o="",icon:s})=>e.jsxs("div",{className:"bg-card p-4 flex items-center justify-between gap-3 rounded-md w-full",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm",children:t}),e.jsx("h1",{className:"text-lg font-semibold",children:o})]}),e.jsx("div",{className:"p-2 bg-primary w-fit rounded-md text-lg",children:s})]}),Q=({title:t,value:o})=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex items-center gap-2 ",children:[e.jsxs("div",{className:"p-2 px-3 bg-primary rounded-lg text-white font-medium text-sm",children:[" ",o]}),e.jsxs("div",{className:"rounded-lg text-sm text-wrap",children:[" ",t]})]})});export{gt as default};
//# sourceMappingURL=Analytics-BA-IXEV_.js.map
