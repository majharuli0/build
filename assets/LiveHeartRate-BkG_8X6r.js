import{r as i,j as e,fI as p}from"./index-CH_40pe4.js";import y from"./LiveRateChart-DIMlK9RO.js";import{C as R}from"./UseCustomContext-xPEkmNco.js";import{a as w}from"./helper-DiiBu3B1.js";import"./index-NiEZgb1K.js";try{let a=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new a.Error().stack;t&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[t]="f0f900c3-473a-4708-8340-093a519aa2a7",a._sentryDebugIdIdentifier="sentry-dbid-f0f900c3-473a-4708-8340-093a519aa2a7")}catch{}function L(){var h,u,b;const{elderlyDetails:a,sleepData:t}=i.useContext(R),d=a==null?void 0:a.deviceId,[v,x]=i.useState({time:[],heartRate:[],breathRate:[]}),[o,f]=i.useState(null),[m,g]=i.useState(Date.now()),j=s=>{const n=w(s);f(n),g(Date.now())};return i.useEffect(()=>{const s=setInterval(()=>{if(Date.now()-m>5e3)f(null),x({time:[],heartRate:[],breathRate:[]});else if(o){const r=new Date().toLocaleTimeString();x(l=>({time:[...l.time,r].slice(-30),heartRate:[...l.heartRate,o.heartRateValue].slice(-30),breathRate:[...l.breathRate,o.breathingValue].slice(-30)}))}},1e3);return()=>clearInterval(s)},[o,m]),i.useEffect(()=>{const s=new WebSocket("wss://live.elderlycareplatform.com/ws/");return s.onopen=()=>{console.log("Connected to WebSocket server")},s.onmessage=n=>{var l;const c=JSON.parse(n==null?void 0:n.data),r=(l=JSON.parse(c==null?void 0:c.message))==null?void 0:l.payload;(r==null?void 0:r.deviceCode)===d&&(r!=null&&r.heartbreath)&&j(r.heartbreath)},s.onerror=n=>{},s.onclose=()=>{console.log("Disconnected from WebSocket server")},()=>s.close()},[d]),e.jsxs("div",{className:"w-full bg-white rounded-2xl p-6 flex flex-col gap-6 h-auto",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:"Live Heart Rate"}),e.jsx("div",{id:"LiveRate",className:"flex flex-col gap-1 pl-3 mb-2",children:e.jsxs("div",{className:"text-4xl font-bold flex items-center gap-2",style:{color:"#D76C82"},children:[(o==null?void 0:o.heartRateValue)??"--"," ",e.jsx("span",{className:"text-secondary/40",children:"BPM"}),e.jsx(p,{color:"#D76C82",size:24})]})}),e.jsx(y,{data:v,color:"#D76C82",type:"heartRate"}),e.jsx("div",{id:"footer",children:e.jsxs("div",{className:"flex justify-evenly items-center",children:[e.jsxs("div",{id:"avgRate",className:"flex flex-col items-center justify-center gap-0",children:[e.jsx("div",{className:"text-3xl text-primary font-bold",children:((h=t==null?void 0:t.heart_rate_vo)==null?void 0:h.avg)??"--"}),e.jsx("div",{className:"text-sm text-gray-500 font-semibold",children:"Avg. Rate"})]}),e.jsxs("div",{id:"minRate",className:"flex flex-col items-center justify-center gap-0",children:[e.jsxs("div",{className:"text-3xl text-primary font-bold",children:[" ",((u=t==null?void 0:t.heart_rate_vo)==null?void 0:u.min)??"--"]}),e.jsx("div",{className:"text-sm text-gray-500 font-semibold",children:"Min Rate"})]}),e.jsxs("div",{id:"maxRate",className:"flex flex-col items-center justify-center gap-0",children:[e.jsxs("div",{className:"text-3xl text-primary font-bold",children:[" ",((b=t==null?void 0:t.heart_rate_vo)==null?void 0:b.max)??"--"]}),e.jsx("div",{className:"text-sm text-gray-500 font-semibold",children:"Max Rate"})]})]})})]})}export{L as default};
//# sourceMappingURL=LiveHeartRate-BkG_8X6r.js.map
