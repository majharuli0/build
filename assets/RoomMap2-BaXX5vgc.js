import{r as a,j as e}from"./index-DQy7c-QQ.js";import{G as V,a as gt,R as $,S as yt,L as ut}from"./ReactKonvaCore-DYW_3aEY.js";import"./helper-BBch2RZo.js";function mt({startX:L=300,startY:O=0,left:u=300,right:N=300,bottom:F=400,devider:t=1,roomObjects:C}){const[n,H]=a.useState(null),[A,W]=a.useState([]),P=i=>i==null?void 0:i.map(s=>{const[w,p]=s.up_left.split(",").map(Number),[y,B]=s.low_left.split(",").map(Number),[M,m]=s.up_right.split(",").map(Number);s.low_right.split(",").map(Number);const R=Math.abs(w*10),K=Math.abs(M*10),v=Math.abs(B*10),E=Math.abs(p*10);return{id:s._id,type:s.type,width:s.width,length:s.length,left:R,right:K,top:v,bottom:E}});a.useEffect(()=>{const i=P(C);console.log(i),W(i);const s=new window.Image;s.src="/src/assets/Device.png",console.log(s.src),s.onload=()=>{H(s)}},[]);const X=()=>{const i=1*t,w=400*i,p=L*i,y=O*i,B=F*i,M=140/2*(Math.PI/180),m=w,R=p-m*Math.tan(M),K=p+m*Math.tan(M),v=y+m,E=u*i,U=N*i;return{linePoints:[p,y,R,v,K,v],leftOffsetPx:E,rightOffsetPx:U,heightPx:B,startXPx:p,startYPx:y}},{linePoints:_,leftOffsetPx:j,rightOffsetPx:Y,heightPx:r,startXPx:d,startYPx:h}=X(),c={type:5,up_left:"-7,26",low_left:"-7,8",up_right:"13,26",low_right:"13,8",width:21.3,length:18.2,_id:"6755c5e1120105d24ac696bb"},S=i=>{const[s,w]=i.split(",").map(Number);return{x:s,y:w}},x=S(c.up_left),D=S(c.low_left),f=S(c.up_right),k=S(c.low_right),b=1,q=c.width*b,I=c.length*b,J=(x.x+D.x)/2*b,G=(f.x+k.x)/2*b,z=(x.y+f.y)/2*b,Q=(D.y+k.y)/2*b;return q.toFixed(2)*10,I.toFixed(2)*10,J.toFixed(2)*10,G.toFixed(2)*10,z.toFixed(2)*10,Q.toFixed(2)*10,e.jsxs(e.Fragment,{children:[e.jsxs(V,{clip:{x:0,y:0,width:window.innerWidth,height:window.innerHeight},children:[e.jsx(gt,{points:_,fill:"transparent",closed:!0,opacity:.2}),e.jsx($,{x:d-j,y:h,width:j+Y,height:r,fill:"transparent",opacity:.2})]}),e.jsx(V,{clip:{x:d-j,y:h,width:j+Y,height:r},children:e.jsx(gt,{points:_,closed:!0,fill:"red",opacity:"0.2",fillLinearGradientStartPoint:{x:0,y:0},fillLinearGradientEndPoint:{x:0,y:r},fillLinearGradientColorStops:[0,"rgba(13,160,255,0.6)",1,"rgba(255,255,255,0.2)"]})})]})}const Pt=({centerX:L=300,centerY:O=200,left:u=300,right:N=300,top:F=200,bottom:t=200,devider:C=1})=>{const n=1*C,H=L*n,A=O*n,W=H-u*n,P=A-F*n,X=(u+N)*n,_=(F+t)*n;return e.jsx(e.Fragment,{children:e.jsx($,{x:W,y:P,width:X,height:_,fill:"rgba(13,160,255,0.5)"})})},Mt=({containerWidth:L="100%",containerHeight:O="100%",margin:u=25,roomWidth:N=600,roomHeight:F=400,roomInfo:t=[]})=>{var et,st,it,nt,ct,at,lt,ot;const C=a.useRef(null),n=a.useRef(null),H=a.useRef(null),[A,W]=a.useState([]);a.useState({x:0,y:0});const P=600,X=400,_=650,j=450,Y=1,r=_*Y,d=j*Y,h=25,[c,S]=a.useState(1),[x,D]=a.useState(0),[f,k]=a.useState(0),[b,q]=a.useState(0),[I,J]=a.useState(0);a.useEffect(()=>{const g=()=>{if(n.current){const o=n.current.clientWidth/r,Z=n.current.clientHeight/d,T=Math.min(o,Z);S(T);const rt=n.current.clientWidth,ht=n.current.clientHeight;D(rt),k(ht);const bt=(rt-r*T)/2,wt=(ht-d*T)/2;q(bt),J(wt)}};g();const l=new ResizeObserver(g);return n.current&&l.observe(n.current),()=>{l&&l.disconnect()}},[r,d]);const G=Math.ceil(x/c/h),z=Math.ceil(f/c/h),Q=G*h,i=z*h,s=[];for(let g=0;g<G;g++)for(let l=0;l<z;l++)s.push(e.jsx($,{x:g*h,y:l*h,width:h,height:h,fill:"#F4F4F4",stroke:"white",onMouseEnter:o=>{o.target.fill("#E6E6E6"),o.target.draw()},onMouseLeave:o=>{o.target.fill("#F4F4F4"),o.target.draw()}},`${g}-${l}`));const w={up_left:"left",low_left:"right",up_right:"up",low_right:"bottom"},[p,y]=(((st=(et=t==null?void 0:t.device_boundaries)==null?void 0:et.up_left)==null?void 0:st.split(","))||["0","0"]).map(Number),[B,M]=(((nt=(it=t==null?void 0:t.device_boundaries)==null?void 0:it.low_left)==null?void 0:nt.split(","))||["0","0"]).map(Number),[m,R]=(((at=(ct=t==null?void 0:t.device_boundaries)==null?void 0:ct.up_right)==null?void 0:at.split(","))||["0","0"]).map(Number),[K,v]=(((ot=(lt=t==null?void 0:t.device_boundaries)==null?void 0:lt.low_right)==null?void 0:ot.split(","))||["0","0"]).map(Number),E=Math.abs(p),U=Math.abs(m),tt=Math.max(y,R),dt=Math.max(M,v),pt=Math.abs(m),xt=Math.abs(p),ft=Math.max(y,R);return a.useEffect(()=>{const g=Object.entries((t==null?void 0:t.device_boundaries)||[]).filter(([l,o])=>typeof o=="string").map(([l,o])=>{const Z=Math.abs(parseInt(o.split(",")[0],10));return{[w[l]]:Z}}).reduce((l,o)=>({...l,...o}),{});W(g),console.log(g)},[]),e.jsx("div",{ref:n,style:{width:L,height:O,overflow:"hidden",display:"flex",justifyContent:"center",alignItems:"center",margin:"0 auto"},children:e.jsxs(yt,{ref:C,width:x,height:f,scaleX:c,scaleY:c,style:{backgroundColor:"red"},children:[e.jsx(ut,{ref:H,x:(x/c-Q)/2,y:(f/c-i)/2,children:s}),e.jsxs(ut,{x:(x-r*c)/2,y:(f-d*c)/2,children:[e.jsx($,{x:u,y:u,width:r-2*u,height:d-2*u,strokeWidth:1,stroke:"#A1A1A1",cornerRadius:0}),(t==null?void 0:t.mount_type)===1&&e.jsx(V,{x:(r-P)/2,y:25,children:e.jsx(mt,{left:pt*10,right:xt*10,bottom:ft*10,roomObjects:t==null?void 0:t.device_areas})}),(t==null?void 0:t.mount_type)===2&&e.jsx(V,{x:(r-P)/2,y:(d-X)/2,children:e.jsx(Pt,{left:E*10,right:U*10,top:tt*10,bottom:dt*10})})]})]})})};export{Mt as R};
