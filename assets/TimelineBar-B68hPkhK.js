import{r as l,$ as j,j as i,bq as D}from"./index-CfoUWzUu.js";import{E as C}from"./index-DNIPEMeC.js";const z=({alarmEvents:m=[],enterBedTime:d,getupAfterTime:u})=>{const{sleepEventsType:o,sleepEventsColor:g}=l.useContext(j),[n,T]=l.useState([]),[c,f]=l.useState({});l.useEffect(()=>{const t=m.map(e=>({name:o[e.event_type],startTime:new Date(e.ts),endTime:new Date(e.ts),color:g[o[e.event_type]]}));if(JSON.stringify(t)!==JSON.stringify(n)){T(t);const e=t.reduce((s,r)=>(s[r.name]=!0,s),{});f(e)}},[m,n]);const y=t=>{console.log(t),f(e=>({...e,[t]:!e[t]}))},b=Math.min(...n.map(t=>t.startTime.getTime())),S=Math.max(...n.map(t=>t.endTime.getTime())),E=n.map(t=>{const e=t.startTime.getTime()===t.endTime.getTime();return{name:t.name,value:[t.startTime.getTime(),t.endTime.getTime(),e?15:10],itemStyle:{color:t.color}}}).filter(t=>c[t.name]);if(n.length===0)return i.jsx(D,{description:"No data available to show"});const v={tooltip:{trigger:"item",formatter:t=>{const e=n[t.dataIndex],s=e.startTime.getTime()===e.endTime.getTime(),r=new Date(e.startTime).toLocaleString();if(s)return`${e.name}<br/>Date & Time: ${r}`;{const a=new Date(e.endTime).toLocaleString(),w=e.endTime-e.startTime,p=Math.floor(w/(1e3*60)),x=Math.floor(p/60),h=p%60,$=x>0?`${x} hour(s) ${h} minute(s)`:`${h} minute(s)`;return`<b>${e.name}</b> <br/>Start: ${r}<br/>End: ${a}<br/>Duration: ${$}`}}},grid:{left:"5%",right:"5%",bottom:"15%",containLabel:!1},xAxis:{type:"time",boundaryGap:!1,min:b,max:S,splitNumber:5,axisLabel:{formatter:t=>{const e=new Date(t),s=e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return e.getTime()===new Date(d).getTime()?`Enter Bed ${s}`:e.getTime()===new Date(u).getTime()?`Getup After ${s}`:s},interval:0,margin:5}},yAxis:{show:!1},series:[{name:"Events",type:"custom",renderItem:(t,e)=>{const s=e.coord([e.value(0),0]),r=e.coord([e.value(1),0]),a=e.size([0,e.value(2)])[1];return{type:"rect",shape:{x:s[0],y:t.coordSys.height-a+60,width:Math.max(r[0]-s[0],5),height:a},style:{fill:e.style().fill,stroke:"#fff",lineWidth:1}}},encode:{x:[0,1]},data:E}],graphic:[{type:"text",left:"5%",bottom:"1%",style:{text:`Enter Bed ${d}`,fontSize:12}},{type:"text",right:"5%",bottom:"1%",style:{text:`Getup After ${u}`,fontSize:12}}]};return i.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 w-full",children:[i.jsx("div",{id:"customLegend",className:"w-full",children:i.jsx("div",{className:"flex flex-wrap gap-4 items-center justify-center",children:Object.keys(o).filter(t=>m.some(e=>e.event_type===parseInt(t))).map(t=>{const e=o[t];return i.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>y(e),children:[i.jsx("div",{id:"legendColorShape",className:"size-3 rounded-[4px] border-2",style:{backgroundColor:c[e]?g[e]:"grey",borderColor:c[e]?"transparent":"#ccc"}}),i.jsx("div",{children:e})]},t)})})}),i.jsx(C,{option:v,style:{height:200,width:"100%"}})]})};export{z as default};
