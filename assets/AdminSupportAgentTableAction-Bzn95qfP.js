import{aw as Q,r as l,l as v,j as e,ay as F,bh as J,_ as y,bi as K,E as N,a6 as A,$ as q,aE as V,a8 as U,aC as L,bj as W,bk as Z,B as X,a0 as z,a5 as Y,bl as ee,aN as te,bm as se,aG as ne,bn as le,bo as I,aB as oe}from"./index-DwMZRLJz.js";import{a as re,b as ie}from"./index-BAjSbuMt.js";const ae=({modalOPen:x,setModalOpen:t,item:s,getlist:p})=>{const{register:a,handleSubmit:n,reset:d,formState:{errors:g}}=Q();l.useState(v.get("role"));const f=c=>{if(c.password==""){y.error("The new password cannot be empty");return}try{K(s._id,{password:c.password}).then(m=>{console.log(m),d(),t(!1),setTimeout(()=>{y.custom(C=>e.jsx(N,{t:C,text:"Temporary password has been successfully changed"}))},900)})}catch(m){console.error("An error occurred:",m),y.error("An error occurred while creating a new admin.")}};return e.jsx(F,{modalOPen:x,setModalOpen:t,handleSubmit:n(f),width:590,title:"Reset Password",buttonText:"Reset",children:e.jsx("div",{className:"pt-4 ",children:e.jsx(J,{label:"Enter a New Password",placeholder:"Enter Password",register:a("password",{required:"New Password is Required!",minLength:{value:8,message:"Password must be at least 8 characters"},validate:{hasNumber:c=>/[0-9]/.test(c)||"Password must contain at least one number",hasUpperCase:c=>/[A-Z]/.test(c)||"Password must contain at least one uppercase letter",hasSpecialChar:c=>/[!@#$%^&*]/.test(c)||"Password must contain at least one special character"}}),error:g.password})})})},$=x=>{const{data:t,handleEmitEvet:s}=x;l.useState(!1);const[p,a]=l.useState(!1),n=l.useContext(A),{rolesFormatter:d}=l.useContext(q),[g,f]=l.useState(t==null?void 0:t.role),[c,m]=l.useState(!1);l.useState(v.get("role"));const C=()=>{f(t.role),a(!0)},h=()=>{console.log("111",n),s?s(t):m(!0)},i=async()=>{g!=="nurse"?(await W(t==null?void 0:t._id).then(u=>{u&&(setTimeout(()=>{y.custom(b=>e.jsx(N,{t:b,text:u.message}))},900),n==null||n.getlist())}).finally(()=>{a(!1)}),console.log("it's Slaes agent delted")):await Z(t==null?void 0:t._id).then(u=>{u&&(n==null||n.getlist(),a(!1),setTimeout(()=>{y.custom(b=>e.jsx(N,{t:b,text:u.message}))},900))})};return e.jsxs(e.Fragment,{children:[e.jsxs(V,{size:"",children:[e.jsx("button",{onClick:()=>C(t.code),className:"group text-center dark-black !hover:text-red-700 px-2 py-2 text-base font-medium opacity-65 hover:opacity-100 hover:bg-red-100 transition-all delay-150 ease-in-out flex gap-2 items-center rounded-md",children:e.jsx(re,{className:"text-[#b9bfe2] group-hover:text-red-500 transition-all ease-in-out delay-150"})}),g=="nurse"?e.jsx("button",{onClick:()=>{h()},className:"group text-center text-blue-200 !hover:text-red-700 px-2 py-2 text-base font-medium opacity-65 hover:opacity-100 hover:bg-slate-200 transition-all delay-100 ease-in-out flex gap-2 items-center rounded-md",children:e.jsx(ie,{className:"text-[#b9bfe2] group-hover:text-primary transition-all ease-in-out delay-150"})}):null]}),e.jsx(U,{item:t,getlist:n==null?void 0:n.getlist,role:g,modalOPen:c,setModalOpen:m,isEditMode:!0}),e.jsx(L,{role:g,onDelete:()=>i(),modalOPen:p,setModalOpen:a,title:`Are you sure to delete this ${d==null?void 0:d[t==null?void 0:t.role]} account? This`,title2:"process CAN’T be undo."})]})},ce=x=>{const[t,s]=l.useState([]),p=[{title:"Sales Agent Name",render:n=>e.jsxs("span",{className:"text-[14px] xl:text-base px-[11px] font-normal text-text-secondary",children:[n==null?void 0:n.name," ",n==null?void 0:n.last_name]})},{title:"Agent Code",render:n=>e.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary",children:n==null?void 0:n.agent_id})},{title:"Action",key:"action",width:150,align:"center",render:n=>e.jsx($,{data:n})}],a=[{title:"Nurse Name",render:n=>e.jsx("span",{className:"text-[14px] xl:text-base px-[11px] font-normal text-text-secondary",children:n.name+" "+n.last_name})},{title:"Nurse E-mail",render:n=>e.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary",children:n.email})},{title:"Phone Number",render:n=>e.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary",children:n.contact_number})},{title:"Action",key:"action",width:150,align:"center",render:n=>e.jsx($,{data:n})}];return l.useEffect(()=>{x==="office"?s(p):x==="nursing_home"&&s(a)},[x]),t},{Option:ue}=z;function xe({modalOPen:x,setModalOpen:t,data:s}){const[p,a]=l.useState(null),[n,d]=l.useState([]),[g,f]=l.useState(!1),[c,m]=l.useState(!1),[C,h]=l.useState([]),[i,u]=l.useState([]),b=l.useContext(A),[_,D]=l.useState(""),[k,E]=l.useState([]),[P,j]=l.useState(!0);v.get("user");const w=ce(s==null?void 0:s.role),M=o=>{d(o)},S=async()=>{f(!0)},T=()=>{(s==null?void 0:s.role)=="office"?se({parent_id:s==null?void 0:s._id,child_ids:n}).then(o=>{setTimeout(()=>{y.custom(r=>e.jsx(N,{t:r,text:o.message}))},900),d([]),b==null||b.getlist(),t(!1)}):m(!0)},H=i.filter(o=>{const r=_.toLowerCase();return o.name.toLowerCase().includes(r)||o._id.toLowerCase().includes(r)});async function G(){const o=await ne(s==null?void 0:s._id).then(r=>{var R,B;return(B=(R=r==null?void 0:r.data)==null?void 0:R.hierarchy)==null?void 0:B.distributor_id}).catch(r=>(console.log(r),""));await le({distributor_id:o,available:!0}).then(r=>{u(r==null?void 0:r.data)}).catch(r=>{console.log(r)})}l.useEffect(()=>{w&&E(w)},[w]);function O(){j(!0),(s==null?void 0:s.role)=="office"?(a("Manage Sales Agents"),I(s==null?void 0:s._id,{role:"sales_agent"}).then(o=>{var r;o&&h((r=o==null?void 0:o.data)==null?void 0:r.users)}).finally(o=>{j(!1)})):(s==null?void 0:s.role)=="nursing_home"&&(a("Manage Nurses"),I(s==null?void 0:s._id,{role:"nurse"}).then(o=>{var r;o&&h((r=o==null?void 0:o.data)==null?void 0:r.users)}).finally(o=>{j(!1)}))}return l.useEffect(()=>{x&&(O(),s.role=="office"&&G())},[x,g]),e.jsxs(e.Fragment,{children:[e.jsx(F,{modalOPen:x,setModalOpen:t,width:800,title:p,isBottomButtomShow:!1,customPadding:10,children:e.jsx("div",{className:"pt-4",children:e.jsxs(X,{theme:{token:{fontFamily:"Baloo2",colorPrimary:"#8086AC",colorLinkActive:"#8086AC",colorLinkHover:"#8086AC",colorLink:"#8086AC"}},children:[e.jsxs("div",{id:"addSalesAgent",className:"flex gap-4 mb-5 px-9 justify-between items-center",children:[(s==null?void 0:s.role)=="nursing_home"?e.jsx("h2",{className:"text-xl font-bold text-primary",children:"Add Or Delete Nurse"}):e.jsx(z,{mode:"multiple",maxTagCount:"responsive",optionFontSize:18,optionHeight:50,placeholder:(s==null?void 0:s.role)=="office"?"Search by Sales Agent Name or Code":"Search Installer Name",value:n,onChange:M,onSearch:o=>D(o),style:{width:"100%",borderRadius:"13px"},filterOption:!1,className:"agentSelection h-[40px]",children:H.map(o=>e.jsx(ue,{value:o._id,children:`${o.name} - ${o.agent_id}`},o._id))}),e.jsxs(Y,{onClick:()=>T(),disabled:(s==null?void 0:s.role)=="nursing_home"?!1:n.length==0,className:" w-fit text-nowrap",children:[e.jsx(ee,{size:20,className:"mr-2"})," ",(s==null?void 0:s.role)=="nursing_home"?"Add New Nurse":"Add Selected User"]})]}),e.jsx(A.Provider,{value:{getlist:O},children:e.jsx(te,{loading:P,tableData:C,columns:k,scroll:{x:500,y:500}})})]})})}),e.jsx(U,{getlist:O,role:"nurse",modalOPen:c,setModalOpen:m,parentID:s==null?void 0:s._id}),e.jsx(L,{onDelete:()=>S(),modalOPen:g,setModalOpen:f,title:"Are you sure to remove this Sales Agent",title2:"from this office?"})]})}const ge=x=>{const{data:t,handleEmitEvet:s}=x,[p,a]=l.useState(!1),[n,d]=l.useState(!1),[g,f]=l.useState(!1),[c,m]=l.useState(!1),[C,h]=l.useState(!1),i=l.useContext(A),{rolesFormatter:u}=l.useContext(q),[b,_]=l.useState(t==null?void 0:t.role);l.useState(v.get("role"));const D=S=>{h(S)},k=()=>{_(t.role),f(!0),h(!1)},E=()=>{s?s(t):(a(!0),h(!1))};function P(){m(!0),h(!1)}const j=e.jsxs("div",{className:" w-fit p-2",children:[(t==null?void 0:t.role)==="office"||(t==null?void 0:t.role)==="nursing_home"?e.jsxs("button",{onClick:P,className:" text-sm flex  w-full items-start rounded-[10px] font-medium text-light-black hover:bg-primary/10 hover:text-[#252F67] py-3 px-5",children:[" ","Manage ",(t==null?void 0:t.role)==="nursing_home"?"Nurses":"Sales Agents"]}):null,e.jsx("button",{onClick:()=>{E()},className:" text-sm w-full items-start rounded-[10px] font-medium text-light-black hover:bg-primary/10 hover:text-[#252F67] flex  py-3 px-5",children:"Edit Details"}),(t==null?void 0:t.role)==="Elderly"?null:e.jsxs("button",{onClick:()=>{d(!0),h(!1)},className:" text-sm flex  w-full items-start rounded-[10px] font-medium text-light-black hover:bg-primary/10 hover:text-[#252F67] py-3 px-5",children:[" ","Reset password"]}),e.jsxs("button",{onClick:()=>{k()},className:" text-sm w-full flex  items-start rounded-[10px] font-medium text-light-black hover:bg-danger/10 hover:text-danger py-3 px-5",children:["Delete ",u==null?void 0:u[t==null?void 0:t.role]]})]}),w=async()=>{await Z(t._id).then(S=>{S&&(console.log(S),setTimeout(()=>{y.custom(T=>e.jsx(N,{t:T,text:S.message}))},900),i==null||i.getlist())})},M=async()=>{console.log("Triggered The Disable Function")};return e.jsxs(e.Fragment,{children:[e.jsx("div",{children:e.jsx("div",{children:e.jsx(oe,{open:C,onOpenChange:D,content:j,placement:"leftTop",trigger:"click",children:e.jsx("button",{className:" hover:bg-primary/10 rounded-full w-[40px] h-[40px] flex items-center justify-center",children:e.jsx("span",{dangerouslySetInnerHTML:{__html:`<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 22 22" fill="none">
<path d="M11 4.875C11.3452 4.875 11.625 5.15482 11.625 5.5C11.625 5.84518 11.3452 6.125 11 6.125C10.6548 6.125 10.375 5.84518 10.375 5.5C10.375 5.15482 10.6548 4.875 11 4.875ZM11 10.375C11.3452 10.375 11.625 10.6548 11.625 11C11.625 11.3452 11.3452 11.625 11 11.625C10.6548 11.625 10.375 11.3452 10.375 11C10.375 10.6548 10.6548 10.375 11 10.375ZM11 15.875C11.3452 15.875 11.625 16.1548 11.625 16.5C11.625 16.8452 11.3452 17.125 11 17.125C10.6548 17.125 10.375 16.8452 10.375 16.5C10.375 16.1548 10.6548 15.875 11 15.875Z" fill="#666D90" stroke="#666D90" stroke-width="1.5"/>
</svg>`}})})})})}),e.jsx(U,{item:t,getlist:i==null?void 0:i.getlist,role:i==null?void 0:i.role,modalOPen:p,setModalOpen:a,isEditMode:p}),e.jsx(ae,{item:t,getlist:i==null?void 0:i.getlist,modalOPen:n,setModalOpen:d}),e.jsx(L,{role:b,onOfficeDisable:()=>M(),onDelete:()=>w(),modalOPen:g,setModalOpen:f,title:`Are you sure to delete this ${u==null?void 0:u[t==null?void 0:t.role]} account? This`,title2:"process CAN’T be undo."}),e.jsx(xe,{modalOPen:c,setModalOpen:m,data:t})]})};export{ge as A};
