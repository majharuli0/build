import{O,g as D,r as y,$ as Y,d as p,j as E,bv as C}from"./index-DQy7c-QQ.js";import{E as w}from"./index-DHtzzFS9.js";var $={exports:{}};(function(o,c){(function(a,s){o.exports=s()})(O,function(){return function(a,s){s.prototype.isSameOrAfter=function(n,i){return this.isSame(n,i)||this.isAfter(n,i)}}})})($);var N=$.exports;const k=D(N);var b={exports:{}};(function(o,c){(function(a,s){o.exports=s()})(O,function(){return function(a,s){s.prototype.isSameOrBefore=function(n,i){return this.isSame(n,i)||this.isBefore(n,i)}}})})(b);var R=b.exports;const V=D(R);p.extend(k);p.extend(V);function L({data:o,fromDate:c,toDate:a,valueType:s="duration"}){console.log(o,c,a,s);const[n,i]=y.useState([]),{sleepEventsType:A,sleepEventsColor:g}=y.useContext(Y);y.useEffect(()=>{i(Array.isArray(o)?o:[])},[o]);const v=(x,l)=>{if(l==="duration"){const d=Math.floor(x/60),h=x%60;return`${d}hr ${h}m`}return x.toString()},j=y.useMemo(()=>{const l=((e,t)=>{const r=[];let u=p(e);const f=p(t);for(;u.isSameOrBefore(f);)r.push(u.format("YYYY-MM-DD")),u=u.add(1,"day");return r})(c,a);console.log("All Dates:",l);const d=(Array.isArray(n)?n:[]).reduce((e,t)=>{if(!(t!=null&&t.date)||!(t!=null&&t.data))return e;const r=p(t.date).format("YYYY-MM-DD");return e[r]=t.data,e},{});console.log("Data By Date:",d);const h=[...new Set((Array.isArray(n)?n:[]).flatMap(e=>{var t;return((t=e==null?void 0:e.data)==null?void 0:t.map(r=>r.status))||[]}))];console.log("Active Statuses:",h);const S=Object.entries(A).filter(([e])=>h.includes(e));console.log("Active Events:",S);const B=S.map(([e,t])=>{const r=l.map(u=>{const f=d[u],m=f==null?void 0:f.find(M=>M.status===e);return m?Number(m.value):0});return console.log(`Series data for ${t}:`,r),{name:t,type:"bar",stack:"total",data:r,itemStyle:{color:g[t]}}});return{tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:e=>{let t=`${e[0].axisValue}<br/>`;return e.forEach(r=>{r.value>0&&(t+=`${r.marker} ${r.seriesName}: ${v(r.value,s)}<br/>`)}),t}},legend:{data:S.map(([e,t])=>t)},xAxis:{type:"category",data:l},yAxis:{type:"value",axisLabel:{formatter:e=>v(e,s)}},series:B}},[n,c,a,A,g,s]);return(o==null?void 0:o.length)===0||!a||!c?E.jsx(C,{description:"No data available to show"}):E.jsx(w,{option:j,style:{height:"350px"}})}export{L as default};
