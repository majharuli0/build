const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DataAnalysis-21e1FhVa.js","assets/index-CH_40pe4.js","assets/index-DkeXl02D.css","assets/LargeTextViewerModal-B0gwcUpx.js","assets/MoonFilled-BR1Y_UDh.js","assets/barChart-C7LulpBD.js","assets/index-NiEZgb1K.js","assets/helper-DiiBu3B1.js","assets/multibarChart-BJWO6YnX.js","assets/TimelineGraph-BZHz6d0W.js","assets/TimelineBar-D07j3V9V.js","assets/LiveRateChart-DIMlK9RO.js","assets/RateChart-Cd2PBFZu.js","assets/DayRateChart-D8UJxsza.js","assets/scatterChart-D_DP9PxS.js"])))=>i.map(i=>d[i]);
import{z as w,bH as M,r as j,a1 as ie,j as i,M as oe,a3 as Q,d as V,aI as ce,ee as de}from"./index-CH_40pe4.js";import{W as fe}from"./WeeklyMonthlyPicker-DJ_ZE9wi.js";import{l as F,k as re,j as he}from"./helper-DiiBu3B1.js";try{let f=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},h=new f.Error().stack;h&&(f._sentryDebugIds=f._sentryDebugIds||{},f._sentryDebugIds[h]="94f4d50d-b7cf-4030-922d-0b4f73d7be47",f._sentryDebugIdIdentifier="sentry-dbid-94f4d50d-b7cf-4030-922d-0b4f73d7be47")}catch{}const xe=()=>Array.from({length:12},(f,h)=>({date:`2023-10-${String(h*2+1).padStart(2,"0")}`,value:Math.floor(Math.random()*100)+1})),_e=()=>Array.from({length:12},(f,h)=>({date:`2023-10-${String(h*2+2).padStart(2,"0")}`,value:Math.floor(Math.random()*100)+1})),ve=()=>Array.from({length:12},(f,h)=>({date:`2023-10-${String(h*2+1).padStart(2,"0")}`,value:Math.floor(Math.random()*180)+1}));xe();_e();ve();function ue(f,h){return typeof f!="function"?(console.error("apiFunction is not a function or is undefined"),Promise.reject(new Error("apiFunction is not a function"))):f(h).then(b=>(console.log("API Response:",b),b)).catch(b=>{throw console.error("API Request Error:",b),b})}w.lazy(()=>M(()=>import("./DataAnalysis-21e1FhVa.js"),__vite__mapDeps([0,1,2,3,4])));const ge=w.lazy(()=>M(()=>import("./barChart-C7LulpBD.js"),__vite__mapDeps([5,1,2,6,7]))),J=w.lazy(()=>M(()=>import("./multibarChart-BJWO6YnX.js"),__vite__mapDeps([8,1,2,6]))),De=w.lazy(()=>M(()=>import("./TimelineGraph-BZHz6d0W.js"),__vite__mapDeps([9,1,2,6]))),be=w.lazy(()=>M(()=>import("./TimelineBar-D07j3V9V.js"),__vite__mapDeps([10,1,2,6])));w.lazy(()=>M(()=>import("./LiveRateChart-DIMlK9RO.js"),__vite__mapDeps([11,1,2,6])));const Ee=w.lazy(()=>M(()=>import("./RateChart-Cd2PBFZu.js"),__vite__mapDeps([12,1,2,6]))),Te=w.lazy(()=>M(()=>import("./DayRateChart-D8UJxsza.js"),__vite__mapDeps([13,1,2,6]))),Se=w.lazy(()=>M(()=>import("./scatterChart-D_DP9PxS.js"),__vite__mapDeps([14,1,2,6]))),{RangePicker:je,DatePicker:ke}=Q;function K(f){const[h,b,e]=f.split(":").map(Number);return h*60+b+e/60}function Re({visible:f,onClose:h,modalData:b,summaryProps:e}){var W;const[x,I]=j.useState(""),[_,s]=j.useState(""),[A,N]=j.useState(null),[D,C]=j.useState([]),[R,z]=j.useState([]),[L,O]=j.useState([]),{sleepEventsType:B,sleepEventsColor:$}=j.useContext(ie);function X(t){I(t.end),s(t.start),N("weeklyMonthly")}function Z(t,n){I(n[1]||""),s(n[0]||""),N("range")}function p(t,n){I(null),s(n||""),N("day"),console.log("dateString =============>",R)}function Y(t){return t.map(({date:n,events:l})=>{const o=l.reduce((r,{event_type:E})=>(r[E]=(r[E]||0)+1,r),{}),a=Object.entries(o).map(([r,E])=>({name:B[r],value:`${E}`,status:r,color:$[r]}));return{date:n,data:a}})}function y(t){return Array.isArray(t)?t.map(l=>{var a;const o=((a=l.sleep_index_common_list)==null?void 0:a.reduce((r,E)=>{const k=Number(E==null?void 0:E.value)||0;return r+k},0))||"0";return{date:(l==null?void 0:l.date)||null,bed_exit_duration:o}}):(console.error("Invalid data format: Expected an array."),[])}function m(t){return t.map(l=>{const o=l.sleep_index_common_list.reduce((a,r)=>a+parseInt(r.value,10),0);return{date:l.date,totalFallAsleepDuration:o}})}function P(t){const n=[];return t==null||t.forEach(l=>{var a;const o=l.date;(a=l==null?void 0:l.events)==null||a.forEach(r=>{if(r.event_type===14||r.event_type===15){const E=n.find(k=>k.date===o);E?E.anomalyHeartRate+=1:n.push({date:o,anomalyHeartRate:1})}})}),n}function ee(t){const n=[];return t==null||t.forEach(l=>{const a={date:l.date,data:[]};l.still_time!==void 0&&a.data.push({name:"still_time",value:l.still_time,status:"30"}),l.walk_duration!==void 0&&a.data.push({name:"walking_duration",value:K(l.walk_duration),status:"31"}),l.other_duration!==void 0&&a.data.push({name:"other_duration",value:K(l.other_duration),status:"32"}),n.push(a)}),console.log(n),n}function te(t){var l,o,a,r,E,k,q,G;let n=[];if(t||O([]),(e==null?void 0:e.title)==="Breath Rate Summary"||(e==null?void 0:e.title)==="Heart Rate Summary")!x&&((l=t[0])!=null&&l.avg)&&(n=[{name:"Avg. Breath Rate",value:(o=t[0])==null?void 0:o.avg},{name:"Min. Breath Rate",value:(a=t[0])==null?void 0:a.min},{name:"Max. Breath Rate",value:(r=t[0])==null?void 0:r.max}]);else if((e==null?void 0:e.title)==="Sleep Timeline Summary")if((E=t[0])!=null&&E.statistical_data&&_&&x==null){const g=(k=t[0])==null?void 0:k.statistical_data.reduce((v,d)=>{const c=new Date(d.start_time),S=(new Date(d.end_time)-c)/(1e3*60),u=B[d.status];return v[u]||(v[u]={duration:0}),v[u].duration+=S,v},{});n=Object.entries(g).map(([v,{duration:d}])=>{const c=Math.floor(d/60),T=Math.floor(d%60);return{name:v,value:`${c}hr ${T}m`}})}else{const g={},v=t.map(d=>({data:d.sleep_index_common_list,date:d.date}));v==null||v.forEach(d=>{var c;(c=d==null?void 0:d.data)==null||c.forEach(({name:T,value:S,status:u,ratio:ae})=>{g[u]||(g[u]={name:`Avg. ${B[u]}`,totalValue:0,totalRatio:0,count:0}),g[u].totalValue+=parseInt(S),g[u].totalRatio+=ae,g[u].count+=1})}),n=Object.entries(g).map(([d,c])=>{const T=Math.round(c.totalValue/c.count),S=Math.floor(T/60),u=T%60;return{name:c.name,value:`${S}hr ${u}m`,ratio:Math.round(c.totalRatio/c.count)}})}else if((e==null?void 0:e.title)==="Sleep Events Summary")if((q=t[0])!=null&&q.events&&_&&x==null){const g=(G=t[0])==null?void 0:G.events.reduce((v,d)=>{const c=B[d.event_type],T=v.find(S=>S.name===c);if(T){const S=parseInt(T.value.replace("x",""));T.value=`${S+1}x`}else v.push({name:c,value:"1x",color:$[c]});return v},[]);console.log("alarmEventCounts =============>",g),n=g}else{const g={},v=Y(t);v==null||v.forEach(d=>{var c;(c=d==null?void 0:d.data)==null||c.forEach(({name:T,value:S,status:u})=>{g[u]||(g[u]={name:`Avg. ${B[u]}`,totalValue:0,count:0}),g[u].totalValue+=parseInt(S),g[u].count+=1})}),n=Object.entries(g).map(([d,c])=>{const T=Math.round(c.totalValue/c.count);return{name:c.name,value:`${T}x`}})}return O(n),n}function H(t){if(t||C([]),(e==null?void 0:e.title)==="Sleep Timeline Summary")if(_&&x){const n=t.map(l=>({data:l.sleep_index_common_list,date:l.date}));C(n)}else C(t[0]),console.log("chartData =============>",t);else if((e==null?void 0:e.title)==="Sleep Events Summary"){const n=Y(t);C(n)}else if((e==null?void 0:e.title)==="Breath Rate Summary"||(e==null?void 0:e.title)==="Heart Rate Summary"){if(x&&_){const n={xdata:t.map(l=>l.date),maxArray:t.map(l=>l.max),minArray:t.map(l=>l.min),allAvgNumber:Math.round(t.reduce((l,o)=>l+o.avg,0)/t.length)};C(n)}}else{if((e==null?void 0:e.title)==="Bed Exit Duration Statistic Summary")return y(t);if((e==null?void 0:e.title)==="Time to Fall Asleep Statistic Summary")return m(t);if((e==null?void 0:e.title)==="Heart Rate Anomaly Statistic Summary")return P(t);if((e==null?void 0:e.title)==="Duration Spent In Room Summary"){const n=ee(t);C(n)}}return t}j.useEffect(()=>{console.log("================================ api called inti",e==null?void 0:e.title)},[e==null?void 0:e.title]),j.useEffect(()=>{async function t(){var n,l,o;if((n=e==null?void 0:e.apisProps)!=null&&n.endpoint)try{const a=await ue((l=e==null?void 0:e.apisProps)==null?void 0:l.endpoint,{...(o=e==null?void 0:e.apisProps)==null?void 0:o.query,from_date:x,to_date:_});a&&(a!=null&&a.data)&&(z(H(a==null?void 0:a.data)),te(a==null?void 0:a.data),H(a==null?void 0:a.data))}catch(a){console.error("Error fetching summary data:",a),z([])}}t()},[(W=e==null?void 0:e.apisProps)==null?void 0:W.endpoint,x,_]);const ne=()=>{var t;return(t=e==null?void 0:e.pickerTypes)==null?void 0:t.map(n=>{switch(n){case"weeklyMonthly":return i.jsx(fe,{placeholder:"Weekly/Monthly",style:{width:"140px",borderRadius:"10px"},handleChnage:X,value:A==="weeklyMonthly"&&_&&x?{start:_,end:x}:null},"weeklyMonthly");case"range":return i.jsx(je,{showTime:!1,style:{width:"200px",borderRadius:"10px"},size:"large",placeholder:["Pick Data Range (Start)","End"],format:"YYYY-MM-DD",onChange:(l,o)=>Z(l,o),value:A==="range"&&x&&_?[V(_),V(x)]:null,allowClear:!0},"range");case"day":return i.jsx(Q,{style:{width:"200px",borderRadius:"10px"},size:"large",format:"YYYY-MM-DD",onChange:(l,o)=>p(l,o),value:A==="day"&&_?V(_):null,allowClear:!0},"day");default:return null}})},U={multibar:{default:{component:J,getProps:()=>({data:D,toDate:x,fromDate:_,valueType:e==null?void 0:e.dataType})},day:{component:De,getProps:()=>({statisticalData:D==null?void 0:D.statistical_data,enterBedTime:F(D==null?void 0:D.get_bed_idx),getupAfterTime:F(D==null?void 0:D.leave_bed_idx)})}},multibar_sleep_events:{default:{component:J,getProps:()=>({data:D,toDate:x,fromDate:_,valueType:e==null?void 0:e.dataType})},day:{component:be,getProps:()=>{var t,n,l;return{alarmEvents:(t=R[0])==null?void 0:t.events,enterBedTime:F((n=R[0])==null?void 0:n.get_bed_idx),getupAfterTime:F((l=R[0])==null?void 0:l.leave_bed_idx)}}}},bar:{default:{component:ge,getProps:()=>({data:R,dataType:e==null?void 0:e.dataType,color:e==null?void 0:e.color,xUnit:e==null?void 0:e.xUnit,toDate:e!=null&&e.isFromToDate?x:"",fromDate:e!=null&&e.isFromToDate?_:"",numberLimit:e==null?void 0:e.numberLimit,dataUnit:e==null?void 0:e.dataUnit,chartFor:e==null?void 0:e.chartFor})}},rate:{default:{component:Ee,getProps:()=>({cheartInfo:D,color:e==null?void 0:e.color,dateType:"Month",fromDate:_,toDate:x})},day:{component:Te,getProps:()=>{var t,n;return{data:((t=R[0])==null?void 0:t.data_list)||[],timestamp:((n=R[0])==null?void 0:n.timestamps)||[],color:e==null?void 0:e.color,type:e==null?void 0:e.dataType}}}},scatter:{default:{component:Se,getProps:()=>({data:(e==null?void 0:e.title)!=="Distribution of bed exit times Summary"?re(R):he(R),colors:{gotobed:"#2EC7C9",wakeup:"#5AB1EF",getup:"#FFB980",fallasleep:"#B6A2DE",bedexit:"#508C9B"}})}}},le=()=>{var a,r;const t=e==null?void 0:e.chartType,n=((a=U[t])==null?void 0:a[A])||((r=U[t])==null?void 0:r.default);if(!n)return null;const{component:l,getProps:o}=n;return i.jsx(j.Suspense,{fallback:i.jsx("div",{children:"Loading..."}),children:i.jsx(l,{...o()})})};return i.jsx(oe,{open:f,onCancel:h,footer:null,width:"100%",style:{height:"100vh",padding:0,borderRadius:0,top:0},className:"!rounded-none summaryModal !h-[100vh] overflow-hidden",children:i.jsxs("div",{className:"p-4 h-[100vh]",children:[i.jsxs("div",{className:"flex flex-col justify-center items-center mb-4 gap-2",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary",children:e==null?void 0:e.title}),i.jsx("div",{id:"DatePickers",className:"flex gap-4 items-center justify-center mt-4",children:ne()})]}),L.length>0&&i.jsx("div",{id:"chartTotal",className:"flex w-full items-center justify-center border-b mt-12",children:L.map((t,n,l)=>i.jsx(we,{label:t.name,value:t.value,isFirst:n===0,isLast:n===l.length-1},n))}),i.jsx("div",{className:"report-content max-h-[350px]  w-[90%] mt-16 mx-auto",children:le()})]})})}const we=({label:f,value:h,isFirst:b,isLast:e})=>i.jsxs("div",{id:"totalItem",className:`max-w-[160px] w-full border p-1 flex items-center justify-center border-b-0 flex-col ${b&&e?"rounded-tl-xl rounded-tr-xl":b?"rounded-tl-xl":e?"rounded-tr-xl":""}`,children:[i.jsx("h1",{className:"text-2xl font-bold text-primary",children:h}),i.jsx("span",{className:"text-sm font-medium opacity-80 text-primary",children:f})]});function Ie({children:f,title:h,color:b,icon:e,dataAnalysis:x,isDataAnalysis:I=!0,isSummaryBtn:_=!0,summaryProps:s,headerClassName:A}){const[N,D]=j.useState(!1);return i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex flex-col gap-6 p-6 bg-white rounded-2xl !w-full h-full ",children:[i.jsxs("div",{id:"header",className:"flex justify-between items-center w-full",children:[i.jsx("h1",{className:`text-[21px] font-bold text-primary ${A}`,children:h}),_&&i.jsx(ce,{onClick:()=>D(!0),icon:i.jsx(de,{}),size:"large",children:"Summary"})]}),i.jsx("div",{className:"h-full",children:f}),I&&x!==""&&i.jsxs("div",{id:"footer",className:"flex gap-3 items-center p-2 px-3",children:[i.jsx("div",{id:"icon",style:{color:"white",fontSize:"20px",backgroundColor:b},className:"p-2 rounded-full",children:e}),i.jsx("span",{className:"text-[15px] capitalize",children:x})]})]}),i.jsx(Re,{visible:N,onClose:()=>D(!1),summaryProps:{...s,color:b,icon:e}})]})}export{Ie as T};
//# sourceMappingURL=Template-CRn_2iTx.js.map
