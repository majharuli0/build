import{r as a,a6 as f,j as e,eA as y,ay as N,eB as C,aD as S,az as _,eC as R,_ as m,aY as w,aN as A,eD as I}from"./index-CobdpRh7.js";function v({record:t}){const[s,n]=a.useState(!1),o=()=>n(!1),[l,x]=a.useState(!1),[c,i]=a.useState(""),[h,k]=a.useState(t.total),[b,p]=a.useState(""),g=a.useContext(f);console.log(t);const j=u=>{u.preventDefault();let r;l?r=c:r=h,console.log(r),R(t==null?void 0:t.transaction_id,{amount:Number(r)}).then(d=>{console.log(d),n(!1),g.getList(),m.success("Refund request sent successfully")}).catch(d=>{console.log(d),m.error("Something went wrong, Please try again or Try From Stripe Dashboard")})};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-2 hover:bg-gray-100 p-2 rounded-lg hover:text-primary",children:[e.jsx(y,{size:25}),e.jsx("span",{className:"text-base font-medium",children:"Refund"})]}),e.jsx(N,{modalOPen:s,setModalOpen:n,onclose:o,buttonText:"Confirm Refund",handleSubmit:j,title:"Refund",children:e.jsxs("div",{children:[e.jsxs("div",{id:"note",className:"text-yellow-600 bg-yellow-50/50 rounded-lg p-3 flex flex-col items-start gap-2",children:[e.jsx(C,{className:"text-yellow-600 text-2xl"}),e.jsxs("p",{className:"text-[14px] xl:text-base font-normal  ",children:["Refunds can take ",e.jsx("b",{children:"up to 10 business days"})," to appear in a customer's account. You can check the status of a refund on the Transaction page or the Payments tab of The Stripe Dashboard."]})]}),e.jsxs("ul",{className:"list-none list-inside flex flex-col gap-2 mt-3",children:[e.jsxs("li",{className:"text-[16px] xl:text-base font-normal flex items-center gap-2",children:["Transaction ID:"," ",e.jsx("span",{className:"font-bold",children:t.transaction_id})]}),e.jsxs("li",{className:"text-[16px] xl:text-base font-normal flex items-center gap-2",children:["Amount: ",e.jsxs("span",{className:"font-bold",children:["$",t.total]}),e.jsx(S,{checked:l,onChange:()=>x(!l),children:"Custom amount"})]})]}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsx(_,{placeholder:"Enter custom amount",type:"number",disabled:!l,register:{value:c,onChange:u=>{const r=u.target.value,d=parseFloat(r);r===""||d<=t.total?(i(r),p("")):p("Custom amount must be less than or equal to the total amount.")}},error:{type:"required",message:b}})})]})})]})}const D=({transactionId:t})=>{const[s,n]=a.useState(!1),o=()=>{navigator.clipboard.writeText(t),n(!0),setTimeout(()=>n(!1),2e3)};return e.jsx(w,{title:s?"Copied!":"Click to copy",children:e.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap cursor-pointer",onClick:o,children:t})})},T=[{title:"Action",render:t=>e.jsx(v,{record:t})},{title:"Transaction ID",render:t=>e.jsx(D,{transactionId:t.transaction_id})},{title:"Office Identifier",render:t=>e.jsx("button",{children:e.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:t.office_name})})},{title:"Agent Name (ID Number)",render:t=>e.jsx("button",{children:e.jsxs("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:[t.agent_name," (",t.agent_unique_id,")"]})})},{title:"Date of Sales",render:t=>{const s=new Date(t.created_at).toLocaleDateString("en-CA");return e.jsx("button",{children:e.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:s})})}},{title:"Product Name",render:t=>e.jsx("button",{children:e.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary flex flex-col gap-2",children:t.products.filter((s,n,o)=>s.type!=="Seenyor Kit"||o.findIndex(l=>l.type==="Seenyor Kit")===n).map((s,n)=>["Seenyor Kit","Installation"].includes(s.type)&&n<2&&e.jsx("span",{children:s.type},n))})})},{title:"Product Price",render:t=>e.jsx("button",{children:e.jsxs("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary",children:["$",t.products.filter(s=>["Seenyor Kit","Installation","AI Monitoring"].includes(s.type)).reduce((s,n)=>s+n.price,0).toFixed(2)]})})},{title:"Addon Name",render:t=>e.jsx("button",{children:e.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary flex flex-col gap-2",children:t.products.map((s,n)=>!["Seenyor Kit","Installation","AI Monitoring"].includes(s.type)&&e.jsx("span",{children:s.type},n))})})},{title:"Addon Price",render:t=>e.jsx("button",{children:e.jsx("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:t.products.map((s,n)=>!["Seenyor Kit","Installation","AI Monitoring"].includes(s.type)&&e.jsxs("span",{children:["$",s.price.toFixed(2)]},n))})})},{title:"Total Price",render:t=>e.jsx("button",{children:e.jsxs("span",{className:"text-[14px] xl:text-base font-normal text-text-secondary text-nowrap",children:["$",t.total.toFixed(2)]})})},{title:"Installation Status",render:t=>{let s;switch(t.installation_status){case"not_started":s="bg-[#5d5d5d]";break;case"pending":s="bg-[#833af1]";break;case"completed":s="bg-[#36b610]";break;default:s="bg-black"}const n={not_started:"Not Started",pending:"Pending",completed:"Completed"};return e.jsx("button",{children:e.jsx("span",{className:`text-[14px] xl:text-base capitalize font-normal text-white p-2 px-3 py-1 ${s} rounded-lg`,children:n[t.installation_status]})})}}];function q(){const[t,s]=a.useState([]),[n,o]=a.useState(!1),[l,x]=a.useState({});function c(){o(!0),I({payment_status:"pending",is_refund_requested:!0,...l}).then(i=>{s(i),console.log(i==null?void 0:i.data),o(!1)})}return a.useEffect(()=>{c()},[l]),e.jsx(e.Fragment,{children:e.jsxs("div",{id:"refunds_request",className:"w-full flex flex-col gap-4 justify-center items-center bg-white rounded-2xl p-6 mt-6",children:[e.jsx("div",{id:"Recently_Closed_Alerts_Header",className:"w-full flex justify-between",children:e.jsx("h1",{className:"text-[24px] font-bold text-primary",children:"All Request"})}),e.jsx(f.Provider,{value:{total:t==null?void 0:t.total,page:l,SetPage:x,getList:c},children:e.jsx(A,{loading:n,columns:T,tableData:t==null?void 0:t.data})})]})})}export{q as default};
