import{r as n,a1 as L,j as i,bt as _}from"./index-C6ihtOFT.js";import{E as k}from"./index-BKCtKaZg.js";const A=({statisticalData:l=[],alarmEvents:T=[],enterBedTime:y,getupAfterTime:b,noDataText:w="No data available to show"})=>{const{sleepEventsType:a,sleepEventsColor:d}=n.useContext(L),r=n.useMemo(()=>[...l.map(e=>({id:`${e.status}-${e.start_time}-${e.end_time}`,name:a[e.status],startTime:new Date(e.start_time),endTime:new Date(e.end_time),color:d[a[e.status]]})),...T.map(e=>({id:`${e.event_type}-${e.ts}`,name:a[e.event_type],startTime:new Date(e.ts),endTime:new Date(e.ts),color:d[a[e.event_type]]}))].filter(e=>e.name),[l,T,a,d]),u=n.useMemo(()=>[...new Set(r.map(e=>e.name))].filter(Boolean),[r]),[o,E]=n.useState(()=>u.reduce((e,t)=>(e[t]=!0,e),{}));n.useEffect(()=>{const e=u.filter(t=>!(t in o));e.length>0&&E(t=>({...t,...e.reduce((s,m)=>({...s,[m]:!0}),{})}))},[u,o]);const S=e=>{E(t=>({...t,[e]:!t[e]}))},h=n.useMemo(()=>r.filter(e=>o[e.name]),[r,o]),$=Math.min(...r.map(e=>e.startTime.getTime())),j=Math.max(...r.map(e=>e.endTime.getTime())),M=n.useMemo(()=>h.map((e,t)=>{const s=e.startTime.getTime()===e.endTime.getTime();return{id:t,name:e.name,value:[e.startTime.getTime(),e.endTime.getTime(),s?15:10],itemStyle:{color:e.color}}}),[h]);if((l==null?void 0:l.length)===0)return i.jsx(_,{description:w});const v={tooltip:{trigger:"item",formatter:e=>{const t=h[e.data.id],s=t.startTime.getTime()===t.endTime.getTime(),m=new Date(t.startTime).toLocaleString();if(s)return`${t.name}<br/>Date & Time: ${m}`;{const c=new Date(t.endTime).toLocaleString(),x=t.endTime-t.startTime,p=Math.floor(x/(1e3*60)),f=Math.floor(p/60),g=p%60,C=f>0?`${f} hour(s) ${g} minute(s)`:`${g} minute(s)`;return`<b>${t.name}</b> <br/>Start: ${m}<br/>End: ${c}<br/>Duration: ${C}`}}},grid:{left:"5%",right:"5%",bottom:"15%",containLabel:!1},xAxis:{type:"time",boundaryGap:!0,min:$,max:j,splitNumber:5,axisLabel:{formatter:e=>new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),interval:0,margin:5},axisTick:{show:!0,alignWithLabel:!0}},yAxis:{show:!1},series:[{name:"Events",type:"custom",renderItem:(e,t)=>{const s=t.coord([t.value(0),0]),m=t.coord([t.value(1),0]),c=t.size([0,t.value(2)])[1],x=Math.max(m[0]-s[0],5),f=e.dataIndex%10*3;e.coordSys.height-c+60-f;const g=e.coordSys.height-c+60;return{type:"rect",shape:{x:s[0],y:g,width:x,height:c},style:{fill:t.style().fill,stroke:"#fff",lineWidth:1}}},encode:{x:[0,1]},data:M}],graphic:y&&b?[{type:"text",left:"5%",bottom:"1%",style:{text:`Enter Bed ${y}`,fontSize:12}},{type:"text",right:"5%",bottom:"1%",style:{text:`Getup After ${b}`,fontSize:12}}]:[]};return i.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 w-full",children:[i.jsx("div",{id:"customLegend",className:"w-full",children:i.jsx("div",{className:"flex flex-wrap gap-4 items-center justify-center",children:u.map(e=>i.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>S(e),children:[i.jsx("div",{id:"legendColorShape",className:"size-3 rounded-[4px] border-2",style:{backgroundColor:o[e]?d[e]:"grey",borderColor:o[e]?"transparent":"#ccc",color:o[e]?"grey":"inherit"}}),i.jsx("div",{children:e})]},e))})}),i.jsx(k,{option:v,style:{height:200,width:"100%"}})]})};export{A as default};
