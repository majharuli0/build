import{r as S,j as w,bu as A}from"./index-Cx2ZnkBC.js";import{E as I}from"./index-BgeVerw7.js";import{f as O}from"./helper-DZks3_Jq.js";function C({data:r,dataType:i,color:h,chartType:m="Day",toDate:y,fromDate:b,xUnit:a="date",hourLimit:_=12,numberLimit:M=100,dataUnit:$="",chartFor:p=""}){const v=S.useMemo(()=>{if(!(r!=null&&r.length))return null;const u=(()=>{if(a==="number"){const t=r.map(s=>s.heart_rate||s.breath_rate),o=Math.min(...t),n=Math.max(...t),e=10,l=Math.max(0,o-e),d=n+e,c=Array.from({length:d-l+1},(s,x)=>l+x),f=new Map(r.map(s=>[s.heart_rate||s.breath_rate,{value:s.percentage,count:s.count}]));return c.map(s=>({number:s,...f.get(s)||{value:0,count:0}}))}else if(a==="hour"){const t=Array.from({length:_},(n,e)=>e);console.log(r);const o=new Map(r.map(n=>[Math.floor(n.sleep_total_time/60),{value:n.sleep_total_time,percentage:n.percentage,count:n.count}]));return t.map(n=>({hour:n,...o.get(n)||{value:0,percentage:0,count:0}}))}else if(a==="percentage"){const t=Array.from({length:11},(n,e)=>e*10),o=new Map(r.map(n=>[Math.floor(n.sleep_efficiency/10)*10,{value:n.sleep_efficiency,date:n.date}]));return t.map(n=>{var e,l;return{percentage:n,value:((e=o.get(n))==null?void 0:e.value)||0,date:((l=o.get(n))==null?void 0:l.date)||null}})}else{const o=((e,l)=>{const d=[],c=new Date(e),f=new Date(l);for(;c<=f;)d.push(new Date(c).toISOString().split("T")[0]),c.setDate(c.getDate()+1);return d})(b,y),n=new Map(r.map(e=>[e.date.split("T")[0],e.ratio||e.walk_speed||e.value||e.sleep_time||e.ahi||e.sleep_efficiency||(e.leave_bed_count&&p==="numberOfBedExitTime"?e.leave_bed_count:null)||(e.sleep_quality&&p!=="numberOfBedExitTime"&&p!=="roomInOut"?e.sleep_quality:null)||(e.entry_exit_count&&p==="roomInOut"?e.entry_exit_count:null)||e.sleep_total_time||e.totalFallAsleepDuration||"--"]));return o.map(e=>({date:e,value:n.get(e)||0}))}})(),D=(t,o="axis")=>{if(a==="percentage"||i==="percentage")return`${t}%`;if(i==="duration"){const n=Math.floor(t/60),e=t%60;return n>0?`${n}h ${e}m`:`${e}m`}return t},g=t=>{if(a==="number")return t.toString();if(a==="hour")return`${t}hr`;if(a==="percentage")return`${t}%`;if(m==="Week"){const n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],e=new Date(t);return n[e.getDay()]}return new Date(t).toLocaleDateString("en-US",{month:"2-digit",day:"2-digit"}).replace("/","-")};return{xAxis:{type:"category",data:u.map(t=>g(a==="hour"?t.hour:a==="percentage"?t.percentage:a==="number"?t.number:t.date))},grid:{top:"5%",left:"8%",bottom:"5%",right:"2%"},yAxis:{type:"value",axisLabel:{formatter:D},max:a==="percentage"||i==="percentage"?100:void 0},series:[{data:u.map(t=>t.value),type:"bar",barWidth:10,itemStyle:{color:h||"#000",borderRadius:[50,50,0,0]}}],tooltip:{trigger:"axis",formatter:t=>{if(a==="number"){const e=u[t[0].dataIndex];return`<div style="margin-top: 4px">
            <span >${e.value}%</span>
            <br>
            <span style="font-weight: bold">${e.number} BPM</span>
            </div>`}else if(a==="hour"){const e=u[t[0].dataIndex];return`<div style="margin-top: 4px">
            ${e.percentage?`<span>${e.percentage}%</span>`:"--"}
            <br>
            <span style="font-weight: bold">${O(e.value)}</span>
                    </div>`}else if(a==="percentage"){const e=u[t[0].dataIndex];if(e.date){const l=new Date(e.date).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-");return`<div style="font-weight: bold">${e.value}%</div>
                     <div style="margin-top: 4px">${l}</div>`}return`<div style="font-weight: bold">${e.percentage}%</div>`}const o=u[t[0].dataIndex].date;return`<div style="font-weight: bold">${new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-")}</div>
                  <div style="margin-top: 4px">${D(t[0].value)}${$}</div>`}}}},[r,i,h,m,b,y,a,_,M]);return!(r!=null&&r.length)||!v?w.jsx(A,{description:"No data available to show"}):w.jsx(I,{option:v,style:{height:"350px"}})}export{C as default};
