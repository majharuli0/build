const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DataAnalysis-LjyKR_OJ.js","assets/index-DKKIrJkr.js","assets/index-BDBncCmo.css","assets/LargeTextViewerModal-DAHquWND.js","assets/MoonFilled-DvS_wD2c.js","assets/barChart-Z4iitIeT.js","assets/index-p85IepaV.js","assets/helper-C_2_l4sE.js","assets/multibarChart-BH61FV6c.js","assets/TimelineGraph-4L0NVfMF.js","assets/TimelineBar-Dwph8pNP.js","assets/LiveRateChart-CGlFvJG6.js","assets/RateChart-B1A8IdlV.js","assets/DayRateChart-CL2fYN5D.js","assets/scatterChart-jQrs4lz8.js"])))=>i.map(i=>d[i]);
import{x as T,bB as S,r as w,$ as oe,j as a,M as ce,F as de,d as B,aF as re,d_ as fe}from"./index-DKKIrJkr.js";import{W as he}from"./WeeklyMonthlyPicker-DmGP_U48.js";import{k as F,j as xe,i as ve}from"./helper-C_2_l4sE.js";import{d as q}from"./index-B3eKfCJC.js";import{D as K}from"./index-nnJyr53O.js";const ge="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M8.04557%208.38702C8.12863%208.38702%208.21169%208.39295%208.28882%208.40482L9.53472%207.15892C9.08975%206.92161%208.58546%206.78516%208.04557%206.78516C6.29539%206.78516%204.87744%208.20904%204.87744%209.95329C4.87744%2011.7035%206.30132%2013.1214%208.04557%2013.1214C9.79576%2013.1214%2011.2137%2011.6975%2011.2137%209.95329C11.2137%209.4134%2011.0773%208.90911%2010.8399%208.46415L9.59404%209.71004C9.60591%209.78717%209.61184%209.87023%209.61184%209.95329C9.61184%2010.8195%208.90584%2011.5255%208.03964%2011.5255C7.17345%2011.5255%206.46744%2010.8195%206.46744%209.95329C6.47337%209.0871%207.17938%208.38702%208.04557%208.38702Z'%20fill='%23333951'/%3e%3cpath%20d='M11.7773%207.53226C12.2341%208.23234%2012.4952%209.06293%2012.4952%209.95286C12.4952%2012.4031%2010.5018%2014.4025%208.04556%2014.4025C5.5953%2014.4025%203.59593%2012.4091%203.59593%209.95286C3.59593%207.5026%205.58936%205.50323%208.04556%205.50323C8.94142%205.50323%209.77201%205.77021%2010.4662%206.22111L11.6171%205.07014C10.6145%204.33446%209.38045%203.90137%208.04556%203.90137C4.71131%203.9073%202%206.61861%202%209.95286C2%2013.293%204.71131%2016.0043%208.04556%2016.0043C11.3798%2016.0043%2014.097%2013.293%2014.097%209.95286C14.097%208.61797%2013.664%207.38394%2012.9283%206.38129L11.7773%207.53226Z'%20fill='%23333951'/%3e%3cpath%20d='M15.983%203.90726C15.9474%203.7886%2015.8466%203.69961%2015.722%203.67588L14.5295%203.46823L14.3218%202.27573C14.2981%202.15114%2014.2091%202.05028%2014.0905%202.01469C13.9718%201.97909%2013.8413%202.00875%2013.7523%202.09774L12.8268%203.02327C12.7615%203.08853%2012.7259%203.17159%2012.7259%203.26058V4.637L7.74232%209.62058C7.57027%209.79263%207.57027%2010.0774%207.74232%2010.2495C7.91437%2010.4215%208.19915%2010.4215%208.3712%2010.2495L13.3548%205.26588H14.7312C14.8202%205.26588%2014.9033%205.23028%2014.9685%205.16502L15.894%204.2395C15.989%204.15644%2016.0246%204.02592%2015.983%203.90726Z'%20fill='%23333951'/%3e%3c/svg%3e",se="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M9%202C5.12667%202%202%205.12667%202%209C2%2012.8733%205.12667%2016%209%2016C12.8733%2016%2016%2012.8733%2016%209C16%205.12667%2012.8733%202%209%202ZM13.1378%209.76222C12.6089%2010.3689%2011.9089%2010.68%2011.0378%2010.68C10.3689%2010.68%209.56%2010.4%208.61111%209.85556C7.92667%209.46667%207.44444%209.23333%207.14889%209.23333C6.37111%209.23333%205.96667%209.77778%205.93556%2010.7111H4.02222C4.05333%209.77778%204.33333%208.84444%204.86222%208.22222C5.39111%207.61556%206.09111%207.30444%206.99333%207.30444C7.69333%207.30444%208.44%207.55333%209.23333%208.02C10.0422%208.50222%2010.6178%208.75111%2010.9289%208.75111C11.2556%208.75111%2011.52%208.62667%2011.7378%208.36222C11.94%208.08222%2012.0644%207.74%2012.0644%207.27333H13.9778C13.9467%208.37778%2013.6667%209.15556%2013.1378%209.76222Z'%20fill='%2334CE9D'/%3e%3c/svg%3e",ue="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20width='16'%20height='16'%20rx='8'%20fill='%23FF9831'/%3e%3cpath%20d='M1%2013H3.33333C5.91062%2013%208%2011.2091%208%209V4'%20stroke='white'%20stroke-width='1.6'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M11%207L8%204L5%207'%20stroke='white'%20stroke-width='1.6'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",_e=()=>Array.from({length:12},(o,u)=>({date:`2023-10-${String(u*2+1).padStart(2,"0")}`,value:Math.floor(Math.random()*100)+1})),Ce=()=>Array.from({length:12},(o,u)=>({date:`2023-10-${String(u*2+2).padStart(2,"0")}`,value:Math.floor(Math.random()*100)+1})),De=()=>Array.from({length:12},(o,u)=>({date:`2023-10-${String(u*2+1).padStart(2,"0")}`,value:Math.floor(Math.random()*180)+1}));_e();Ce();De();function be(o,u){return typeof o!="function"?(console.error("apiFunction is not a function or is undefined"),Promise.reject(new Error("apiFunction is not a function"))):o(u).then(C=>(console.log("API Response:",C),C)).catch(C=>{throw console.error("API Request Error:",C),C})}T.lazy(()=>S(()=>import("./DataAnalysis-LjyKR_OJ.js"),__vite__mapDeps([0,1,2,3,4])));const je=T.lazy(()=>S(()=>import("./barChart-Z4iitIeT.js"),__vite__mapDeps([5,1,2,6,7]))),G=T.lazy(()=>S(()=>import("./multibarChart-BH61FV6c.js"),__vite__mapDeps([8,1,2,6]))),we=T.lazy(()=>S(()=>import("./TimelineGraph-4L0NVfMF.js"),__vite__mapDeps([9,1,2,6]))),Ee=T.lazy(()=>S(()=>import("./TimelineBar-Dwph8pNP.js"),__vite__mapDeps([10,1,2,6])));T.lazy(()=>S(()=>import("./LiveRateChart-CGlFvJG6.js"),__vite__mapDeps([11,1,2,6])));const Te=T.lazy(()=>S(()=>import("./RateChart-B1A8IdlV.js"),__vite__mapDeps([12,1,2,6]))),Se=T.lazy(()=>S(()=>import("./DayRateChart-CL2fYN5D.js"),__vite__mapDeps([13,1,2,6]))),Me=T.lazy(()=>S(()=>import("./scatterChart-jQrs4lz8.js"),__vite__mapDeps([14,1,2,6]))),{RangePicker:Re,DatePicker:ze}=K;function J(o){const[u,C,e]=o.split(":").map(Number);return u*60+C+e/60}function ke({visible:o,onClose:u,modalData:C,summaryProps:e}){var W;const[g,A]=w.useState(""),[h,p]=w.useState(""),[M,N]=w.useState(null),[_,R]=w.useState([]),[E,I]=w.useState([]),[V,z]=w.useState([]),{sleepEventsType:L,sleepEventsColor:$}=w.useContext(oe);function Q(t){A(t.end),p(t.start),N("weeklyMonthly")}function X(t,n){A(n[1]||""),p(n[0]||""),N("range")}function y(t,n){A(null),p(n||""),N("day"),console.log("dateString =============>",E)}function O(t){return t.map(({date:n,events:l})=>{const c=l.reduce((f,{event_type:D})=>(f[D]=(f[D]||0)+1,f),{}),i=Object.entries(c).map(([f,D])=>({name:L[f],value:`${D}`,status:f,color:$[f]}));return{date:n,data:i}})}function m(t){return Array.isArray(t)?t.map(l=>{var i;const c=((i=l.sleep_index_common_list)==null?void 0:i.reduce((f,D)=>{const k=Number(D==null?void 0:D.value)||0;return f+k},0))||"0";return{date:(l==null?void 0:l.date)||null,bed_exit_duration:c}}):(console.error("Invalid data format: Expected an array."),[])}function P(t){return t.map(l=>{const c=l.sleep_index_common_list.reduce((i,f)=>i+parseInt(f.value,10),0);return{date:l.date,totalFallAsleepDuration:c}})}function ee(t){const n=[];return t==null||t.forEach(l=>{var i;const c=l.date;(i=l==null?void 0:l.events)==null||i.forEach(f=>{if(f.event_type===14||f.event_type===15){const D=n.find(k=>k.date===c);D?D.anomalyHeartRate+=1:n.push({date:c,anomalyHeartRate:1})}})}),n}function te(t){const n=[];return t==null||t.forEach(l=>{const i={date:l.date,data:[]};l.still_time!==void 0&&i.data.push({name:"still_time",value:l.still_time,status:"30"}),l.walk_duration!==void 0&&i.data.push({name:"walking_duration",value:J(l.walk_duration),status:"31"}),l.other_duration!==void 0&&i.data.push({name:"other_duration",value:J(l.other_duration),status:"32"}),n.push(i)}),console.log(n),n}function ne(t){var l,c,i,f,D,k,Z,U;let n=[];if(t||z([]),(e==null?void 0:e.title)==="Breath Rate Summary"||(e==null?void 0:e.title)==="Heart Rate Summary")!g&&((l=t[0])!=null&&l.avg)&&(n=[{name:"Avg. Breath Rate",value:(c=t[0])==null?void 0:c.avg},{name:"Min. Breath Rate",value:(i=t[0])==null?void 0:i.min},{name:"Max. Breath Rate",value:(f=t[0])==null?void 0:f.max}]);else if((e==null?void 0:e.title)==="Sleep Timeline Summary")if((D=t[0])!=null&&D.statistical_data&&h&&g==null){const s=(k=t[0])==null?void 0:k.statistical_data.reduce((x,r)=>{const d=new Date(r.start_time),j=(new Date(r.end_time)-d)/(1e3*60),v=L[r.status];return x[v]||(x[v]={duration:0}),x[v].duration+=j,x},{});n=Object.entries(s).map(([x,{duration:r}])=>{const d=Math.floor(r/60),b=Math.floor(r%60);return{name:x,value:`${d}hr ${b}m`}})}else{const s={},x=t.map(r=>({data:r.sleep_index_common_list,date:r.date}));x==null||x.forEach(r=>{var d;(d=r==null?void 0:r.data)==null||d.forEach(({name:b,value:j,status:v,ratio:ie})=>{s[v]||(s[v]={name:`Avg. ${L[v]}`,totalValue:0,totalRatio:0,count:0}),s[v].totalValue+=parseInt(j),s[v].totalRatio+=ie,s[v].count+=1})}),n=Object.entries(s).map(([r,d])=>{const b=Math.round(d.totalValue/d.count),j=Math.floor(b/60),v=b%60;return{name:d.name,value:`${j}hr ${v}m`,ratio:Math.round(d.totalRatio/d.count)}})}else if((e==null?void 0:e.title)==="Sleep Events Summary")if((Z=t[0])!=null&&Z.events&&h&&g==null){const s=(U=t[0])==null?void 0:U.events.reduce((x,r)=>{const d=L[r.event_type],b=x.find(j=>j.name===d);if(b){const j=parseInt(b.value.replace("x",""));b.value=`${j+1}x`}else x.push({name:d,value:"1x",color:$[d]});return x},[]);console.log("alarmEventCounts =============>",s),n=s}else{const s={},x=O(t);x==null||x.forEach(r=>{var d;(d=r==null?void 0:r.data)==null||d.forEach(({name:b,value:j,status:v})=>{s[v]||(s[v]={name:`Avg. ${L[v]}`,totalValue:0,count:0}),s[v].totalValue+=parseInt(j),s[v].count+=1})}),n=Object.entries(s).map(([r,d])=>{const b=Math.round(d.totalValue/d.count);return{name:d.name,value:`${b}x`}})}return z(n),n}function Y(t){if(t||R([]),(e==null?void 0:e.title)==="Sleep Timeline Summary")if(h&&g){const n=t.map(l=>({data:l.sleep_index_common_list,date:l.date}));R(n)}else R(t[0]),console.log("chartData =============>",t);else if((e==null?void 0:e.title)==="Sleep Events Summary"){const n=O(t);R(n)}else if((e==null?void 0:e.title)==="Breath Rate Summary"||(e==null?void 0:e.title)==="Heart Rate Summary"){if(g&&h){const n={xdata:t.map(l=>l.date),maxArray:t.map(l=>l.max),minArray:t.map(l=>l.min),allAvgNumber:Math.round(t.reduce((l,c)=>l+c.avg,0)/t.length)};R(n)}}else{if((e==null?void 0:e.title)==="Bed Exit Duration Statistic Summary")return m(t);if((e==null?void 0:e.title)==="Time to Fall Asleep Statistic Summary")return P(t);if((e==null?void 0:e.title)==="Heart Rate Anomaly Statistic Summary")return ee(t);if((e==null?void 0:e.title)==="Duration Spent In Room Summary"){const n=te(t);R(n)}}return t}w.useEffect(()=>{console.log("================================ api called inti",e==null?void 0:e.title)},[e==null?void 0:e.title]),w.useEffect(()=>{async function t(){var n,l,c;if((n=e==null?void 0:e.apisProps)!=null&&n.endpoint)try{const i=await be((l=e==null?void 0:e.apisProps)==null?void 0:l.endpoint,{...(c=e==null?void 0:e.apisProps)==null?void 0:c.query,from_date:g,to_date:h||B().subtract(31,"day").format("YYYY-MM-DD")});i&&(i!=null&&i.data)&&(I(Y(i==null?void 0:i.data)),ne(i==null?void 0:i.data),Y(i==null?void 0:i.data))}catch(i){console.error("Error fetching summary data:",i),I([])}}t()},[(W=e==null?void 0:e.apisProps)==null?void 0:W.endpoint,g,h]);const le=()=>{var t;return(t=e==null?void 0:e.pickerTypes)==null?void 0:t.map(n=>{switch(n){case"weeklyMonthly":return a.jsx(he,{placeholder:"Weekly/Monthly",style:{width:"140px",borderRadius:"10px"},handleChnage:Q,value:M==="weeklyMonthly"&&h&&g?{start:h,end:g}:null},"weeklyMonthly");case"range":return a.jsx(Re,{showTime:!1,style:{width:"200px",borderRadius:"10px"},size:"large",placeholder:["Pick Data Range (Start)","End"],format:"YYYY-MM-DD",onChange:(l,c)=>X(l,c),value:M==="range"&&g&&h?[B(h),B(g)]:null,allowClear:!0},"range");case"day":return a.jsx(K,{style:{width:"200px",borderRadius:"10px"},size:"large",format:"YYYY-MM-DD",onChange:(l,c)=>y(l,c),value:M==="day"&&h?B(h):null,allowClear:!0},"day");default:return null}})},H={multibar:{default:{component:G,getProps:()=>({data:_,toDate:g,fromDate:h,valueType:e==null?void 0:e.dataType})},day:{component:we,getProps:()=>({statisticalData:_==null?void 0:_.statistical_data,enterBedTime:F(_==null?void 0:_.get_bed_idx),getupAfterTime:F(_==null?void 0:_.leave_bed_idx)})}},multibar_sleep_events:{default:{component:G,getProps:()=>({data:_,toDate:g,fromDate:h,valueType:e==null?void 0:e.dataType})},day:{component:Ee,getProps:()=>{var t,n,l;return{alarmEvents:(t=E[0])==null?void 0:t.events,enterBedTime:F((n=E[0])==null?void 0:n.get_bed_idx),getupAfterTime:F((l=E[0])==null?void 0:l.leave_bed_idx)}}}},bar:{default:{component:je,getProps:()=>({data:E,dataType:e==null?void 0:e.dataType,color:e==null?void 0:e.color,xUnit:e==null?void 0:e.xUnit,toDate:e!=null&&e.isFromToDate?g:"",fromDate:e!=null&&e.isFromToDate?h:"",numberLimit:e==null?void 0:e.numberLimit,dataUnit:e==null?void 0:e.dataUnit,chartFor:e==null?void 0:e.chartFor})}},rate:{default:{component:Te,getProps:()=>({cheartInfo:_,color:e==null?void 0:e.color,dateType:"Month",fromDate:h,toDate:g})},day:{component:Se,getProps:()=>{var t,n;return{data:((t=E[0])==null?void 0:t.data_list)||[],timestamp:((n=E[0])==null?void 0:n.timestamps)||[],color:e==null?void 0:e.color,type:e==null?void 0:e.dataType}}}},scatter:{default:{component:Me,getProps:()=>({data:(e==null?void 0:e.title)!=="Distribution of bed exit times Summary"?xe(E):ve(E),colors:{gotobed:"#2EC7C9",wakeup:"#5AB1EF",getup:"#FFB980",fallasleep:"#B6A2DE",bedexit:"#508C9B"}})}}},ae=()=>{var i,f;const t=e==null?void 0:e.chartType,n=((i=H[t])==null?void 0:i[M])||((f=H[t])==null?void 0:f.default);if(!n)return null;const{component:l,getProps:c}=n;return a.jsx(w.Suspense,{fallback:a.jsx("div",{children:"Loading..."}),children:a.jsx(l,{...c()})})};return a.jsx(ce,{open:o,onCancel:u,footer:null,width:"100%",style:{height:"100vh",padding:0,borderRadius:0,top:0},className:"!rounded-none summaryModal !h-[100vh] overflow-hidden",children:a.jsxs("div",{className:"p-4 h-[100vh]",children:[a.jsxs("div",{className:"flex flex-col justify-center items-center mb-4 gap-2",children:[a.jsx("h2",{className:"text-2xl font-bold text-primary",children:e==null?void 0:e.title}),a.jsx("div",{id:"DatePickers",className:"flex gap-4 items-center justify-center mt-4",children:le()})]}),V.length>0&&a.jsx("div",{id:"chartTotal",className:"flex w-full items-center justify-center border-b mt-12",children:V.map((t,n,l)=>a.jsx(Ae,{label:t.name,value:t.value,isFirst:n===0,isLast:n===l.length-1},n))}),a.jsx("div",{className:"report-content max-h-[350px]  w-[90%] mt-16 mx-auto",children:ae()}),a.jsx("div",{className:"w-[90%] mx-auto mt-6",children:a.jsx(de,{dataSource:Ne,columns:pe,pagination:!1})})]})})}const Ae=({label:o,value:u,isFirst:C,isLast:e})=>a.jsxs("div",{id:"totalItem",className:`max-w-[160px] w-full border p-1 flex items-center justify-center border-b-0 flex-col ${C&&e?"rounded-tl-xl rounded-tr-xl":C?"rounded-tl-xl":e?"rounded-tr-xl":""}`,children:[a.jsx("h1",{className:"text-2xl font-bold text-primary",children:u}),a.jsx("span",{className:"text-sm font-medium opacity-80 text-primary",children:o})]}),pe=[{title:"Item",render:o=>a.jsx("div",{className:"text-primary px-[11px] text-base font-semibold",children:o.event})},{title:"Target",render:o=>a.jsxs("div",{className:"text-primary px-[11px] text-base font-semibold flex items-center gap-1",children:[a.jsx("img",{src:ge,alt:"target"}),o.target,"x"]})},{title:"Value",render:o=>a.jsxs("div",{className:"text-primary px-[11px] text-base font-semibold",children:[o.value,"x"]})},{title:"Trend",render:o=>a.jsxs("div",{className:"w-full h-[10px]  px-[11px] text-base font-semibold flex items-center gap-2",children:[a.jsx("img",{src:o.value-o.target>0?ue:se,alt:"trend",className:"w-[16px] h-[16px]"}),o.value-o.target,"x"]})},{title:"Type",render:o=>a.jsxs("div",{className:`w-full h-[10px] flex items-center gap-2 px-[11px] text-base font-semibold ${o.status==="1"?"text-yellow-500":o.status==="2"?"text-red-500":"text-blue-500"} `,children:[o.status==="0"?"Good":o.status==="1"?"Warning":"Critical",o.status==="0"&&a.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full"}),o.status==="1"&&a.jsx(q,{size:26,className:"text-yellow-500"}),o.status==="2"&&a.jsx(q,{size:26,className:"text-red-500"})]})}],Ne=[{event:"Sleep Apnea",value:"10",target:"7",status:"1"}];function $e({children:o,title:u,color:C,icon:e,dataAnalysis:g,isDataAnalysis:A=!0,isSummaryBtn:h=!0,summaryProps:p,headerClassName:M}){const[N,_]=w.useState(!1);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col gap-6 p-6 bg-white rounded-2xl !w-full h-full ",children:[a.jsxs("div",{id:"header",className:"flex justify-between items-center w-full",children:[a.jsx("h1",{className:`text-[21px] font-bold text-primary ${M}`,children:u}),h&&a.jsx(re,{onClick:()=>_(!0),icon:a.jsx(fe,{}),size:"large",children:"Summary"})]}),a.jsx("div",{className:"h-full",children:o}),A&&a.jsxs("div",{id:"footer",className:"flex gap-3 items-center p-2 px-3",children:[a.jsx("div",{id:"icon",style:{color:"white",fontSize:"20px",backgroundColor:C},className:"p-2 rounded-full",children:e}),a.jsx("span",{className:"text-[15px] capitalize",children:g})]})]}),a.jsx(ke,{visible:N,onClose:()=>_(!1),summaryProps:{...p,color:C,icon:e}})]})}export{$e as T};
